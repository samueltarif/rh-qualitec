import{d as n,r as o,c as a}from"../../../_/nitro.mjs";import{c as e}from"../../../_/rescisao-calculator.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../../../_/irrf-lei-15270-2025.mjs";const s=n(async n=>{try{const s=await o(n),{colaborador:t,dadosRescisao:r,empresa:d}=s;if(!t||!r||!d)throw a({statusCode:400,statusMessage:"Dados incompletos para gerar TRCT"});const i=e(t,r),c=function(n,o,a,e){var s;const t={"Saldo de Salário":"001","Aviso Prévio Indenizado":"002","Aviso Prévio Trabalhado":"003","13º Salário Proporcional":"004","Férias Proporcionais":"005","Férias Vencidas":"006","1/3 Constitucional Férias":"007","Horas Extras":"008","Adicional Noturno":"009","Adicional Insalubridade":"010","Adicional Periculosidade":"011","Comissões":"012","Gratificações":"013",INSS:"101",IRRF:"102","Faltas Injustificadas":"103","Adiantamento Salarial":"104","Vale Transporte":"105","Vale Refeição":"106","Pensão Alimentícia":"107","Empréstimo Consignado":"108"},getCodigoVerba=n=>t[n]||"999",getReferencia=n=>n.descricao.includes("Saldo")?"Dias trabalhados":n.descricao.includes("13º")?"Meses/avos":n.descricao.includes("Férias")?"Período aquisitivo":n.descricao.includes("Aviso")?"30 dias":n.descricao.includes("Horas")?"Horas extras":"-",getTipoRescisaoDescricao=n=>({dispensa_sem_justa_causa:"Dispensa sem Justa Causa",dispensa_com_justa_causa:"Dispensa com Justa Causa",pedido_demissao:"Pedido de Demissão",acordo_mutuo:"Rescisão por Acordo Mútuo (Art. 484-A CLT)",termino_experiencia:"Término de Contrato de Experiência",termino_determinado:"Término de Contrato por Prazo Determinado",rescisao_indireta:"Rescisão Indireta",morte:"Morte do Empregado",aposentadoria:"Aposentadoria"}[n]||n),getInformativoSaque=n=>{switch(n){case"dispensa_sem_justa_causa":case"rescisao_indireta":return"Saque autorizado com código 01 - Dispensa sem justa causa";case"acordo_mutuo":return"Saque de 80% autorizado com código 03 - Acordo mútuo";case"pedido_demissao":return"Saque não autorizado - Permanece bloqueado na conta FGTS";case"aposentadoria":return"Saque autorizado com código 05 - Aposentadoria";case"termino_determinado":return"Saque autorizado com código 04 - Término de contrato determinado";default:return"Consulte as regras de saque na Caixa Econômica Federal"}},getPrazoPagamento=n=>{switch(n){case"dispensa_sem_justa_causa":case"dispensa_com_justa_causa":case"rescisao_indireta":return"Até o 1º dia útil imediato ao término do contrato (Art. 477 §6º CLT)";case"pedido_demissao":case"acordo_mutuo":return"Até o 10º dia corrido, contado da data da notificação da demissão (Art. 477 §6º CLT)";default:return"Conforme Art. 477 §6º da CLT"}},necessitaHomologacao=()=>{const n=new Date(o.data_admissao),e=new Date(a.data_desligamento),s=Math.abs(e.getTime()-n.getTime());return Math.ceil(s/864e5)>365},formatarMoeda=n=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(n||0),formatarData=n=>n?new Date(n+"T00:00:00").toLocaleDateString("pt-BR"):"",formatarCPF=n=>n?n.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"):"",formatarCNPJ=n=>n?n.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"):"";return`\n<!DOCTYPE html>\n<html lang="pt-BR">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>TRCT - ${o.nome}</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: Arial, sans-serif;\n            font-size: 12px;\n            line-height: 1.4;\n            color: #000;\n            background: white;\n        }\n        \n        .container {\n            max-width: 210mm;\n            margin: 0 auto;\n            padding: 10mm;\n        }\n        \n        .border-2 {\n            border: 2px solid #000;\n        }\n        \n        .border {\n            border: 1px solid #000;\n        }\n        \n        .border-b {\n            border-bottom: 1px solid #000;\n        }\n        \n        .border-r {\n            border-right: 1px solid #000;\n        }\n        \n        .border-t {\n            border-top: 1px solid #000;\n        }\n        \n        .border-t-2 {\n            border-top: 2px solid #000;\n        }\n        \n        .p-2 {\n            padding: 8px;\n        }\n        \n        .p-3 {\n            padding: 12px;\n        }\n        \n        .p-4 {\n            padding: 16px;\n        }\n        \n        .mb-4 {\n            margin-bottom: 16px;\n        }\n        \n        .text-center {\n            text-align: center;\n        }\n        \n        .text-right {\n            text-align: right;\n        }\n        \n        .font-bold {\n            font-weight: bold;\n        }\n        \n        .uppercase {\n            text-transform: uppercase;\n        }\n        \n        .bg-gray-100 {\n            background-color: #f3f4f6;\n        }\n        \n        .bg-blue-100 {\n            background-color: #dbeafe;\n        }\n        \n        .bg-red-100 {\n            background-color: #fee2e2;\n        }\n        \n        .bg-yellow-50 {\n            background-color: #fefce8;\n        }\n        \n        .grid {\n            display: grid;\n        }\n        \n        .grid-cols-2 {\n            grid-template-columns: repeat(2, 1fr);\n        }\n        \n        .grid-cols-4 {\n            grid-template-columns: repeat(4, 1fr);\n        }\n        \n        .grid-cols-12 {\n            grid-template-columns: repeat(12, 1fr);\n        }\n        \n        .col-span-1 {\n            grid-column: span 1;\n        }\n        \n        .col-span-2 {\n            grid-column: span 2;\n        }\n        \n        .col-span-3 {\n            grid-column: span 3;\n        }\n        \n        .col-span-5 {\n            grid-column: span 5;\n        }\n        \n        .col-span-7 {\n            grid-column: span 7;\n        }\n        \n        .col-span-9 {\n            grid-column: span 9;\n        }\n        \n        .gap-4 {\n            gap: 16px;\n        }\n        \n        .gap-8 {\n            gap: 32px;\n        }\n        \n        .space-y-1 > * + * {\n            margin-top: 4px;\n        }\n        \n        .space-y-2 > * + * {\n            margin-top: 8px;\n        }\n        \n        .text-xs {\n            font-size: 10px;\n        }\n        \n        .text-sm {\n            font-size: 11px;\n        }\n        \n        .text-lg {\n            font-size: 14px;\n        }\n        \n        .warning-box {\n            background-color: #fefce8;\n            border: 1px solid #facc15;\n            padding: 8px;\n            border-radius: 4px;\n            margin-top: 8px;\n        }\n        \n        .signature-line {\n            border-bottom: 1px solid #000;\n            height: 60px;\n            margin-bottom: 8px;\n        }\n        \n        @media print {\n            .container {\n                max-width: none;\n                margin: 0;\n                padding: 0;\n            }\n            \n            .bg-gray-100,\n            .bg-blue-100,\n            .bg-red-100,\n            .bg-yellow-50 {\n                -webkit-print-color-adjust: exact;\n                color-adjust: exact;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class="container">\n        \x3c!-- Cabeçalho Oficial --\x3e\n        <div class="border-2 p-4 mb-4">\n            <div class="text-center mb-4">\n                <h1 class="text-lg font-bold uppercase">TERMO DE RESCISÃO DO CONTRATO DE TRABALHO</h1>\n                <p class="text-sm">(Artigo 477 da CLT e Lei nº 7.998/90)</p>\n            </div>\n\n            \x3c!-- Identificação --\x3e\n            <div class="grid grid-cols-2 gap-4 mb-4">\n                <div class="border p-2">\n                    <h3 class="font-bold text-sm mb-2">EMPREGADOR</h3>\n                    <div class="space-y-1 text-xs">\n                        <p><strong>Razão Social:</strong> ${n.razao_social||"Não informado"}</p>\n                        <p><strong>CNPJ:</strong> ${formatarCNPJ(n.cnpj||"")}</p>\n                        <p><strong>Endereço:</strong> ${n.endereco||"Não informado"}</p>\n                        <p><strong>CEP:</strong> ${n.cep||"Não informado"} - ${n.cidade||"Não informado"}/${n.estado||"Não informado"}</p>\n                        <p><strong>CNAE:</strong> ${n.cnae||"Não informado"}</p>\n                    </div>\n                </div>\n\n                <div class="border p-2">\n                    <h3 class="font-bold text-sm mb-2">EMPREGADO</h3>\n                    <div class="space-y-1 text-xs">\n                        <p><strong>Nome:</strong> ${o.nome}</p>\n                        <p><strong>CPF:</strong> ${formatarCPF(o.cpf||"")}</p>\n                        <p><strong>PIS/PASEP:</strong> ${o.pis||"Não informado"}</p>\n                        <p><strong>Cargo:</strong> ${(null==(s=o.cargo)?void 0:s.nome)||"Não informado"}</p>\n                        <p><strong>CBO:</strong> ${o.cbo||"Não informado"}</p>\n                        <p><strong>Matrícula:</strong> ${o.matricula||"Não informado"}</p>\n                    </div>\n                </div>\n            </div>\n\n            \x3c!-- Dados do Contrato --\x3e\n            <div class="border p-2 mb-4">\n                <h3 class="font-bold text-sm mb-2">DADOS DO CONTRATO</h3>\n                <div class="grid grid-cols-4 gap-4 text-xs">\n                    <div>\n                        <p><strong>Data Admissão:</strong></p>\n                        <p>${formatarData(o.data_admissao)}</p>\n                    </div>\n                    <div>\n                        <p><strong>Data Desligamento:</strong></p>\n                        <p>${formatarData(a.data_desligamento)}</p>\n                    </div>\n                    <div>\n                        <p><strong>Tipo de Rescisão:</strong></p>\n                        <p>${getTipoRescisaoDescricao(a.tipo_rescisao)}</p>\n                    </div>\n                    <div>\n                        <p><strong>Tempo de Contrato:</strong></p>\n                        <p>${e.tempo_casa}</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        \x3c!-- Quadro de Verbas --\x3e\n        <div class="border-2 mb-4">\n            <div class="bg-gray-100 p-2 border-b">\n                <h3 class="font-bold text-sm text-center">DISCRIMINAÇÃO DAS VERBAS RESCISÓRIAS</h3>\n            </div>\n\n            \x3c!-- Cabeçalho da Tabela --\x3e\n            <div class="grid grid-cols-12 border-b text-xs font-bold bg-gray-100">\n                <div class="col-span-1 p-2 border-r text-center">CÓD</div>\n                <div class="col-span-5 p-2 border-r text-center">DESCRIÇÃO DA VERBA</div>\n                <div class="col-span-2 p-2 border-r text-center">REFERÊNCIA</div>\n                <div class="col-span-2 p-2 border-r text-center">VENCIMENTOS</div>\n                <div class="col-span-2 p-2 text-center">DESCONTOS</div>\n            </div>\n\n            \x3c!-- Proventos --\x3e\n            ${e.proventos.map(n=>`\n            <div class="grid grid-cols-12 border-b text-xs">\n                <div class="col-span-1 p-2 border-r text-center">${getCodigoVerba(n.descricao)}</div>\n                <div class="col-span-5 p-2 border-r">${n.descricao}</div>\n                <div class="col-span-2 p-2 border-r text-center">${getReferencia(n)}</div>\n                <div class="col-span-2 p-2 border-r text-right">${formatarMoeda(n.valor)}</div>\n                <div class="col-span-2 p-2 text-right">-</div>\n            </div>\n            `).join("")}\n\n            \x3c!-- Descontos --\x3e\n            ${e.descontos.map(n=>`\n            <div class="grid grid-cols-12 border-b text-xs">\n                <div class="col-span-1 p-2 border-r text-center">${getCodigoVerba(n.descricao)}</div>\n                <div class="col-span-5 p-2 border-r">${n.descricao}</div>\n                <div class="col-span-2 p-2 border-r text-center">${getReferencia(n)}</div>\n                <div class="col-span-2 p-2 border-r text-right">-</div>\n                <div class="col-span-2 p-2 text-right">${formatarMoeda(n.valor)}</div>\n            </div>\n            `).join("")}\n\n            \x3c!-- Totais --\x3e\n            <div class="grid grid-cols-12 border-t-2 text-xs font-bold bg-gray-100">\n                <div class="col-span-7 p-2 border-r text-right">TOTAIS:</div>\n                <div class="col-span-2 p-2 border-r text-right">${formatarMoeda(e.total_proventos)}</div>\n                <div class="col-span-2 p-2 border-r text-right">${formatarMoeda(e.total_descontos)}</div>\n                <div class="col-span-1 p-2 text-right"></div>\n            </div>\n\n            \x3c!-- Valor Líquido --\x3e\n            <div class="grid grid-cols-12 border-t text-sm font-bold bg-yellow-50">\n                <div class="col-span-9 p-2 border-r text-right">VALOR LÍQUIDO A RECEBER:</div>\n                <div class="col-span-3 p-2 text-right text-lg">${formatarMoeda(e.valor_liquido)}</div>\n            </div>\n        </div>\n\n        \x3c!-- Quadro FGTS --\x3e\n        <div class="border-2 mb-4">\n            <div class="bg-blue-100 p-2 border-b">\n                <h3 class="font-bold text-sm text-center">FUNDO DE GARANTIA DO TEMPO DE SERVIÇO - FGTS</h3>\n            </div>\n\n            <div class="p-3 space-y-2 text-xs">\n                ${e.fgts.map(n=>`\n                <div style="display: flex; justify-content: space-between; border-bottom: 1px solid #e5e7eb; padding-bottom: 4px;">\n                    <span>${n.descricao}</span>\n                    <span style="font-family: monospace;">${formatarMoeda(n.valor)}</span>\n                </div>\n                `).join("")}\n                \n                <div style="display: flex; justify-content: space-between; font-weight: bold; border-top: 2px solid #000; padding-top: 8px;">\n                    <span>TOTAL FGTS + MULTA:</span>\n                    <span style="font-family: monospace;">${formatarMoeda(e.total_fgts)}</span>\n                </div>\n\n                <div class="warning-box">\n                    <p class="text-xs font-bold text-center">\n                        ⚠️ INFORMATIVO: O FGTS será liberado diretamente pela Caixa Econômica Federal\n                    </p>\n                    <p class="text-xs text-center" style="margin-top: 4px;">\n                        ${getInformativoSaque(a.tipo_rescisao)}\n                    </p>\n                </div>\n            </div>\n        </div>\n\n        \x3c!-- Observações Legais --\x3e\n        <div class="border-2 mb-4">\n            <div class="bg-red-100 p-2 border-b">\n                <h3 class="font-bold text-sm text-center">OBSERVAÇÕES LEGAIS</h3>\n            </div>\n            \n            <div class="p-3 space-y-2 text-xs">\n                ${e.observacoes.map(n=>`\n                <div style="display: flex; align-items: flex-start; gap: 8px;">\n                    <span class="font-bold">•</span>\n                    <span>${n}</span>\n                </div>\n                `).join("")}\n                \n                <div style="border-top: 1px solid #d1d5db; padding-top: 8px; margin-top: 12px;">\n                    <p class="font-bold">PRAZO PARA PAGAMENTO:</p>\n                    <p>${getPrazoPagamento(a.tipo_rescisao)}</p>\n                </div>\n            </div>\n        </div>\n\n        \x3c!-- Base Legal --\x3e\n        <div class="border-2 mb-4">\n            <div class="bg-gray-100 p-2 border-b">\n                <h3 class="font-bold text-sm text-center">BASE LEGAL</h3>\n            </div>\n            \n            <div class="p-3 text-xs space-y-1">\n                <p><strong>CLT - Consolidação das Leis do Trabalho:</strong> Arts. 477, 478, 479, 487, 488</p>\n                <p><strong>Lei nº 8.036/90:</strong> FGTS - Fundo de Garantia do Tempo de Serviço</p>\n                <p><strong>Lei nº 7.998/90:</strong> Seguro-Desemprego</p>\n                <p><strong>Lei nº 15.270/2025:</strong> Nova tabela do Imposto de Renda (vigente a partir de 01/01/2026)</p>\n            </div>\n        </div>\n\n        \x3c!-- Campos de Assinatura --\x3e\n        <div class="border-2">\n            <div class="bg-gray-100 p-2 border-b">\n                <h3 class="font-bold text-sm text-center">ASSINATURAS</h3>\n            </div>\n            \n            <div class="p-4">\n                <div class="grid grid-cols-2 gap-8 text-xs">\n                    \x3c!-- Empregado --\x3e\n                    <div class="text-center">\n                        <div class="signature-line"></div>\n                        <p class="font-bold">${o.nome}</p>\n                        <p>EMPREGADO</p>\n                        <p>CPF: ${formatarCPF(o.cpf||"")}</p>\n                    </div>\n                    \n                    \x3c!-- Empregador --\x3e\n                    <div class="text-center">\n                        <div class="signature-line"></div>\n                        <p class="font-bold">${n.representante_legal||"REPRESENTANTE LEGAL"}</p>\n                        <p>EMPREGADOR</p>\n                        <p>${n.razao_social}</p>\n                    </div>\n                </div>\n\n                ${necessitaHomologacao()?'\n                \x3c!-- Homologação --\x3e\n                <div style="margin-top: 24px; padding-top: 16px; border-top: 1px solid #9ca3af;">\n                    <div class="text-center text-xs">\n                        <p class="font-bold" style="margin-bottom: 8px;">HOMOLOGAÇÃO SINDICAL</p>\n                        <p style="margin-bottom: 16px;">(Obrigatória para contratos com mais de 1 ano - Art. 477 §1º CLT)</p>\n                        \n                        <div class="signature-line" style="margin: 0 80px;"></div>\n                        <p class="font-bold">REPRESENTANTE SINDICAL</p>\n                        <p>Data: ___/___/______</p>\n                    </div>\n                </div>\n                ':""}\n            </div>\n        </div>\n\n        \x3c!-- Rodapé --\x3e\n        <div style="margin-top: 16px; font-size: 10px; text-align: center; color: #6b7280;">\n            <p>Documento gerado em ${(new Date).toLocaleString("pt-BR")}</p>\n            <p>Sistema de Gestão de RH - Conforme legislação trabalhista brasileira vigente</p>\n        </div>\n    </div>\n</body>\n</html>\n  `}(d,t,r,i);return{html:c,dados:{empresa:d,colaborador:t,dadosRescisao:r,calculos:i},nomeArquivo:`TRCT_${t.nome.replace(/\s+/g,"_")}_${(new Date).getTime()}.pdf`}}catch(n){throw console.error("Erro ao gerar TRCT:",n),a({statusCode:500,statusMessage:`Erro ao gerar TRCT: ${n.message}`})}});export{s as default};
