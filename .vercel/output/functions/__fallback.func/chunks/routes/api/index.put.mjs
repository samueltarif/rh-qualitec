import{d as e,r as t,c as a,u as o}from"../../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";const s=e(async e=>{try{const s=await t(e),{id:r,...n}=s;if(!r)throw a({statusCode:400,message:"ID da empresa é obrigatório"});const i=o(),d=i.public.supabaseUrl,p=i.supabaseServiceKey;if(!p)throw a({statusCode:500,message:"Service key não configurada"});const m={Authorization:`Bearer ${p}`,apikey:p,"Content-Type":"application/json",Prefer:"return=representation"},c={...n,updated_at:(new Date).toISOString()},u=await $fetch(`${d}/rest/v1/empresa?id=eq.${r}`,{method:"PATCH",headers:m,body:c});if(!u||0===u.length)throw a({statusCode:404,message:"Empresa não encontrada"});return{success:!0,data:u[0]}}catch(e){throw console.error("[UPDATE EMPRESA] Erro:",e.message||e),a({statusCode:e.statusCode||500,message:e.message||"Erro ao atualizar dados da empresa"})}});export{s as default};
