import{d as t,g as e,r as o,c as s}from"../../../_/nitro.mjs";import{s as r}from"../../../_/serverSupabaseClient.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"@supabase/ssr";import"../../../_/fetch-retry.mjs";const a=t(async t=>{const a=await r(t),i=e(t,"id"),d=await o(t);if(!i)throw s({statusCode:400,message:"ID do alerta é obrigatório"});const m={...d,updated_at:(new Date).toISOString()};"lido"!==d.status||d.lido_em||(m.lido_em=(new Date).toISOString()),"resolvido"!==d.status||d.resolvido_em||(m.resolvido_em=(new Date).toISOString());const{data:n,error:p}=await a.from("alertas").update(m).eq("id",i).select().single();if(p)throw s({statusCode:500,message:p.message});return n});export{a as default};
