import{d as o,a as t,c as a}from"../../_/nitro.mjs";import{s as r}from"../../_/serverSupabaseClient.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"@supabase/ssr";import"../../_/fetch-retry.mjs";const e=o(async o=>{const e=await r(o),i=t(o);let s=e.from("alertas").select("\n      *,\n      tipo_alerta:tipo_alerta_id(id, codigo, nome, icone, cor, categoria),\n      colaborador:colaborador_id(id, nome, matricula, foto_url)\n    ").order("created_at",{ascending:!1});i.status&&"todos"!==i.status&&(s=s.eq("status",i.status)),i.prioridade&&"todas"!==i.prioridade&&(s=s.eq("prioridade",i.prioridade)),i.categoria&&(s=s.eq("tipo_alerta.categoria",i.categoria)),i.colaborador_id&&(s=s.eq("colaborador_id",i.colaborador_id)),s=i.limit?s.limit(Number(i.limit)):s.limit(100);const{data:d,error:m}=await s;if(m)throw a({statusCode:500,message:m.message});return d||[]});export{e as default};
