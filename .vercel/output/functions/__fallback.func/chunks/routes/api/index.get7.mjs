import{d as o,c as r,a as e}from"../../_/nitro.mjs";import{s}from"../../_/serverSupabaseClient.mjs";import{s as t}from"../../_/serverSupabaseUser.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"@supabase/ssr";import"../../_/fetch-retry.mjs";const a=o(async o=>{const a=await s(o);if(!await t(o))throw r({statusCode:401,message:"NÃ£o autenticado"});const i=e(o),{mes:n,ano:m,colaborador_id:d,status:c}=i;try{let o=a.from("holerites").select("*").order("ano",{ascending:!1}).order("mes",{ascending:!1}).order("nome_colaborador",{ascending:!0});n&&(o=o.eq("mes",n)),m&&(o=o.eq("ano",m)),d&&(o=o.eq("colaborador_id",d)),c&&(o=o.eq("status",c));const{data:r,error:e}=await o;if(e)throw e;return{success:!0,data:r||[]}}catch(o){throw console.error("Erro ao buscar holerites:",o),r({statusCode:500,message:o.message||"Erro ao buscar holerites"})}});export{a as default};
