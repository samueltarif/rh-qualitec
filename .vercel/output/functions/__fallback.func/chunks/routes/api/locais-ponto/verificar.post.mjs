import{d as t,r as o,c as i}from"../../../_/nitro.mjs";import{s as r}from"../../../_/serverSupabaseClient.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"@supabase/ssr";import"../../../_/fetch-retry.mjs";const a=t(async t=>{const a=await r(t),e=await o(t),{latitude:s,longitude:n}=e;if(!s||!n)throw i({statusCode:400,message:"Latitude e longitude são obrigatórias"});const{data:d,error:p}=await a.rpc("verificar_local_permitido",{p_latitude:s,p_longitude:n});if(p)throw p;const l=null==d?void 0:d[0];return{permitido:(null==l?void 0:l.dentro_raio)||!1,local:l?{id:l.local_id,nome:l.local_nome,distancia:l.distancia}:null}});export{a as default};
