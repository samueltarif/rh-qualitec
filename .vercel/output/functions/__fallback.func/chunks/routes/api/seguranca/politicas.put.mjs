import{d as t,r as e,c as a}from"../../../_/nitro.mjs";import{s}from"../../../_/serverSupabaseClient.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"@supabase/ssr";import"../../../_/fetch-retry.mjs";const r=t(async t=>{const r=await s(t),i=await e(t),{data:o}=await r.from("politicas_seguranca").select("id, empresa_id").limit(1).single();if(o){const{data:t,error:e}=await r.from("politicas_seguranca").update({...i,updated_at:(new Date).toISOString()}).eq("id",o.id).select().single();if(e)throw a({statusCode:500,message:e.message});return t}{const{data:t}=await r.from("empresas").select("id").limit(1).single(),{data:e,error:s}=await r.from("politicas_seguranca").insert({...i,empresa_id:null==t?void 0:t.id}).select().single();if(s)throw a({statusCode:500,message:s.message});return e}});export{r as default};
