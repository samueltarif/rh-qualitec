import{d as e,u as t,c as o,a}from"../../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";const s=e(async e=>{try{const s=t(),r=s.public.supabaseUrl,i=s.supabaseServiceKey;if(!i)throw o({statusCode:500,message:"Service key não configurada"});const c={Authorization:`Bearer ${i}`,apikey:i,"Content-Type":"application/json"},p=a(e);let n=`${r}/rest/v1/politicas_compliance?select=*&order=created_at.desc`;p.tipo&&(n+=`&tipo=eq.${p.tipo}`),p.status&&(n+=`&status=eq.${p.status}`),void 0!==p.publicado&&(n+=`&publicado=eq.${p.publicado}`),p.categoria&&(n+=`&categoria=eq.${p.categoria}`);return await $fetch(n,{headers:c})||[]}catch(e){throw console.error("[GET POLÍTICAS] Erro:",e.message||e),o({statusCode:e.statusCode||500,message:e.message||"Erro ao buscar políticas"})}});export{s as default};
