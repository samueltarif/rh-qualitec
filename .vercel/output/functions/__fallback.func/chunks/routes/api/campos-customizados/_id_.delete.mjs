import{d as o,c as s,g as e}from"../../../_/nitro.mjs";import{s as t}from"../../../_/serverSupabaseClient.mjs";import{s as r}from"../../../_/serverSupabaseUser.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"@supabase/ssr";import"../../../_/fetch-retry.mjs";const a=o(async o=>{const a=await t(o),m=await r(o);if(!m)throw s({statusCode:401,message:"Não autenticado"});try{const t=e(o,"id"),{data:r}=await a.from("app_users").select("role").eq("auth_uid",m.id).single();if(!r||"admin"!==r.role)throw s({statusCode:403,message:"Apenas administradores podem excluir campos"});const{error:i}=await a.from("campos_customizados").delete().eq("id",t);if(i)throw i;return{success:!0,message:"Campo excluído com sucesso"}}catch(o){throw console.error("Erro ao excluir campo customizado:",o),s({statusCode:o.statusCode||500,message:o.message||"Erro ao excluir campo customizado"})}});export{a as default};
