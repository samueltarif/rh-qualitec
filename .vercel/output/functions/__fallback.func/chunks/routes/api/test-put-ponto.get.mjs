import{d as r}from"../../_/nitro.mjs";import{s as e}from"../../_/serverSupabaseClient.mjs";import{s as o}from"../../_/serverSupabaseUser.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"@supabase/ssr";import"../../_/fetch-retry.mjs";const t=r(async r=>{const t=await e(r),s=await o(r);if(!s)return{error:"Não autenticado"};try{const{data:r,error:e}=await t.from("registros_ponto").select("id, data, colaborador_id, entrada_1, saida_1").limit(1);if(e)return{error:"Erro ao buscar registros",details:e};const o=(null==s?void 0:s.id)||(null==s?void 0:s.sub),{data:a,error:i}=await t.from("app_users").select("id, role, colaborador_id").eq("auth_uid",o).single();return i?{error:"Erro ao buscar usuário",details:i}:{success:!0,user:{id:o,appUser:a},registros:r||[],message:"Teste de conectividade OK"}}catch(r){return{error:"Erro no teste",details:r.message}}});export{t as default};
