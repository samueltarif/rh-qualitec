import{d as o,r as e,c as t,u as a}from"../../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";const r=o(async o=>{var r;try{const r=await e(o);console.log("[UPDATE PARAMETROS FOLHA] Body recebido:",JSON.stringify(r,null,2));const{id:s,...i}=r;if(!s)throw t({statusCode:400,message:"ID dos parâmetros é obrigatório"});const n=a(),d=n.public.supabaseUrl,c=n.supabaseServiceKey;if(!c)throw t({statusCode:500,message:"Service key não configurada"});const p={Authorization:`Bearer ${c}`,apikey:c,"Content-Type":"application/json",Prefer:"return=representation"},{created_at:l,vigencia_inicio:m,vigencia_fim:u,ativo:A,...g}=i,f={...g,updated_at:(new Date).toISOString()};console.log("[UPDATE PARAMETROS FOLHA] Dados para atualizar:",JSON.stringify(f,null,2));const h=await $fetch(`${d}/rest/v1/parametros_folha?id=eq.${s}`,{method:"PATCH",headers:p,body:f});if(console.log("[UPDATE PARAMETROS FOLHA] Resposta:",h),!h||0===h.length)throw t({statusCode:404,message:"Parâmetros não encontrados"});return{success:!0,data:h[0]}}catch(o){throw console.error("[UPDATE PARAMETROS FOLHA] Erro completo:",o),console.error("[UPDATE PARAMETROS FOLHA] Erro data:",o.data),t({statusCode:o.statusCode||500,message:(null==(r=o.data)?void 0:r.message)||o.message||"Erro ao atualizar parâmetros de folha"})}});export{r as default};
