import{d as e,c as s,g as t}from"../../../../_/nitro.mjs";import{s as o}from"../../../../_/serverSupabaseClient.mjs";import{s as r}from"../../../../_/serverSupabaseUser.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"@supabase/ssr";import"../../../../_/fetch-retry.mjs";const a=e(async e=>{const a=await o(e),i=await r(e);if(!i)throw s({statusCode:401,message:"Não autenticado"});try{const o=t(e,"id"),{data:r}=await a.from("app_users").select("role").eq("auth_uid",i.id).single();if(!r||"admin"!==r.role)throw s({statusCode:403,message:"Apenas administradores podem excluir relatórios"});const{error:m}=await a.from("relatorios_templates").delete().eq("id",o);if(m)throw m;return{success:!0,message:"Template excluído com sucesso"}}catch(e){throw console.error("Erro ao excluir template:",e),s({statusCode:e.statusCode||500,message:e.message||"Erro ao excluir template"})}});export{a as default};
