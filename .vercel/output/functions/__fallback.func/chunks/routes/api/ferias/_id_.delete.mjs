import{d as s,g as e,c as t}from"../../../_/nitro.mjs";import{s as a}from"../../../_/serverSupabaseClient.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"@supabase/ssr";import"../../../_/fetch-retry.mjs";const o=s(async s=>{const o=await a(s),r=e(s,"id");if(!r)throw t({statusCode:400,message:"ID é obrigatório"});const{data:i}=await o.from("ferias").select("status").eq("id",r).single();if(i&&"Pendente"!==i.status)throw t({statusCode:400,message:"Apenas solicitações pendentes podem ser canceladas"});const{error:n}=await o.from("ferias").update({status:"Cancelada"}).eq("id",r);if(n)throw console.error("Erro ao cancelar férias:",n),t({statusCode:500,message:n.message});return{success:!0}});export{o as default};
