import{d as e,u as t,c as a,a as r}from"../../../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";const s=e(async e=>{try{const s=t(),o=s.public.supabaseUrl,i=s.supabaseServiceKey;if(!i)throw a({statusCode:500,message:"Service key n√£o configurada"});const c={Authorization:`Bearer ${i}`,apikey:i},m=r(e).categoria,n=await $fetch(`${o}/rest/v1/empresa?select=id&limit=1`,{headers:c});if(!n||0===n.length)return[];let p=`${o}/rest/v1/templates_email?empresa_id=eq.${n[0].id}&select=*&order=categoria.asc,nome.asc`;m&&(p+=`&categoria=eq.${m}`);return await $fetch(p,{headers:c})||[]}catch(e){throw console.error("[GET TEMPLATES] Erro:",e.message||e),a({statusCode:e.statusCode||500,message:e.message||"Erro ao buscar templates"})}});export{s as default};
