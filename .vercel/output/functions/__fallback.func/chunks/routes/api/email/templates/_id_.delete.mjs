import{d as e,u as t,c as s}from"../../../../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";const o=e(async e=>{var o;try{const a=t(),r=a.public.supabaseUrl,i=a.supabaseServiceKey;if(!i)throw s({statusCode:500,message:"Service key não configurada"});const m={Authorization:`Bearer ${i}`,apikey:i},d=null==(o=e.context.params)?void 0:o.id,p=await $fetch(`${r}/rest/v1/templates_email?id=eq.${d}&select=sistema`,{headers:m});if(p&&p.length>0&&p[0].sistema)throw s({statusCode:403,message:"Templates do sistema não podem ser excluídos"});return await $fetch(`${r}/rest/v1/templates_email?id=eq.${d}`,{method:"DELETE",headers:m}),{success:!0}}catch(e){throw console.error("[DELETE TEMPLATE] Erro:",e.message||e),s({statusCode:e.statusCode||500,message:e.message||"Erro ao excluir template"})}});export{o as default};
