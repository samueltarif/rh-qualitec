import{d as e,u as t,c as r,r as a}from"../../../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";const o=e(async e=>{try{const o=t(),s=o.public.supabaseUrl,i=o.supabaseServiceKey;if(!i)throw r({statusCode:500,message:"Service key não configurada"});const n={Authorization:`Bearer ${i}`,apikey:i,"Content-Type":"application/json",Prefer:"return=representation"},p=await a(e),m=await $fetch(`${s}/rest/v1/empresa?select=id&limit=1`,{headers:n});if(!m||0===m.length)throw r({statusCode:404,message:"Empresa não encontrada"});const d=await $fetch(`${s}/rest/v1/templates_email`,{method:"POST",headers:n,body:{...p,empresa_id:m[0].id}});return d&&d.length>0?d[0]:d}catch(e){throw console.error("[POST TEMPLATE] Erro:",e.message||e),r({statusCode:e.statusCode||500,message:e.message||"Erro ao criar template"})}});export{o as default};
