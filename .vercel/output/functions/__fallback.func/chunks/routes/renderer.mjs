import{createRenderer as e,getRequestDependencies as t,getPreloadLinks as r,getPrefetchLinks as n}from"vue-bundle-renderer/runtime";import{H as s,u as o,I as a,a as i,c as d,A as l,J as u,K as c,L as p,M as h}from"../_/nitro.mjs";import{renderToString as f}from"vue/server-renderer";import{createHead as b,propsToString as m,renderSSRHead as y}from"unhead/server";import{stringify as g,uneval as _}from"devalue";import{toValue as v,isRef as R}from"vue";function baseURL(){return o().app.baseURL}function buildAssetsURL(...e){return s(publicAssetsURL(),o().app.buildAssetsDir,...e)}function publicAssetsURL(...e){const t=o().app,r=t.cdnURL||t.baseURL;return e.length?s(r,...e):r}const VueResolver=(e,t)=>R(t)?v(t):t;function createHead(e={}){const t=b({...e,propResolvers:[VueResolver]});return t.install=function(e){return{install(t){t.config.globalProperties.$unhead=e,t.config.globalProperties.$head=e,t.provide("usehead",e)}}.install}(t),t}const w={meta:[{name:"viewport",content:"width=device-width, initial-scale=1"},{charset:"utf-8"}],link:[],style:[],script:[],noscript:[]},A={id:"teleports"},x={id:"__nuxt-loader"},C=`<div${m({id:"__nuxt"})}>`,L="</div>",getPrecomputedDependencies=()=>import("../build/client.precomputed.mjs").then(e=>e.default||e).then(e=>"function"==typeof e?e():e),S=lazyCachedFunction(async()=>{const t=await import("../build/server.mjs").then(e=>e.default||e);if(!t)throw new Error("Server bundle is not available");const r=await getPrecomputedDependencies();return e(t,{precomputed:r,manifest:void 0,renderToString:async function(e,t){const r=await f(e,t);return C+r+L},buildAssetsURL:buildAssetsURL})}),T=lazyCachedFunction(async()=>{const t=await getPrecomputedDependencies(),r=await import("../virtual/_virtual_spa-template.mjs").then(e=>e.template).catch(()=>"").then(e=>{{const t=`<div${m(x)}>`;return C+L+(e?t+e+"</div>":"")}}),n=e(()=>()=>{},{precomputed:t,manifest:void 0,renderToString:()=>r,buildAssetsURL:buildAssetsURL}),s=await n.renderToString({});return{rendererContext:n.rendererContext,renderToString:e=>{const t=o(e.event);return e.modules||=new Set,e.payload.serverRendered=!1,e.config={public:t.public,app:t.app},Promise.resolve(s)}}});function lazyCachedFunction(e){let t=null;return()=>(null===t&&(t=e().catch(e=>{throw t=null,e})),t)}function renderPayloadJsonScript(e){const t={type:"application/json",innerHTML:e.data?g(e.data,e.ssrContext._payloadReducers):"","data-nuxt-data":"nuxt-app","data-ssr":!e.ssrContext.noSSR,id:"__NUXT_DATA__"};e.src&&(t["data-src"]=e.src);return[t,{innerHTML:`window.__NUXT__={};window.__NUXT__.config=${_(e.ssrContext.config)}`}]}const U={disableDefaults:!0};const j={omitLineBreaks:!0};globalThis.__buildAssetsURL=buildAssetsURL,globalThis.__publicAssetsURL=publicAssetsURL;const k=!!A.id,P=k?`<div${m(A)}>`:"",$=k?"</div>":"",H=a(async e=>{const s=c(),a=e.path.startsWith("/__nuxt_error")?i(e):null;if(a&&!("__unenv__"in e.node.req))throw d({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const f=function(e){return{url:e.path,event:e,runtimeConfig:o(e),noSSR:e.context.nuxt?.noSSR||!1,head:createHead(U),error:!1,nuxt:void 0,payload:{},_payloadReducers:Object.create(null),modules:new Set}}(e),b={mode:"server"};if(f.head.push(w,b),a){if(a.statusCode&&=Number.parseInt(a.statusCode),"string"==typeof a.data)try{a.data=l(a.data)}catch{}!function(e,t){e.error=!0,e.payload={error:t},e.url=t.url}(f,a)}const m=u(e);!1===m.ssr&&(f.noSSR=!0);const g=await function(e){return e.noSSR?T():S()}(f),_=await g.renderToString(f).catch(async e=>{if(f._renderResponse&&"skipping render"===e.message)return{};const t=!a&&f.payload?.error||e;throw await(f.nuxt?.hooks.callHook("app:error",t)),t}),v=[];if(await(f.nuxt?.hooks.callHook("app:rendered",{ssrContext:f,renderResult:_})),f._renderResponse)return f._renderResponse;if(f.payload?.error&&!a)throw f.payload.error;const R=m.noScripts,{styles:x,scripts:C}=t(f,g.rendererContext);f._preloadManifest&&!R&&f.head.push({link:[{rel:"preload",as:"fetch",fetchpriority:"low",crossorigin:"anonymous",href:buildAssetsURL(`builds/meta/${f.runtimeConfig.app.buildId}.json`)}]},{...b,tagPriority:"low"}),v.length&&f.head.push({style:v});const L=[];for(const e of Object.values(x))L.push({rel:"stylesheet",href:g.rendererContext.buildAssetsURL(e.file),crossorigin:""});if(L.length&&f.head.push({link:L},b),R||(f.head.push({link:r(f,g.rendererContext)},b),f.head.push({link:n(f,g.rendererContext)},b),f.head.push({script:renderPayloadJsonScript({ssrContext:f,data:f.payload})},{...b,tagPosition:"bodyClose",tagPriority:"high"})),!m.noScripts){const e="head";f.head.push({script:Object.values(C).map(t=>({type:t.module?"module":null,src:g.rendererContext.buildAssetsURL(t.file),defer:!t.module||null,tagPosition:e,crossorigin:""}))},b)}const{headTags:H,bodyTags:z,bodyTagsOpen:M,htmlAttrs:O,bodyAttrs:N}=await y(f.head,j),D={htmlAttrs:O?[O]:[],head:normalizeChunks([H]),bodyAttrs:N?[N]:[],bodyPrepend:normalizeChunks([M,f.teleports?.body]),body:[_.html,P+(k?joinTags([f.teleports?.[`#${A.id}`]]):"")+$],bodyAppend:[z]};return await s.hooks.callHook("render:html",D,{event:e}),{body:(F=D,`<!DOCTYPE html><html${joinAttrs(F.htmlAttrs)}><head>${joinTags(F.head)}</head><body${joinAttrs(F.bodyAttrs)}>${joinTags(F.bodyPrepend)}${joinTags(F.body)}${joinTags(F.bodyAppend)}</body></html>`),statusCode:h(e),statusMessage:p(e),headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}};var F});function normalizeChunks(e){const t=[];for(const r of e){const e=r?.trim();e&&t.push(e)}return t}function joinTags(e){return e.join("")}function joinAttrs(e){return 0===e.length?"":" "+e.join(" ")}const z=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"}));export{baseURL as b,publicAssetsURL as p,z as r};
