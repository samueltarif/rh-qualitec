import{_ as e}from"./server.mjs";import{_ as a}from"./UserProfileDropdown-D7V90wtd.mjs";import{_ as t}from"./UIModal-PwEumyFL.mjs";import{_ as s}from"./UITextarea-BZYijfXn.mjs";import{defineComponent as o,ref as r,watch as d,resolveComponent as l,mergeProps as n,withCtx as i,createVNode as c,unref as p,isRef as m,useSSRContext as u}from"vue";import{ssrRenderAttrs as v,ssrRenderComponent as x,ssrInterpolate as b,ssrIncludeBooleanAttr as g,ssrLooseContain as f,ssrLooseEqual as h,ssrRenderList as y,ssrRenderClass as j}from"vue/server-renderer";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"pinia";import"vue-router";import"@supabase/ssr";import"./UIButton-BfdUCxqX.mjs";const $=o({__name:"alteracoes-dados",__ssrInlineRender:!0,setup(o){const u=r(!0),$=r([]),w=r({pendentes:0,aprovadas:0,rejeitadas:0}),_=r(""),A=r(""),R=r(!1),U=r(""),C=r(null),carregarDados=async()=>{u.value=!0;try{const e=new URLSearchParams;_.value&&e.append("status",_.value),A.value&&e.append("tipo",A.value),$.value=await $fetch(`/api/admin/alteracoes-dados?${e}`),await(async()=>{try{const e=await $fetch("/api/admin/alteracoes-dados/stats");w.value=e}catch(e){console.error("Erro ao carregar stats:",e)}})()}catch(e){console.error(e)}finally{u.value=!1}};d([_,A],carregarDados);const formatKey=e=>e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),formatDate=e=>new Date(e).toLocaleString("pt-BR"),rejeitar=async()=>{if(U.value.trim())try{await $fetch(`/api/admin/alteracoes-dados/${C.value.id}`,{method:"PUT",body:{acao:"rejeitar",motivo:U.value}}),R.value=!1,carregarDados()}catch(e){alert(e.data?.message||"Erro ao rejeitar")}else alert("Informe o motivo da rejeição")};return(o,r,d,C)=>{const D=e,z=l("Icon"),V=a,k=t,I=s;r(`<div${v(n({class:"min-h-screen bg-gray-50"},C))}><header class="bg-white border-b border-gray-200 sticky top-0 z-40"><div class="max-w-7xl mx-auto px-8 py-4"><div class="flex items-center justify-between"><div class="flex items-center gap-4">`),r(x(D,{to:"/admin",class:"w-10 h-10 bg-red-700 rounded-lg flex items-center justify-center hover:bg-red-800 transition-colors"},{default:i((e,a,t,s)=>{if(!a)return[c(z,{name:"heroicons:arrow-left",class:"text-white",size:"20"})];a(x(z,{name:"heroicons:arrow-left",class:"text-white",size:"20"},null,t,s))}),_:1},d)),r('<div><h1 class="text-xl font-bold text-gray-800">Alterações de Dados</h1><p class="text-sm text-gray-500">Aprovar ou rejeitar solicitações de alteração de dados bancários</p></div></div>'),r(x(V,{theme:"admin"},null,d)),r(`</div></div></header><div class="max-w-7xl mx-auto p-8"><div class="grid grid-cols-3 gap-4 mb-6"><div class="bg-amber-50 border border-amber-200 rounded-xl p-4 text-center"><p class="text-2xl font-bold text-amber-700">${b(p(w).pendentes)}</p><p class="text-sm text-amber-600">Pendentes</p></div><div class="bg-green-50 border border-green-200 rounded-xl p-4 text-center"><p class="text-2xl font-bold text-green-700">${b(p(w).aprovadas)}</p><p class="text-sm text-green-600">Aprovadas</p></div><div class="bg-red-50 border border-red-200 rounded-xl p-4 text-center"><p class="text-2xl font-bold text-red-700">${b(p(w).rejeitadas)}</p><p class="text-sm text-red-600">Rejeitadas</p></div></div><div class="flex gap-4 mb-6"><select class="px-3 py-2 border border-slate-300 rounded-lg"><option value=""${g(Array.isArray(p(_))?f(p(_),""):h(p(_),""))?" selected":""}>Todos os status</option><option value="pendente"${g(Array.isArray(p(_))?f(p(_),"pendente"):h(p(_),"pendente"))?" selected":""}>Pendentes</option><option value="aprovada"${g(Array.isArray(p(_))?f(p(_),"aprovada"):h(p(_),"aprovada"))?" selected":""}>Aprovadas</option><option value="rejeitada"${g(Array.isArray(p(_))?f(p(_),"rejeitada"):h(p(_),"rejeitada"))?" selected":""}>Rejeitadas</option></select><select class="px-3 py-2 border border-slate-300 rounded-lg"><option value=""${g(Array.isArray(p(A))?f(p(A),""):h(p(A),""))?" selected":""}>Todos os tipos</option><option value="dados_bancarios"${g(Array.isArray(p(A))?f(p(A),"dados_bancarios"):h(p(A),"dados_bancarios"))?" selected":""}>Dados Bancários</option></select><button class="px-4 py-2 bg-slate-800 text-white rounded-lg hover:bg-slate-700 flex items-center gap-2">`),r(x(z,{name:"heroicons:arrow-path",class:{"animate-spin":p(u)},size:"18"},null,d)),r(" Atualizar </button></div>"),p(u)?(r('<div class="text-center py-12">'),r(x(z,{name:"heroicons:arrow-path",class:"animate-spin text-slate-400",size:"32"},null,d)),r("</div>")):0===p($).length?(r('<div class="text-center py-12 bg-slate-50 rounded-xl">'),r(x(z,{name:"heroicons:check-circle",class:"text-green-400 mx-auto",size:"48"},null,d)),r('<p class="text-slate-600 mt-2">Nenhuma solicitação encontrada</p></div>')):(r('<div class="space-y-4">\x3c!--[--\x3e'),y(p($),e=>{var a,t;r(`<div class="bg-white border border-slate-200 rounded-xl p-5"><div class="flex items-start justify-between"><div><div class="flex items-center gap-3 mb-2"><span class="font-semibold text-slate-800">${b(e.colaborador?.nome)}</span><span class="text-sm text-slate-500">${b(e.colaborador?.matricula)}</span><span class="${j([(a=e.status,{"bg-amber-100 text-amber-700":"pendente"===a,"bg-green-100 text-green-700":"aprovada"===a,"bg-red-100 text-red-700":"rejeitada"===a}),"px-2 py-0.5 text-xs font-medium rounded-full"])}">${b((e=>({pendente:"Pendente",aprovada:"Aprovada",rejeitada:"Rejeitada"}[e]||e))(e.status))}</span></div><p class="text-sm text-slate-600 mb-3">`),r(x(z,{name:"heroicons:banknotes",class:"inline mr-1"},null,d)),r(` Alteração de ${b((t=e.tipo,{dados_bancarios:"Dados Bancários",endereco:"Endereço",contato_emergencia:"Contato de Emergência",dados_pessoais:"Dados Pessoais",documentos:"Documentos"}[t]||t))}</p><div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"><div class="p-3 bg-red-50 rounded-lg"><p class="font-medium text-red-700 mb-2">Dados Atuais</p>\x3c!--[--\x3e`),y(e.dados_anteriores,(e,a)=>{r(`<div class="text-slate-600"><span class="font-medium">${b(formatKey(a))}:</span> ${b(e||"-")}</div>`)}),r('\x3c!--]--\x3e</div><div class="p-3 bg-green-50 rounded-lg"><p class="font-medium text-green-700 mb-2">Novos Dados</p>\x3c!--[--\x3e'),y(e.dados_novos,(e,a)=>{r(`<div class="text-slate-600"><span class="font-medium">${b(formatKey(a))}:</span> ${b(e||"-")}</div>`)}),r(`\x3c!--]--\x3e</div></div><p class="text-xs text-slate-400 mt-3"> Solicitado em ${b(formatDate(e.created_at))} `),e.aprovado_em?r(`<span> • ${b("aprovada"===e.status?"Aprovado":"Rejeitado")} em ${b(formatDate(e.aprovado_em))} por ${b(e.aprovador?.nome)}</span>`):r("\x3c!----\x3e"),r("</p></div>"),"pendente"===e.status?(r('<div class="flex gap-2"><button class="px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700">'),r(x(z,{name:"heroicons:check",size:"16",class:"mr-1"},null,d)),r('Aprovar </button><button class="px-3 py-1.5 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700">'),r(x(z,{name:"heroicons:x-mark",size:"16",class:"mr-1"},null,d)),r("Rejeitar </button></div>")):r("\x3c!----\x3e"),r("</div></div>")}),r("\x3c!--]--\x3e</div>")),r(x(k,{modelValue:p(R),"onUpdate:modelValue":e=>m(R)?R.value=e:null,title:"Rejeitar Solicitação"},{default:i((e,a,t,s)=>{if(!a)return[c("div",{class:"space-y-4"},[c(I,{modelValue:p(U),"onUpdate:modelValue":e=>m(U)?U.value=e:null,label:"Motivo da Rejeição",placeholder:"Informe o motivo...",rows:"3"},null,8,["modelValue","onUpdate:modelValue"]),c("div",{class:"flex justify-end gap-3"},[c("button",{onClick:e=>R.value=!1,class:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg"},"Cancelar",8,["onClick"]),c("button",{onClick:rejeitar,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"},"Confirmar Rejeição")])])];a(`<div class="space-y-4"${s}>`),a(x(I,{modelValue:p(U),"onUpdate:modelValue":e=>m(U)?U.value=e:null,label:"Motivo da Rejeição",placeholder:"Informe o motivo...",rows:"3"},null,t,s)),a(`<div class="flex justify-end gap-3"${s}><button class="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg"${s}>Cancelar</button><button class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"${s}>Confirmar Rejeição</button></div></div>`)}),_:1},d)),r("</div></div>")}}}),w=$.setup;$.setup=(e,a)=>{const t=u();return(t.modules||(t.modules=new Set)).add("pages/admin/alteracoes-dados.vue"),w?w(e,a):void 0};export{$ as default};
