import{j as e,_ as o}from"./server.mjs";import{_ as r}from"./UIButton-BfdUCxqX.mjs";import{_ as t}from"./UserProfileDropdown-D7V90wtd.mjs";import{_ as a}from"./UIStatsCard-JOYac-_Z.mjs";import{_ as s}from"./UIBadge-CtMqDCMe.mjs";import{defineComponent as l,ref as i,computed as n,resolveComponent as d,mergeProps as c,withCtx as u,createVNode as p,unref as m,createTextVNode as v,toDisplayString as h,useSSRContext as g}from"vue";import{ssrRenderAttrs as x,ssrRenderComponent as f,ssrIncludeBooleanAttr as b,ssrLooseContain as y,ssrLooseEqual as _,ssrRenderList as w,ssrRenderAttr as A,ssrInterpolate as $}from"vue/server-renderer";import{_ as j}from"./UIEmptyState-DSGrV1Ch.mjs";import{_ as z}from"./ModalHolerite-yjPo6YGX.mjs";import{u as C,_ as E}from"./useHolerites-CCJVx3YT.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"pinia";import"vue-router";import"@supabase/ssr";import"./UIModal-PwEumyFL.mjs";const H=l({__name:"HoleriteCard",__ssrInlineRender:!0,props:{holerite:{},showDelete:{type:Boolean}},emits:["visualizar","excluir"],setup(e){const o=e,formatCurrency=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e||0),getStatusLabel=e=>({gerado:"Gerado",enviado:"Enviado",pago:"Pago",cancelado:"Cancelado"}[e]||e),calcularSalarioBruto=()=>{let e=o.holerite.salario_base||0;e+=o.holerite.valor_horas_extras_50||0,e+=o.holerite.valor_horas_extras_100||0,e+=o.holerite.bonus||0,e+=o.holerite.comissoes||0,e+=o.holerite.adicional_insalubridade||0,e+=o.holerite.adicional_periculosidade||0,e+=o.holerite.adicional_noturno||0,e+=o.holerite.outros_proventos||0;return(o.holerite.itens_personalizados||[]).filter(e=>"provento"===e.tipo).forEach(o=>{e+=o.valor||0}),e},calcularTotalDescontos=()=>{let e=0;e+=o.holerite.inss||0,e+=o.holerite.irrf||0,e+=o.holerite.adiantamento||0,e+=o.holerite.emprestimos||0,e+=o.holerite.faltas||0,e+=o.holerite.atrasos||0,e+=o.holerite.plano_saude||0,e+=o.holerite.plano_odontologico||0,e+=o.holerite.seguro_vida||0,e+=o.holerite.auxilio_creche||0,e+=o.holerite.auxilio_educacao||0,e+=o.holerite.auxilio_combustivel||0,e+=o.holerite.outros_beneficios||0,e+=o.holerite.outros_descontos||0;return(o.holerite.itens_personalizados||[]).filter(e=>"desconto"===e.tipo).forEach(o=>{e+=o.valor||0}),e};return(o,t,a,l)=>{const i=d("Icon"),n=s,p=r;var m,g;t(`<div${x(c({class:"bg-white rounded-xl border-2 border-gray-200 hover:border-blue-400 transition-all group"},l))}><div class="p-6"><div class="flex items-center justify-between mb-4"><div class="flex items-center gap-3"><div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-200 transition-colors">`),t(f(i,{name:"heroicons:document-text",class:"text-blue-600",size:"24"},null,a)),t(`</div><div><p class="font-bold text-gray-800">${$((m=e.holerite.mes,["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"][m-1]))}</p><p class="text-sm text-gray-500">${$(e.holerite.ano)}</p></div></div>`),t(f(n,{color:(g=e.holerite.status,{gerado:"blue",enviado:"green",pago:"purple",cancelado:"red"}[g]||"gray")},{default:u((o,r,t,a)=>{if(!r)return[v(h(getStatusLabel(e.holerite.status)),1)];r(`${$(getStatusLabel(e.holerite.status))}`)}),_:1},a)),t(`</div><div class="mb-4"><p class="text-sm text-gray-500">Colaborador</p><p class="font-semibold text-gray-800">${$(e.holerite.nome_colaborador)}</p></div><div class="space-y-2 mb-4"><div class="flex justify-between text-sm"><span class="text-gray-600">Salário Bruto</span><span class="font-semibold text-gray-800">${$(formatCurrency(calcularSalarioBruto()))}</span></div><div class="flex justify-between text-sm"><span class="text-gray-600">Descontos</span><span class="font-semibold text-red-600">-${$(formatCurrency(calcularTotalDescontos()))}</span></div><div class="flex justify-between pt-2 border-t"><span class="font-bold text-gray-800">Líquido</span><span class="font-bold text-green-600">${$(formatCurrency(calcularSalarioBruto()-calcularTotalDescontos()))}</span></div></div>`),"decimo_terceiro"===e.holerite.tipo?(t('<div class="mb-4">'),t(f(n,{color:"purple"},{default:u((o,r,t,a)=>{if(!r)return[v(" 13º Salário - "+h(e.holerite.parcela_13)+"ª Parcela ",1)];r(` 13º Salário - ${$(e.holerite.parcela_13)}ª Parcela `)}),_:1},a)),t("</div>")):t("\x3c!----\x3e"),t('<div class="flex gap-2">'),t(f(p,{variant:"secondary",size:"sm","icon-left":"heroicons:eye",onClick:r=>o.$emit("visualizar",e.holerite),class:"flex-1"},{default:u((e,o,r,t)=>{if(!o)return[v(" Visualizar ")];o(" Visualizar ")}),_:1},a)),e.showDelete&&"gerado"===e.holerite.status?t(f(p,{variant:"danger",size:"sm","icon-left":"heroicons:trash",onClick:r=>o.$emit("excluir",e.holerite)},{default:u((e,o,r,t)=>{if(!o)return[v(" Excluir ")];o(" Excluir ")}),_:1},a)):t("\x3c!----\x3e"),t("</div></div></div>")}}}),k=H.setup;H.setup=(e,o)=>{const r=g();return(r.modules||(r.modules=new Set)).add("components/HoleriteCard.vue"),k?k(e,o):void 0};const I=Object.assign(H,{__name:"HoleriteCard"}),S=l({__name:"HoleritesList",__ssrInlineRender:!0,props:{holerites:{},loading:{type:Boolean},showDelete:{type:Boolean}},emits:["visualizar","excluir"],setup(e){const o=e,t=i({mes:"",ano:"",status:"",tipo:""}),a=(new Date).getFullYear(),s=n(()=>Array.from({length:5},(e,o)=>a-o)),l=n(()=>{let e=[...o.holerites];return t.value.mes&&(e=e.filter(e=>e.mes===Number(t.value.mes))),t.value.ano&&(e=e.filter(e=>e.ano===Number(t.value.ano))),t.value.status&&(e=e.filter(e=>e.status===t.value.status)),t.value.tipo&&(e=e.filter(e=>e.tipo===t.value.tipo)),e}),aplicarFiltros=()=>{},limparFiltros=()=>{t.value={mes:"",ano:"",status:"",tipo:""}};return(o,a,i,n)=>{const p=r,h=d("Icon"),g=I,z=j;a(`<div${x(c({class:"space-y-6"},n))}><div class="bg-white rounded-xl border-2 border-gray-200 p-6"><div class="grid md:grid-cols-4 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-2">Mês</label><select class="w-full px-4 py-2 border border-gray-300 rounded-lg"><option value=""${b(Array.isArray(m(t).mes)?y(m(t).mes,""):_(m(t).mes,""))?" selected":""}>Todos</option>\x3c!--[--\x3e`),w(12,e=>{var o;a(`<option${A("value",e)}${b(Array.isArray(m(t).mes)?y(m(t).mes,e):_(m(t).mes,e))?" selected":""}>${$((o=e,["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][o-1]))}</option>`)}),a(`\x3c!--]--\x3e</select></div><div><label class="block text-sm font-medium text-gray-700 mb-2">Ano</label><select class="w-full px-4 py-2 border border-gray-300 rounded-lg"><option value=""${b(Array.isArray(m(t).ano)?y(m(t).ano,""):_(m(t).ano,""))?" selected":""}>Todos</option>\x3c!--[--\x3e`),w(m(s),e=>{a(`<option${A("value",e)}${b(Array.isArray(m(t).ano)?y(m(t).ano,e):_(m(t).ano,e))?" selected":""}>${$(e)}</option>`)}),a(`\x3c!--]--\x3e</select></div><div><label class="block text-sm font-medium text-gray-700 mb-2">Status</label><select class="w-full px-4 py-2 border border-gray-300 rounded-lg"><option value=""${b(Array.isArray(m(t).status)?y(m(t).status,""):_(m(t).status,""))?" selected":""}>Todos</option><option value="gerado"${b(Array.isArray(m(t).status)?y(m(t).status,"gerado"):_(m(t).status,"gerado"))?" selected":""}>Gerado</option><option value="enviado"${b(Array.isArray(m(t).status)?y(m(t).status,"enviado"):_(m(t).status,"enviado"))?" selected":""}>Enviado</option><option value="pago"${b(Array.isArray(m(t).status)?y(m(t).status,"pago"):_(m(t).status,"pago"))?" selected":""}>Pago</option></select></div><div><label class="block text-sm font-medium text-gray-700 mb-2">Tipo</label><select class="w-full px-4 py-2 border border-gray-300 rounded-lg"><option value=""${b(Array.isArray(m(t).tipo)?y(m(t).tipo,""):_(m(t).tipo,""))?" selected":""}>Todos</option><option value="mensal"${b(Array.isArray(m(t).tipo)?y(m(t).tipo,"mensal"):_(m(t).tipo,"mensal"))?" selected":""}>Mensal</option><option value="decimo_terceiro"${b(Array.isArray(m(t).tipo)?y(m(t).tipo,"decimo_terceiro"):_(m(t).tipo,"decimo_terceiro"))?" selected":""}>13º Salário</option></select></div></div><div class="mt-4 flex gap-2">`),a(f(p,{onClick:aplicarFiltros,"icon-left":"heroicons:funnel"},{default:u((e,o,r,t)=>{if(!o)return[v(" Filtrar ")];o(" Filtrar ")}),_:1},i)),a(f(p,{variant:"secondary",onClick:limparFiltros,"icon-left":"heroicons:x-mark"},{default:u((e,o,r,t)=>{if(!o)return[v(" Limpar ")];o(" Limpar ")}),_:1},i)),a("</div></div>"),e.loading?(a('<div class="text-center py-12">'),a(f(h,{name:"heroicons:arrow-path",class:"animate-spin text-gray-400 mx-auto mb-4",size:"48"},null,i)),a('<p class="text-gray-600">Carregando holerites...</p></div>')):m(l).length>0?(a('<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">\x3c!--[--\x3e'),w(m(l),r=>{a(f(g,{key:r.id,holerite:r,"show-delete":e.showDelete,onVisualizar:e=>o.$emit("visualizar",e),onExcluir:e=>o.$emit("excluir",e)},null,i))}),a("\x3c!--]--\x3e</div>")):a(f(z,{icon:"heroicons:document-text",title:"Nenhum holerite encontrado",description:"Não há holerites para os filtros selecionados"},null,i)),a("</div>")}}}),D=S.setup;S.setup=(e,o)=>{const r=g();return(r.modules||(r.modules=new Set)).add("components/HoleritesList.vue"),D?D(e,o):void 0};const B=Object.assign(S,{__name:"HoleritesList"}),M=l({__name:"holerites",__ssrInlineRender:!0,setup(s){const l=e(),{buscarHolerites:h,excluirHolerite:g,holerites:b,loading:y}=C(),_=i(!1),w=i(!1),A=i(null),$=i(null),j=i(!1),H=n(()=>({total:b.value.length,gerados:b.value.filter(e=>"gerado"===e.status).length,enviados:b.value.filter(e=>"enviado"===e.status).length,valorTotal:b.value.reduce((e,o)=>e+(o.salario_liquido||0),0)})),carregarHolerites=async()=>{try{await h()}catch(e){console.error("Erro ao carregar holerites:",e),alert("Erro ao carregar holerites: "+e.message)}},visualizarHolerite=e=>{A.value=e,_.value=!0},confirmarExclusao=e=>{"gerado"===e.status?($.value=e,w.value=!0):alert('Apenas holerites com status "Gerado" podem ser excluídos')},excluirHolerite=async()=>{if($.value){j.value=!0;try{await g($.value.id),alert("Holerite excluído com sucesso!"),w.value=!1,$.value=null,await carregarHolerites()}catch(e){console.error("Erro ao excluir holerite:",e),alert("Erro ao excluir holerite: "+e.message)}finally{j.value=!1}}},navegarParaGerar=()=>{l.push("/folha-pagamento")};return(e,s,l,i)=>{const n=o,h=d("Icon"),g=r,C=t,k=a,I=B,S=z,D=E;var M;s(`<div${x(c({class:"min-h-screen bg-gray-50"},i))}><header class="bg-white border-b border-gray-200 sticky top-0 z-40"><div class="max-w-7xl mx-auto px-8 py-4"><div class="flex items-center justify-between"><div class="flex items-center gap-4">`),s(f(n,{to:"/folha-pagamento",class:"w-10 h-10 bg-red-700 rounded-lg flex items-center justify-center hover:bg-red-800 transition-colors"},{default:u((e,o,r,t)=>{if(!o)return[p(h,{name:"heroicons:arrow-left",class:"text-white",size:"20"})];o(f(h,{name:"heroicons:arrow-left",class:"text-white",size:"20"},null,r,t))}),_:1},l)),s('<div><h1 class="text-xl font-bold text-gray-800">Gerenciar Holerites</h1><p class="text-sm text-gray-500">Visualize, exclua e gerencie todos os holerites</p></div></div><div class="flex items-center gap-3">'),s(f(g,{variant:"secondary","icon-left":"heroicons:arrow-path",onClick:carregarHolerites,disabled:m(y)},{default:u((e,o,r,t)=>{if(!o)return[v(" Atualizar ")];o(" Atualizar ")}),_:1},l)),s(f(g,{"icon-left":"heroicons:plus",onClick:navegarParaGerar},{default:u((e,o,r,t)=>{if(!o)return[v(" Gerar Holerites ")];o(" Gerar Holerites ")}),_:1},l)),s(f(C,{theme:"admin"},null,l)),s('</div></div></div></header><div class="max-w-7xl mx-auto p-8"><div class="grid md:grid-cols-4 gap-6 mb-8">'),s(f(k,{title:"Total de Holerites",value:m(H).total,icon:"heroicons:document-text",color:"blue"},null,l)),s(f(k,{title:"Gerados",value:m(H).gerados,icon:"heroicons:document-check",color:"green"},null,l)),s(f(k,{title:"Enviados",value:m(H).enviados,icon:"heroicons:paper-airplane",color:"purple"},null,l)),s(f(k,{title:"Valor Total",value:(M=m(H).valorTotal,new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(M||0)),icon:"heroicons:currency-dollar",color:"amber"},null,l)),s("</div>"),s(f(I,{holerites:m(b),loading:m(y),"show-delete":!0,onVisualizar:visualizarHolerite,onExcluir:confirmarExclusao},null,l)),s(f(S,{show:m(_),"holerite-id":m(A)?.id,onClose:e=>_.value=!1},null,l)),s(f(D,{show:m(w),holerite:m($),loading:m(j),onClose:e=>w.value=!1,onConfirmar:excluirHolerite},null,l)),s("</div></div>")}}}),T=M.setup;M.setup=(e,o)=>{const r=g();return(r.modules||(r.modules=new Set)).add("pages/folha-pagamento/holerites.vue"),T?T(e,o):void 0};export{M as default};
