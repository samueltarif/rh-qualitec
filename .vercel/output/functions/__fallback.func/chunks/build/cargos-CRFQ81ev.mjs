import{_ as e,c as o}from"./server.mjs";import{_ as t}from"./UserProfileDropdown-D7V90wtd.mjs";import{_ as a}from"./UIInput-CnioD5-Q.mjs";import{_ as s}from"./UISelect-C9tnEbh5.mjs";import{_ as r}from"./UIButton-BfdUCxqX.mjs";import{defineComponent as l,ref as i,computed as n,resolveComponent as d,mergeProps as c,withCtx as u,createVNode as v,unref as m,createTextVNode as p,createBlock as g,openBlock as x,Fragment as f,renderList as b,toDisplayString as h,isRef as y,useSSRContext as w}from"vue";import{ssrRenderAttrs as C,ssrRenderComponent as $,ssrInterpolate as _,ssrRenderList as j,ssrRenderClass as G,ssrRenderAttr as z}from"vue/server-renderer";import{u as N}from"./useCargos-BdBN_gr_.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"pinia";import"vue-router";import"@supabase/ssr";const k=l({__name:"CargoFormModal",__ssrInlineRender:!0,props:{isEditing:{type:Boolean},form:{},saving:{type:Boolean},departamentos:{}},emits:["close","submit","update:form"],setup(e,{emit:o}){const t=e,l=o,updateForm=(e,o)=>{l("update:form",{...t.form,[e]:o})};return(o,t,l,i)=>{const n=a,d=s,m=r;t(`<div${C(c({class:"fixed inset-0 z-50 flex items-center justify-center"},i))}><div class="absolute inset-0 bg-black/50"></div><div class="relative bg-white rounded-xl shadow-xl w-full max-w-md mx-4 p-6"><h3 class="text-xl font-bold text-gray-800 mb-6">${_(e.isEditing?"Editar Cargo":"Novo Cargo")}</h3><form><div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-2">Nome do Cargo *</label>`),t($(n,{"model-value":e.form.nome,"onUpdate:modelValue":e=>updateForm("nome",e),type:"text",placeholder:"Ex: Gerente de Vendas",required:""},null,l)),t('</div><div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-2">N√≠vel *</label>'),t($(d,{"model-value":e.form.nivel,"onUpdate:modelValue":e=>updateForm("nivel",e),required:""},{default:u((e,o,t,a)=>{if(!o)return[v("option",{value:""},"Selecione o n√≠vel"),v("option",{value:"operacional"},"Operacional"),v("option",{value:"gestao"},"Gest√£o")];o(`<option value=""${a}>Selecione o n√≠vel</option><option value="operacional"${a}>Operacional</option><option value="gestao"${a}>Gest√£o</option>`)}),_:1},l)),t('</div><div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-2">Departamento</label>'),t($(d,{"model-value":e.form.departamento_id,"onUpdate:modelValue":e=>updateForm("departamento_id",e)},{default:u((o,t,a,s)=>{if(!t)return[v("option",{value:""},"Nenhum departamento"),(x(!0),g(f,null,b(e.departamentos,e=>(x(),g("option",{key:e.id,value:e.id},h(e.nome),9,["value"]))),128))];t(`<option value=""${s}>Nenhum departamento</option>\x3c!--[--\x3e`),j(e.departamentos,e=>{t(`<option${z("value",e.id)}${s}>${_(e.nome)}</option>`)}),t("\x3c!--]--\x3e")}),_:1},l)),t(`<p class="text-xs text-gray-500 mt-1">Opcional: vincule este cargo a um departamento espec√≠fico</p></div><div class="mb-6"><label class="block text-sm font-medium text-gray-700 mb-2">Descri√ß√£o</label><textarea class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors" rows="3" placeholder="Descri√ß√£o das responsabilidades do cargo...">${_(e.form.descricao)}</textarea></div><div class="flex gap-3">`),t($(m,{type:"button",theme:"admin",variant:"secondary","full-width":"",onClick:e=>o.$emit("close")},{default:u((e,o,t,a)=>{if(!o)return[p("Cancelar")];o("Cancelar")}),_:1},l)),t($(m,{type:"submit",theme:"admin",variant:"primary","full-width":"",disabled:e.saving},{default:u((o,t,a,s)=>{if(!t)return[p(h(e.saving?"Salvando...":e.isEditing?"Salvar":"Criar Cargo"),1)];t(`${_(e.saving?"Salvando...":e.isEditing?"Salvar":"Criar Cargo")}`)}),_:1},l)),t("</div></form></div></div>")}}}),S=k.setup;k.setup=(e,o)=>{const t=w();return(t.modules||(t.modules=new Set)).add("components/CargoFormModal.vue"),S?S(e,o):void 0};const O=Object.assign(k,{__name:"CargoFormModal"}),U=l({__name:"CargoGestoresModal",__ssrInlineRender:!0,props:{cargo:{},colaboradores:{},loadingColaboradores:{type:Boolean},saving:{type:Boolean}},emits:["close","add","remove"],setup(e,{emit:o}){const t=o,a=i(""),handleAdd=()=>{a.value&&(t("add",a.value),a.value="")};return(o,t,l,i)=>{const n=d("Icon"),w=s,G=r;t(`<div${C(c({class:"fixed inset-0 z-50 flex items-center justify-center"},i))}><div class="absolute inset-0 bg-black/50"></div><div class="relative bg-white rounded-xl shadow-xl w-full max-w-2xl mx-4 p-6 max-h-[80vh] overflow-y-auto"><h3 class="text-xl font-bold text-gray-800 mb-2">Gerenciar Gestores</h3><p class="text-sm text-gray-600 mb-6">Cargo: <strong>${_(e.cargo?.nome)}</strong></p><div class="mb-6"><h4 class="font-semibold text-gray-800 mb-3">Gestores Vinculados</h4>`),e.cargo?.gestores&&e.cargo.gestores.length>0?(t('<div class="space-y-2">\x3c!--[--\x3e'),j(e.cargo.gestores,e=>{t(`<div class="flex items-center justify-between p-3 bg-purple-50 border border-purple-200 rounded-lg"><div class="flex items-center gap-3"><div class="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center text-white text-sm font-semibold">${_((e=>{if(!e)return"?";const o=e.split(" ");return 1===o.length?o[0].substring(0,2).toUpperCase():(o[0][0]+o[o.length-1][0]).toUpperCase()})(e.colaborador?.nome||""))}</div><div><p class="font-medium text-gray-800">${_(e.colaborador?.nome)}</p><p class="text-xs text-gray-500">${_(e.colaborador?.email_corporativo||"-")}</p></div></div><button class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors" title="Remover">`),t($(n,{name:"heroicons:x-mark",size:"18"},null,l)),t("</button></div>")}),t("\x3c!--]--\x3e</div>")):(t('<div class="text-center py-6 text-gray-500">'),t($(n,{name:"heroicons:user-group",class:"mx-auto mb-2 text-gray-300",size:"48"},null,l)),t("<p>Nenhum gestor vinculado</p></div>")),t('</div><div class="mb-6"><h4 class="font-semibold text-gray-800 mb-3">Adicionar Gestor</h4><div class="flex gap-3">'),t($(w,{modelValue:m(a),"onUpdate:modelValue":e=>y(a)?a.value=e:null,class:"flex-1",disabled:e.loadingColaboradores},{default:u((o,t,a,s)=>{if(!t)return[v("option",{value:""},h(e.loadingColaboradores?"Carregando...":"Selecione um funcion√°rio"),1),(x(!0),g(f,null,b(e.colaboradores,e=>(x(),g("option",{key:e.id,value:e.id},h(e.nome),9,["value"]))),128))];t(`<option value=""${s}>${_(e.loadingColaboradores?"Carregando...":"Selecione um funcion√°rio")}</option>\x3c!--[--\x3e`),j(e.colaboradores,e=>{t(`<option${z("value",e.id)}${s}>${_(e.nome)}</option>`)}),t("\x3c!--]--\x3e")}),_:1},l)),t($(G,{theme:"admin",variant:"primary","icon-left":"heroicons:plus",disabled:!m(a)||e.saving,onClick:handleAdd},{default:u((o,t,a,s)=>{if(!t)return[p(h(e.saving?"Adicionando...":"Adicionar"),1)];t(`${_(e.saving?"Adicionando...":"Adicionar")}`)}),_:1},l)),t('</div></div><div class="flex justify-end">'),t($(G,{theme:"admin",variant:"secondary",onClick:e=>o.$emit("close")},{default:u((e,o,t,a)=>{if(!o)return[p("Fechar")];o("Fechar")}),_:1},l)),t("</div></div></div>")}}}),V=U.setup;U.setup=(e,o)=>{const t=w();return(t.modules||(t.modules=new Set)).add("components/CargoGestoresModal.vue"),V?V(e,o):void 0};const A=Object.assign(U,{__name:"CargoGestoresModal"}),I=l({__name:"cargos",__ssrInlineRender:!0,setup(l){const{cargos:g,loading:x,countByNivel:f,countByStatus:b,filterCargos:h,createCargo:y,updateCargo:w,addGestor:k,removeGestor:S,fetchColaboradoresDisponiveis:U}=N(),V=i({search:"",nivel:"all",status:"all"}),I=i(!1),B=i(!1),E=i(null),D=i(!1),M=i({nome:"",nivel:"",descricao:"",departamento_id:""}),F=i([]),R=i(!1),T=i(null),q=i([]),P=i(!1),Q=i(!1),X=n(()=>h(V.value)),openCreateModal=()=>{B.value=!1,E.value=null,M.value={nome:"",nivel:"",descricao:"",departamento_id:""},I.value=!0},closeModal=()=>{I.value=!1,M.value={nome:"",nivel:"",descricao:"",departamento_id:""}},handleSubmit=async()=>{const e=o();if(M.value.nome&&M.value.nivel){D.value=!0;try{const o={nome:M.value.nome,nivel:M.value.nivel,descricao:M.value.descricao||void 0,departamento_id:M.value.departamento_id||void 0},t=B.value&&E.value?await w(E.value,o):await y(o);t.success?(e.success(B.value?"Cargo atualizado!":"Cargo criado!",B.value?`O cargo "${M.value.nome}" foi atualizado com sucesso.`:`O cargo "${M.value.nome}" foi criado com sucesso.`),closeModal()):e.error("Erro ao salvar cargo",t.error||"Ocorreu um erro ao processar a solicita√ß√£o.")}finally{D.value=!1}}else e.warning("Campos obrigat√≥rios","Preencha todos os campos obrigat√≥rios")},closeGestoresModal=()=>{R.value=!1,T.value=null,q.value=[]},handleAddGestor=async e=>{const t=o();if(!T.value)return;Q.value=!0;const a=await k(T.value.id,e);if(a.success){const o=q.value.find(o=>o.id===e);t.success("Gestor adicionado!",`${o?.nome||"Colaborador"} foi adicionado como gestor do cargo "${T.value.nome}".`);const a=await U(T.value.id);a.success&&(q.value=a.data||[]),T.value=g.value.find(e=>e.id===T.value.id)}else t.error("Erro ao adicionar gestor",a.error||"N√£o foi poss√≠vel adicionar o gestor.");Q.value=!1},handleRemoveGestor=async e=>{const t=o();if(!confirm("Deseja remover este gestor?"))return;const a=await S(e);if(a.success){if(t.success("Gestor removido!","O gestor foi removido do cargo com sucesso."),T.value){const e=await U(T.value.id);e.success&&(q.value=e.data||[]),T.value=g.value.find(e=>e.id===T.value.id)}}else t.error("Erro ao remover gestor",a.error||"N√£o foi poss√≠vel remover o gestor.")};return(o,l,i,n)=>{const g=e,h=d("Icon"),y=t,w=a,N=s,k=r,S=O,U=A;l(`<div${C(c({class:"min-h-screen bg-gray-50"},n))}><header class="bg-white border-b border-gray-200 sticky top-0 z-40"><div class="max-w-7xl mx-auto px-8 py-4"><div class="flex items-center justify-between"><div class="flex items-center gap-4">`),l($(g,{to:"/admin",class:"w-10 h-10 bg-red-700 rounded-lg flex items-center justify-center hover:bg-red-800 transition-colors"},{default:u((e,o,t,a)=>{if(!o)return[v(h,{name:"heroicons:arrow-left",class:"text-white",size:"20"})];o($(h,{name:"heroicons:arrow-left",class:"text-white",size:"20"},null,t,a))}),_:1},i)),l('<div><h1 class="text-xl font-bold text-gray-800">Gest√£o de Cargos</h1><p class="text-sm text-gray-500">Gerenciar cargos e n√≠veis do sistema</p></div></div>'),l($(y,{theme:"admin"},null,i)),l('</div></div></header><div class="max-w-7xl mx-auto p-8"><div class="grid md:grid-cols-4 gap-6 mb-8"><div class="card bg-red-50 border-2 border-red-200"><div class="flex items-center gap-4"><div class="w-12 h-12 bg-red-700 rounded-lg flex items-center justify-center">'),l($(h,{name:"heroicons:briefcase",class:"text-white",size:"24"},null,i)),l(`</div><div><p class="text-sm text-gray-600">Total</p><p class="text-2xl font-bold text-gray-800">${_(m(f).total)}</p></div></div></div><div class="card"><div class="flex items-center gap-4"><div class="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center">`),l($(h,{name:"heroicons:wrench-screwdriver",class:"text-white",size:"24"},null,i)),l(`</div><div><p class="text-sm text-gray-600">Operacional</p><p class="text-2xl font-bold text-gray-800">${_(m(f).operacional)}</p></div></div></div><div class="card"><div class="flex items-center gap-4"><div class="w-12 h-12 bg-purple-600 rounded-lg flex items-center justify-center">`),l($(h,{name:"heroicons:shield-check",class:"text-white",size:"24"},null,i)),l(`</div><div><p class="text-sm text-gray-600">Gest√£o</p><p class="text-2xl font-bold text-gray-800">${_(m(f).gestao)}</p></div></div></div><div class="card"><div class="flex items-center gap-4"><div class="w-12 h-12 bg-green-600 rounded-lg flex items-center justify-center">`),l($(h,{name:"heroicons:check-circle",class:"text-white",size:"24"},null,i)),l(`</div><div><p class="text-sm text-gray-600">Ativos</p><p class="text-2xl font-bold text-gray-800">${_(m(b).ativo)}</p></div></div></div></div><div class="card mb-8"><div class="flex flex-col md:flex-row gap-4 items-start md:items-center justify-between"><div class="flex flex-col md:flex-row gap-4 flex-1"><div class="flex-1">`),l($(w,{modelValue:m(V).search,"onUpdate:modelValue":e=>m(V).search=e,type:"text",placeholder:"Buscar por nome...","icon-left":"heroicons:magnifying-glass"},null,i)),l("</div>"),l($(N,{modelValue:m(V).nivel,"onUpdate:modelValue":e=>m(V).nivel=e,class:"w-full md:w-48"},{default:u((e,o,t,a)=>{if(!o)return[v("option",{value:"all"},"Todos os n√≠veis"),v("option",{value:"operacional"},"Operacional"),v("option",{value:"gestao"},"Gest√£o")];o(`<option value="all"${a}>Todos os n√≠veis</option><option value="operacional"${a}>Operacional</option><option value="gestao"${a}>Gest√£o</option>`)}),_:1},i)),l($(N,{modelValue:m(V).status,"onUpdate:modelValue":e=>m(V).status=e,class:"w-full md:w-48"},{default:u((e,o,t,a)=>{if(!o)return[v("option",{value:"all"},"Todos os status"),v("option",{value:"ativo"},"Ativos"),v("option",{value:"inativo"},"Inativos")];o(`<option value="all"${a}>Todos os status</option><option value="ativo"${a}>Ativos</option><option value="inativo"${a}>Inativos</option>`)}),_:1},i)),l("</div>"),l($(k,{theme:"admin",variant:"primary","icon-left":"heroicons:plus",onClick:openCreateModal},{default:u((e,o,t,a)=>{if(!o)return[p("Novo Cargo")];o("Novo Cargo")}),_:1},i)),l("</div></div>"),m(x)?(l('<div class="card text-center py-12">'),l($(h,{name:"heroicons:arrow-path",class:"animate-spin text-gray-400 mx-auto mb-4",size:"48"},null,i)),l('<p class="text-gray-600">Carregando cargos...</p></div>')):m(X).length>0?(l('<div class="card overflow-hidden"><div class="overflow-x-auto"><table class="w-full"><thead class="bg-gray-50 border-b border-gray-200"><tr><th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">Cargo</th><th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">N√≠vel</th><th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">Descri√ß√£o</th><th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase">Status</th><th class="px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase">A√ß√µes</th></tr></thead><tbody class="divide-y divide-gray-200">\x3c!--[--\x3e'),j(m(X),e=>{l(`<tr class="hover:bg-gray-50"><td class="px-6 py-4"><div class="flex items-center gap-3"><div class="${G(["gestao"===e.nivel?"bg-purple-600":"bg-blue-600","w-10 h-10 rounded-full flex items-center justify-center text-white"])}">`),l($(h,{name:"gestao"===e.nivel?"heroicons:shield-check":"heroicons:wrench-screwdriver",size:"20"},null,i)),l(`</div><div class="flex items-center gap-2"><p class="font-medium text-gray-800">${_(e.nome)}</p>`),"gestao"===e.nivel?l('<span class="text-xl" title="Cargo de Gest√£o"> üëë </span>'):l('<span class="text-lg" title="Cargo Operacional"> üë∑ </span>'),"gestao"===e.nivel&&e.gestores?.length?l(`<p class="text-xs text-gray-500 ml-2">${_(e.gestores.length)} gestor(es)</p>`):l("\x3c!----\x3e"),l(`</div></div></td><td class="px-6 py-4"><span class="${G(["gestao"===e.nivel?"badge-error":"badge-info","badge"])}">${_("gestao"===e.nivel?"Gest√£o":"Operacional")}</span></td><td class="px-6 py-4 text-sm text-gray-600">${_(e.descricao||"-")}</td><td class="px-6 py-4"><span class="${G([e.ativo?"badge-success":"badge-warning","badge"])}">${_(e.ativo?"Ativo":"Inativo")}</span></td><td class="px-6 py-4"><div class="flex items-center justify-end gap-2">`),"gestao"===e.nivel?(l('<button class="p-2 text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded-lg" title="Gestores">'),l($(h,{name:"heroicons:user-group",size:"18"},null,i)),l("</button>")):l("\x3c!----\x3e"),l('<button class="p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg" title="Editar">'),l($(h,{name:"heroicons:pencil",size:"18"},null,i)),l(`</button><button class="${G([e.ativo?"text-gray-500 hover:text-orange-600 hover:bg-orange-50":"text-gray-500 hover:text-green-600 hover:bg-green-50","p-2 rounded-lg"])}"${z("title",e.ativo?"Desativar":"Ativar")}>`),l($(h,{name:e.ativo?"heroicons:pause":"heroicons:play",size:"18"},null,i)),l("</button></div></td></tr>")}),l("\x3c!--]--\x3e</tbody></table></div></div>")):(l('<div class="card text-center py-12">'),l($(h,{name:"heroicons:briefcase",class:"text-gray-300 mx-auto mb-4",size:"64"},null,i)),l('<h3 class="text-lg font-semibold text-gray-800 mb-2">Nenhum cargo encontrado</h3><p class="text-gray-600 mb-6">Ajuste os filtros ou crie um novo cargo</p>'),l($(k,{theme:"admin",variant:"primary","icon-left":"heroicons:plus",onClick:openCreateModal},{default:u((e,o,t,a)=>{if(!o)return[p("Novo Cargo")];o("Novo Cargo")}),_:1},i)),l("</div>")),l('<div class="card mt-8 bg-blue-50 border-2 border-blue-200"><h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">'),l($(h,{name:"heroicons:information-circle",class:"text-blue-600",size:"24"},null,i)),l(' Sobre os N√≠veis de Cargo </h3><div class="grid md:grid-cols-2 gap-6"><div><h4 class="font-semibold text-blue-800 mb-2">N√≠vel Operacional</h4><p class="text-sm text-gray-600">Cargos operacionais t√™m acesso b√°sico ao sistema.</p></div><div><h4 class="font-semibold text-purple-800 mb-2">N√≠vel Gest√£o</h4><p class="text-sm text-gray-600">Cargos de gest√£o t√™m poderes administrativos, exceto editar/excluir funcion√°rios.</p></div></div></div></div>'),m(I)?l($(S,{"is-editing":m(B),form:m(M),saving:m(D),departamentos:m(F),onClose:closeModal,onSubmit:handleSubmit,"onUpdate:form":e=>M.value=e},null,i)):l("\x3c!----\x3e"),m(R)?l($(U,{cargo:m(T),colaboradores:m(q),"loading-colaboradores":m(P),saving:m(Q),onClose:closeGestoresModal,onAdd:handleAddGestor,onRemove:handleRemoveGestor},null,i)):l("\x3c!----\x3e"),l("</div>")}}}),B=I.setup;I.setup=(e,o)=>{const t=w();return(t.modules||(t.modules=new Set)).add("pages/cargos.vue"),B?B(e,o):void 0};export{I as default};
