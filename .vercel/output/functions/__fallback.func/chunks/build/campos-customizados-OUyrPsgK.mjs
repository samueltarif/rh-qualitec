import{_ as e}from"./server.mjs";import{_ as o}from"./UserProfileDropdown-D7V90wtd.mjs";import{_ as a}from"./UISelect-C9tnEbh5.mjs";import{_ as t}from"./UIInput-CnioD5-Q.mjs";import{_ as l}from"./UIButton-BfdUCxqX.mjs";import{defineComponent as s,ref as r,computed as i,resolveComponent as n,mergeProps as d,withCtx as c,createVNode as p,unref as m,isRef as u,createTextVNode as v,toDisplayString as x,useSSRContext as b}from"vue";import{ssrRenderAttrs as g,ssrRenderComponent as f,ssrRenderList as y,ssrInterpolate as h,ssrIncludeBooleanAttr as C,ssrLooseContain as w}from"vue/server-renderer";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"pinia";import"vue-router";import"@supabase/ssr";const $=s({__name:"ModalCampoCustomizado",__ssrInlineRender:!0,props:{campo:{}},emits:["close","saved"],setup(e,{emit:o}){const s=r(!1),i=r(""),u=r({id:"",nome:"",label:"",descricao:"",entidade:"colaborador",tipo_campo:"texto",opcoes:null,obrigatorio:!1,valor_padrao:"",mascara:"",ordem:0,grupo:"",visivel:!0,editavel:!0,ativo:!0});return(o,r,b,y)=>{const $=n("Icon"),_=a,k=t,z=l;r(`<div${g(d({class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},y))}><div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto"><div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"><h2 class="text-xl font-bold text-gray-800">${h(e.campo?"Editar Campo":"Novo Campo Customizado")}</h2><button class="text-gray-400 hover:text-gray-600">`),r(f($,{name:"heroicons:x-mark",size:"24"},null,b)),r('</button></div><form class="p-6 space-y-4"><div class="grid md:grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Entidade *</label>'),r(f(_,{modelValue:m(u).entidade,"onUpdate:modelValue":e=>m(u).entidade=e,required:"",disabled:!!e.campo},{default:c((e,o,a,t)=>{if(!o)return[p("option",{value:""},"Selecione"),p("option",{value:"colaborador"},"Colaborador"),p("option",{value:"empresa"},"Empresa"),p("option",{value:"documento"},"Documento")];o(`<option value=""${t}>Selecione</option><option value="colaborador"${t}>Colaborador</option><option value="empresa"${t}>Empresa</option><option value="documento"${t}>Documento</option>`)}),_:1},b)),r('<p class="text-xs text-gray-500 mt-1">Onde o campo será usado</p></div><div><label class="block text-sm font-medium text-gray-700 mb-1">Nome do Campo *</label>'),r(f(k,{modelValue:m(u).nome,"onUpdate:modelValue":e=>m(u).nome=e,required:"",disabled:!!e.campo,placeholder:"ex: nome_social"},null,b)),r('<p class="text-xs text-gray-500 mt-1">Identificador único (sem espaços)</p></div></div><div><label class="block text-sm font-medium text-gray-700 mb-1">Rótulo *</label>'),r(f(k,{modelValue:m(u).label,"onUpdate:modelValue":e=>m(u).label=e,required:"",placeholder:"ex: Nome Social"},null,b)),r(`</div><div><label class="block text-sm font-medium text-gray-700 mb-1">Descrição</label><textarea rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent" placeholder="Descrição do campo...">${h(m(u).descricao)}</textarea></div><div class="grid md:grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Tipo de Campo *</label>`),r(f(_,{modelValue:m(u).tipo_campo,"onUpdate:modelValue":e=>m(u).tipo_campo=e,required:""},{default:c((e,o,a,t)=>{if(!o)return[p("option",{value:""},"Selecione"),p("option",{value:"texto"},"Texto"),p("option",{value:"textarea"},"Texto Longo"),p("option",{value:"numero"},"Número"),p("option",{value:"data"},"Data"),p("option",{value:"email"},"E-mail"),p("option",{value:"telefone"},"Telefone"),p("option",{value:"cpf"},"CPF"),p("option",{value:"cnpj"},"CNPJ"),p("option",{value:"select"},"Seleção (Dropdown)"),p("option",{value:"checkbox"},"Checkbox")];o(`<option value=""${t}>Selecione</option><option value="texto"${t}>Texto</option><option value="textarea"${t}>Texto Longo</option><option value="numero"${t}>Número</option><option value="data"${t}>Data</option><option value="email"${t}>E-mail</option><option value="telefone"${t}>Telefone</option><option value="cpf"${t}>CPF</option><option value="cnpj"${t}>CNPJ</option><option value="select"${t}>Seleção (Dropdown)</option><option value="checkbox"${t}>Checkbox</option>`)}),_:1},b)),r('</div><div><label class="block text-sm font-medium text-gray-700 mb-1">Grupo</label>'),r(f(k,{modelValue:m(u).grupo,"onUpdate:modelValue":e=>m(u).grupo=e,placeholder:"ex: Dados Pessoais"},null,b)),r('<p class="text-xs text-gray-500 mt-1">Para organizar campos</p></div></div>'),"select"===m(u).tipo_campo?r(`<div><label class="block text-sm font-medium text-gray-700 mb-1">Opções *</label><textarea rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent" placeholder="Uma opção por linha\nOpção 1\nOpção 2\nOpção 3">${h(m(i))}</textarea><p class="text-xs text-gray-500 mt-1">Digite uma opção por linha</p></div>`):r("\x3c!----\x3e"),r('<div class="grid md:grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Valor Padrão</label>'),r(f(k,{modelValue:m(u).valor_padrao,"onUpdate:modelValue":e=>m(u).valor_padrao=e,placeholder:"Valor inicial"},null,b)),r('</div><div><label class="block text-sm font-medium text-gray-700 mb-1">Máscara</label>'),r(f(k,{modelValue:m(u).mascara,"onUpdate:modelValue":e=>m(u).mascara=e,placeholder:"ex: 000.000.000-00"},null,b)),r('</div></div><div class="grid md:grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Ordem de Exibição</label>'),r(f(k,{modelValue:m(u).ordem,"onUpdate:modelValue":e=>m(u).ordem=e,modelModifiers:{number:!0},type:"number",min:"0"},null,b)),r(`</div></div><div class="space-y-2"><label class="flex items-center gap-2"><input type="checkbox"${C(Array.isArray(m(u).obrigatorio)?w(m(u).obrigatorio,null):m(u).obrigatorio)?" checked":""} class="rounded text-red-600 focus:ring-red-500"><span class="text-sm text-gray-700">Campo obrigatório</span></label><label class="flex items-center gap-2"><input type="checkbox"${C(Array.isArray(m(u).visivel)?w(m(u).visivel,null):m(u).visivel)?" checked":""} class="rounded text-red-600 focus:ring-red-500"><span class="text-sm text-gray-700">Visível</span></label><label class="flex items-center gap-2"><input type="checkbox"${C(Array.isArray(m(u).editavel)?w(m(u).editavel,null):m(u).editavel)?" checked":""} class="rounded text-red-600 focus:ring-red-500"><span class="text-sm text-gray-700">Editável</span></label><label class="flex items-center gap-2"><input type="checkbox"${C(Array.isArray(m(u).ativo)?w(m(u).ativo,null):m(u).ativo)?" checked":""} class="rounded text-red-600 focus:ring-red-500"><span class="text-sm text-gray-700">Ativo</span></label></div><div class="flex gap-4 pt-4">`),r(f(z,{type:"button",onClick:e=>o.$emit("close"),theme:"admin",variant:"secondary","full-width":""},{default:c((e,o,a,t)=>{if(!o)return[v(" Cancelar ")];o(" Cancelar ")}),_:1},b)),r(f(z,{type:"submit",theme:"admin",variant:"primary","full-width":"",disabled:m(s)},{default:c((e,o,a,t)=>{if(!o)return[v(x(m(s)?"Salvando...":"Salvar"),1)];o(`${h(m(s)?"Salvando...":"Salvar")}`)}),_:1},b)),r("</div></form></div></div>")}}}),_=$.setup;$.setup=(e,o)=>{const a=b();return(a.modules||(a.modules=new Set)).add("components/ModalCampoCustomizado.vue"),_?_(e,o):void 0};const k=Object.assign($,{__name:"ModalCampoCustomizado"}),z=s({__name:"campos-customizados",__ssrInlineRender:!0,setup(s){const x=r(!0),b=r(!1),C=r(null),w=r([]),$=r(""),_=r(""),carregarCampos=async()=>{x.value=!0;try{const e=await $fetch("/api/campos-customizados");w.value=e.data||[]}catch(e){console.error("Erro ao carregar campos:",e),alert("Erro ao carregar campos customizados")}finally{x.value=!1}},z=i(()=>{let e=w.value;if($.value&&(e=e.filter(e=>e.entidade===$.value)),_.value){const o=_.value.toLowerCase();e=e.filter(e=>e.label.toLowerCase().includes(o)||e.nome.toLowerCase().includes(o)||e.descricao&&e.descricao.toLowerCase().includes(o))}const o={};return e.forEach(e=>{const a=`${e.entidade} - ${e.grupo||"Outros"}`;o[a]||(o[a]={nome:a,campos:[]}),o[a].campos.push(e)}),Object.values(o).forEach(e=>{e.campos.sort((e,o)=>e.ordem-o.ordem)}),Object.values(o)}),abrirModal=(e=null)=>{C.value=e,b.value=!0},fecharModal=()=>{b.value=!1,C.value=null};return(s,r,i,w)=>{const V=e,E=n("Icon"),j=o,S=a,U=t,D=l,N=k;r(`<div${g(d({class:"min-h-screen bg-gray-50"},w))}><header class="bg-white border-b border-gray-200 sticky top-0 z-40"><div class="max-w-7xl mx-auto px-8 py-4"><div class="flex items-center justify-between"><div class="flex items-center gap-4">`),r(f(V,{to:"/configuracoes",class:"w-10 h-10 bg-red-700 rounded-lg flex items-center justify-center hover:bg-red-800 transition-colors"},{default:c((e,o,a,t)=>{if(!o)return[p(E,{name:"heroicons:arrow-left",class:"text-white",size:"20"})];o(f(E,{name:"heroicons:arrow-left",class:"text-white",size:"20"},null,a,t))}),_:1},i)),r('<div><h1 class="text-xl font-bold text-gray-800">Campos Customizados</h1><p class="text-sm text-gray-500">Crie campos adicionais para colaboradores e outras entidades</p></div></div>'),r(f(j,{theme:"admin"},null,i)),r('</div></div></header><div class="max-w-7xl mx-auto p-8"><div class="card mb-6"><div class="flex flex-wrap gap-4 items-center justify-between"><div class="flex gap-4 items-center flex-1">'),r(f(S,{modelValue:m($),"onUpdate:modelValue":e=>u($)?$.value=e:null,class:"w-48"},{default:c((e,o,a,t)=>{if(!o)return[p("option",{value:""},"Todas as Entidades"),p("option",{value:"colaborador"},"Colaborador"),p("option",{value:"empresa"},"Empresa"),p("option",{value:"documento"},"Documento")];o(`<option value=""${t}>Todas as Entidades</option><option value="colaborador"${t}>Colaborador</option><option value="empresa"${t}>Empresa</option><option value="documento"${t}>Documento</option>`)}),_:1},i)),r(f(U,{modelValue:m(_),"onUpdate:modelValue":e=>u(_)?_.value=e:null,placeholder:"Buscar campos...",class:"flex-1 max-w-md"},{prefix:c((e,o,a,t)=>{if(!o)return[p(E,{name:"heroicons:magnifying-glass",class:"text-gray-400",size:"20"})];o(f(E,{name:"heroicons:magnifying-glass",class:"text-gray-400",size:"20"},null,a,t))}),_:1},i)),r("</div>"),r(f(D,{onClick:e=>abrirModal(),theme:"admin"},{default:c((e,o,a,t)=>{if(!o)return[p(E,{name:"heroicons:plus",size:"20"}),v(" Novo Campo ")];o(f(E,{name:"heroicons:plus",size:"20"},null,a,t)),o(" Novo Campo ")}),_:1},i)),r("</div></div>"),m(x)?(r('<div class="card text-center py-12">'),r(f(E,{name:"heroicons:arrow-path",class:"animate-spin text-gray-400 mx-auto mb-4",size:"48"},null,i)),r('<p class="text-gray-600">Carregando campos...</p></div>')):(r('<div class="space-y-4">\x3c!--[--\x3e'),y(m(z),e=>{r(`<div class="card"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold text-gray-800">${h(e.nome)} <span class="text-sm text-gray-500 font-normal ml-2">(${h(e.campos.length)})</span></h3></div><div class="space-y-2">\x3c!--[--\x3e`),y(e.campos,e=>{r(`<div class="flex items-center gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"><div class="flex-1"><div class="flex items-center gap-2 mb-1"><h4 class="font-medium text-gray-800">${h(e.label)}</h4><span class="text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-700">${h(e.tipo_campo)}</span>`),e.obrigatorio?r('<span class="text-xs px-2 py-0.5 rounded-full bg-red-100 text-red-700"> Obrigatório </span>'):r("\x3c!----\x3e"),e.ativo?r("\x3c!----\x3e"):r('<span class="text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-700"> Inativo </span>'),r(`</div><p class="text-sm text-gray-600">${h(e.descricao||"Sem descrição")}</p><p class="text-xs text-gray-500 mt-1"> Nome do campo: <code class="bg-gray-200 px-1 rounded">${h(e.nome)}</code></p></div><div class="flex gap-2"><button class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors" title="Editar">`),r(f(E,{name:"heroicons:pencil",size:"20"},null,i)),r('</button><button class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors" title="Excluir">'),r(f(E,{name:"heroicons:trash",size:"20"},null,i)),r("</button></div></div>")}),r("\x3c!--]--\x3e</div></div>")}),r("\x3c!--]--\x3e"),0===m(z).length?(r('<div class="card text-center py-12">'),r(f(E,{name:"heroicons:inbox",class:"text-gray-300 mx-auto mb-4",size:"64"},null,i)),r('<h3 class="text-lg font-semibold text-gray-800 mb-2">Nenhum campo encontrado</h3><p class="text-gray-600 mb-4">Crie campos customizados para adicionar informações extras</p>'),r(f(D,{onClick:e=>abrirModal(),theme:"admin"},{default:c((e,o,a,t)=>{if(!o)return[p(E,{name:"heroicons:plus",size:"20"}),v(" Criar Primeiro Campo ")];o(f(E,{name:"heroicons:plus",size:"20"},null,a,t)),o(" Criar Primeiro Campo ")}),_:1},i)),r("</div>")):r("\x3c!----\x3e"),r("</div>")),r("</div>"),m(b)?r(f(N,{campo:m(C),onClose:fecharModal,onSaved:carregarCampos},null,i)):r("\x3c!----\x3e"),r("</div>")}}}),V=z.setup;z.setup=(e,o)=>{const a=b();return(a.modules||(a.modules=new Set)).add("pages/configuracoes/campos-customizados.vue"),V?V(e,o):void 0};export{z as default};
