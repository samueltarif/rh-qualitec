import{_ as e}from"./BasePageHeader-D1TyVd9P.mjs";import{defineComponent as a,ref as t,computed as o,watch as r,resolveComponent as s,mergeProps as i,unref as l,withCtx as n,createVNode as c,createTextVNode as d,createBlock as p,openBlock as m,Fragment as u,renderList as x,toDisplayString as v,useSSRContext as g}from"vue";import{ssrRenderAttrs as f,ssrRenderComponent as b,ssrRenderList as y,ssrRenderClass as h,ssrInterpolate as $,ssrRenderStyle as _,ssrRenderAttr as w,ssrIncludeBooleanAttr as E,ssrLooseContain as I}from"vue/server-renderer";import{_ as k}from"./UISelect-C9tnEbh5.mjs";import{_ as S}from"./UIButton-BfdUCxqX.mjs";import{_ as z}from"./UIInput-CnioD5-Q.mjs";import"./server.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"pinia";import"vue-router";import"@supabase/ssr";import"./UserProfileDropdown-D7V90wtd.mjs";const A=a({__name:"CardMigrationWarning",__ssrInlineRender:!0,props:{show:{type:Boolean},titulo:{},mensagem:{},arquivoMigration:{}},setup:e=>(a,t,o,r)=>{const l=s("Icon");e.show?(t(`<div${f(i({class:"bg-red-50 border-l-4 border-red-500 p-6 mb-6 rounded-lg"},r))}><div class="flex items-start gap-4">`),t(b(l,{name:"heroicons:exclamation-triangle",class:"text-red-600 flex-shrink-0 mt-1",size:"24"},null,o)),t(`<div class="flex-1"><h3 class="text-lg font-semibold text-red-800 mb-2">${$(e.titulo)}</h3><p class="text-red-700 mb-3">${$(e.mensagem)}</p><div class="bg-white p-4 rounded border border-red-200 mb-3"><p class="text-sm font-medium text-gray-800 mb-2">üìã Passos r√°pidos:</p><ol class="text-sm text-gray-700 space-y-1 list-decimal list-inside"><li>Acesse o Supabase SQL Editor</li><li>Copie o conte√∫do de: <code class="bg-gray-100 px-2 py-0.5 rounded text-xs">${$(e.arquivoMigration)}</code></li><li>Execute o SQL</li><li>Recarregue esta p√°gina</li></ol></div><a href="https://supabase.com/dashboard" target="_blank" class="inline-flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium">`),t(b(l,{name:"heroicons:arrow-top-right-on-square",size:"16"},null,o)),t(" Abrir Supabase </a></div></div></div>")):t("\x3c!----\x3e")}}),C=A.setup;A.setup=(e,a)=>{const t=g();return(t.modules||(t.modules=new Set)).add("components/CardMigrationWarning.vue"),C?C(e,a):void 0};const T=Object.assign(A,{__name:"CardMigrationWarning"}),V=a({__name:"WidgetHistoricoOperacoes",__ssrInlineRender:!0,props:{titulo:{},items:{},loading:{type:Boolean},tipo:{}},emits:["refresh","ver-erros","baixar"],setup:e=>(a,t,o,r)=>{const l=s("Icon"),p=S;t(`<div${f(i({class:"card"},r))}><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold text-gray-800 flex items-center gap-2">`),t(b(l,{name:"heroicons:clock",class:"text-gray-600",size:"24"},null,o)),t(` ${$(e.titulo)}</h3>`),t(b(p,{onClick:e=>a.$emit("refresh"),theme:"admin",variant:"secondary",size:"sm"},{default:n((e,a,t,o)=>{if(!a)return[c(l,{name:"heroicons:arrow-path",class:"mr-1",size:"16"}),d(" Atualizar ")];a(b(l,{name:"heroicons:arrow-path",class:"mr-1",size:"16"},null,t,o)),a(" Atualizar ")}),_:1},o)),t("</div>"),e.loading?(t('<div class="text-center py-8">'),t(b(l,{name:"heroicons:arrow-path",class:"animate-spin text-gray-400 mx-auto mb-2",size:"32"},null,o)),t('<p class="text-sm text-gray-600">Carregando...</p></div>')):0===e.items.length?(t('<div class="text-center py-8">'),t(b(l,{name:"heroicons:inbox",class:"text-gray-300 mx-auto mb-2",size:"48"},null,o)),t('<p class="text-gray-500">Nenhum registro encontrado</p></div>')):(t('<div class="overflow-x-auto"><table class="w-full"><thead class="bg-gray-50 border-b border-gray-200"><tr><th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Data</th><th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Tipo</th>'),"importacao"===e.tipo?t('<th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Arquivo</th>'):t("\x3c!----\x3e"),"exportacao"===e.tipo?t('<th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Formato</th>'):t("\x3c!----\x3e"),t(`<th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase">${$("importacao"===e.tipo?"Total":"Registros")}</th>`),"importacao"===e.tipo?t('<th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase">Sucesso</th>'):t("\x3c!----\x3e"),"importacao"===e.tipo?t('<th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase">Erros</th>'):t("\x3c!----\x3e"),"exportacao"===e.tipo?t('<th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase">Tamanho</th>'):t("\x3c!----\x3e"),t('<th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase">Status</th><th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase">A√ß√µes</th></tr></thead><tbody class="divide-y divide-gray-200">\x3c!--[--\x3e'),y(e.items,a=>{var r,s,i,n;t(`<tr class="hover:bg-gray-50"><td class="px-4 py-3 text-sm text-gray-900">${$((s=a.created_at,new Date(s).toLocaleString("pt-BR")))}</td><td class="px-4 py-3 text-sm text-gray-700">${$((r=a.tipo_entidade,{colaboradores:"Colaboradores",usuarios:"Usu√°rios",ferias:"F√©rias",documentos:"Documentos",ponto:"Ponto",folha:"Folha",departamentos:"Departamentos",cargos:"Cargos",jornadas:"Jornadas"}[r]||r))}</td>`),"importacao"===e.tipo?t(`<td class="px-4 py-3 text-sm text-gray-700">${$(a.arquivo_nome)}</td>`):t("\x3c!----\x3e"),"exportacao"===e.tipo?t(`<td class="px-4 py-3 text-sm text-gray-700 uppercase">${$(a.formato)}</td>`):t("\x3c!----\x3e"),t(`<td class="px-4 py-3 text-sm text-center text-gray-900">${$(a.total_registros)}</td>`),"importacao"===e.tipo?t(`<td class="px-4 py-3 text-sm text-center text-green-600 font-medium">${$(a.registros_sucesso)}</td>`):t("\x3c!----\x3e"),"importacao"===e.tipo?t(`<td class="px-4 py-3 text-sm text-center text-red-600 font-medium">${$(a.registros_erro)}</td>`):t("\x3c!----\x3e"),"exportacao"===e.tipo?t(`<td class="px-4 py-3 text-sm text-center text-gray-700">${$((i=a.arquivo_tamanho,i?i<1024?i+" B":i<1048576?(i/1024).toFixed(1)+" KB":(i/1048576).toFixed(1)+" MB":"-"))}</td>`):t("\x3c!----\x3e"),t(`<td class="px-4 py-3 text-center"><span class="${h([(n=a.status,{processando:"bg-blue-100 text-blue-700",concluido:"bg-green-100 text-green-700",erro:"bg-red-100 text-red-700",parcial:"bg-yellow-100 text-yellow-700",expirado:"bg-gray-100 text-gray-600"}[n]||"bg-gray-100 text-gray-600"),"px-2 py-1 text-xs font-medium rounded-full"])}">${$((e=>({processando:"Processando",concluido:"Conclu√≠do",erro:"Erro",parcial:"Parcial",expirado:"Expirado"}[e]||e))(a.status))}</span></td><td class="px-4 py-3 text-center">`),"importacao"===e.tipo&&a.registros_erro>0?t('<button class="text-teal-600 hover:text-teal-800 text-sm">Ver Erros</button>'):t("\x3c!----\x3e"),"exportacao"===e.tipo&&"concluido"===a.status&&a.arquivo_url?(t('<button class="text-teal-600 hover:text-teal-800 text-sm font-medium">'),t(b(l,{name:"heroicons:arrow-down-tray",class:"inline mr-1",size:"16"},null,o)),t("Baixar </button>")):t("\x3c!----\x3e"),"exportacao"===e.tipo&&"expirado"===a.status?t('<span class="text-xs text-gray-400">Expirado</span>'):t("\x3c!----\x3e"),t("</td></tr>")}),t("\x3c!--]--\x3e</tbody></table></div>")),t("</div>")}}),D=V.setup;V.setup=(e,a)=>{const t=g();return(t.modules||(t.modules=new Set)).add("components/WidgetHistoricoOperacoes.vue"),D?D(e,a):void 0};const q=Object.assign(V,{__name:"WidgetHistoricoOperacoes"}),F=a({__name:"SectionImportarDados",__ssrInlineRender:!0,props:{form:{},templatesDisponiveis:{},historico:{},loading:{type:Boolean},importando:{type:Boolean}},emits:["importar","refresh","ver-erros"],setup(e){t();const a=[{value:"colaboradores",label:"Colaboradores"},{value:"usuarios",label:"Usu√°rios"},{value:"ferias",label:"F√©rias"},{value:"documentos",label:"Documentos (Metadados)"},{value:"ponto",label:"Registros de Ponto"},{value:"folha",label:"Dados de Folha"}];return(t,o,r,l)=>{const g=s("Icon"),h=k,_=S,z=q;o(`<div${f(i({class:"space-y-6"},l))}><div class="card"><h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">`),o(b(g,{name:"heroicons:arrow-up-tray",class:"text-teal-600",size:"24"},null,r)),o(' Importar Dados </h3><div class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Dados</label>'),o(b(h,{modelValue:e.form.tipoEntidade,"onUpdate:modelValue":a=>e.form.tipoEntidade=a},{default:n((e,t,o,r)=>{if(!t)return[c("option",{value:""},"Selecione o tipo"),(m(),p(u,null,x(a,e=>c("option",{key:e.value,value:e.value},v(e.label),9,["value"])),64))];t(`<option value=""${r}>Selecione o tipo</option>\x3c!--[--\x3e`),y(a,e=>{t(`<option${w("value",e.value)}${r}>${$(e.label)}</option>`)}),t("\x3c!--]--\x3e")}),_:1},r)),o("</div>"),e.form.tipoEntidade?(o('<div><label class="block text-sm font-medium text-gray-700 mb-2">Template (Opcional)</label>'),o(b(h,{modelValue:e.form.templateId,"onUpdate:modelValue":a=>e.form.templateId=a},{default:n((a,t,o,r)=>{if(!t)return[c("option",{value:""},"Sem template"),(m(!0),p(u,null,x(e.templatesDisponiveis,e=>(m(),p("option",{key:e.id,value:e.id},v(e.nome),9,["value"]))),128))];t(`<option value=""${r}>Sem template</option>\x3c!--[--\x3e`),y(e.templatesDisponiveis,e=>{t(`<option${w("value",e.id)}${r}>${$(e.nome)}</option>`)}),t("\x3c!--]--\x3e")}),_:1},r)),o("</div>")):o("\x3c!----\x3e"),e.form.tipoEntidade?(o('<div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-teal-500 transition-colors"><input type="file" accept=".csv,.xlsx,.xls,.json" class="hidden">'),o(b(g,{name:"heroicons:document-arrow-up",class:"text-gray-400 mx-auto mb-4",size:"48"},null,r)),o(`<p class="text-gray-600 mb-2">${$(e.form.arquivo?e.form.arquivo.name:"Arraste um arquivo ou clique para selecionar")}</p><p class="text-xs text-gray-500 mb-4">CSV, XLSX ou JSON (m√°x. 10MB)</p>`),o(b(_,{onClick:e=>t.$refs.fileInput.click(),theme:"admin",variant:"secondary"},{default:n((e,a,t,o)=>{if(!a)return[d("Selecionar Arquivo")];a("Selecionar Arquivo")}),_:1},r)),o("</div>")):o("\x3c!----\x3e"),e.form.arquivo?o(`<div class="space-y-3 bg-gray-50 p-4 rounded-lg"><label class="flex items-center gap-2"><input type="checkbox"${E(Array.isArray(e.form.validarAntes)?I(e.form.validarAntes,null):e.form.validarAntes)?" checked":""} class="rounded text-teal-600"><span class="text-sm text-gray-700">Validar dados antes de importar</span></label><label class="flex items-center gap-2"><input type="checkbox"${E(Array.isArray(e.form.fazerBackup)?I(e.form.fazerBackup,null):e.form.fazerBackup)?" checked":""} class="rounded text-teal-600"><span class="text-sm text-gray-700">Fazer backup antes da importa√ß√£o</span></label><label class="flex items-center gap-2"><input type="checkbox"${E(Array.isArray(e.form.atualizarExistentes)?I(e.form.atualizarExistentes,null):e.form.atualizarExistentes)?" checked":""} class="rounded text-teal-600"><span class="text-sm text-gray-700">Atualizar registros existentes</span></label></div>`):o("\x3c!----\x3e"),e.form.arquivo?o(b(_,{onClick:e=>t.$emit("importar"),theme:"admin",variant:"primary","full-width":"",disabled:e.importando},{default:n((a,t,o,r)=>{if(!t)return[c(g,{name:"heroicons:arrow-up-tray",class:"mr-2",size:"18"}),d(" "+v(e.importando?"Importando...":"Iniciar Importa√ß√£o"),1)];t(b(g,{name:"heroicons:arrow-up-tray",class:"mr-2",size:"18"},null,o,r)),t(` ${$(e.importando?"Importando...":"Iniciar Importa√ß√£o")}`)}),_:1},r)):o("\x3c!----\x3e"),o("</div></div>"),o(b(z,{titulo:"Hist√≥rico de Importa√ß√µes",items:e.historico,loading:e.loading,tipo:"importacao",onRefresh:e=>t.$emit("refresh"),onVerErros:e=>t.$emit("ver-erros",e)},null,r)),o("</div>")}}}),j=F.setup;F.setup=(e,a)=>{const t=g();return(t.modules||(t.modules=new Set)).add("components/SectionImportarDados.vue"),j?j(e,a):void 0};const U=Object.assign(F,{__name:"SectionImportarDados"}),B=a({__name:"SectionExportarDados",__ssrInlineRender:!0,props:{form:{},historico:{},loading:{type:Boolean},exportando:{type:Boolean}},emits:["exportar","refresh","baixar"],setup(e){const a=[{value:"colaboradores",label:"Colaboradores"},{value:"usuarios",label:"Usu√°rios"},{value:"ferias",label:"F√©rias"},{value:"documentos",label:"Documentos"},{value:"ponto",label:"Registros de Ponto"},{value:"folha",label:"Folha de Pagamento"},{value:"departamentos",label:"Departamentos"},{value:"cargos",label:"Cargos"},{value:"jornadas",label:"Jornadas de Trabalho"}],t=[{value:"csv",label:"CSV",icon:"heroicons:document-text"},{value:"xlsx",label:"Excel",icon:"heroicons:table-cells"},{value:"json",label:"JSON",icon:"heroicons:code-bracket"}];return(o,r,l,g)=>{const _=s("Icon"),A=k,C=z,T=S,V=q;r(`<div${f(i({class:"space-y-6"},g))}><div class="card"><h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">`),r(b(_,{name:"heroicons:arrow-down-tray",class:"text-teal-600",size:"24"},null,l)),r(' Exportar Dados </h3><div class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Dados</label>'),r(b(A,{modelValue:e.form.tipoEntidade,"onUpdate:modelValue":a=>e.form.tipoEntidade=a},{default:n((e,t,o,r)=>{if(!t)return[c("option",{value:""},"Selecione o tipo"),(m(),p(u,null,x(a,e=>c("option",{key:e.value,value:e.value},v(e.label),9,["value"])),64))];t(`<option value=""${r}>Selecione o tipo</option>\x3c!--[--\x3e`),y(a,e=>{t(`<option${w("value",e.value)}${r}>${$(e.label)}</option>`)}),t("\x3c!--]--\x3e")}),_:1},l)),r("</div>"),e.form.tipoEntidade?(r('<div><label class="block text-sm font-medium text-gray-700 mb-2">Formato</label><div class="grid grid-cols-3 gap-3">\x3c!--[--\x3e'),y(t,a=>{r(`<button class="${h([e.form.formato===a.value?"border-teal-600 bg-teal-50":"border-gray-200 hover:border-gray-300","p-4 border-2 rounded-lg text-center transition-all"])}">`),r(b(_,{name:a.icon,class:["mx-auto mb-2",e.form.formato===a.value?"text-teal-600":"text-gray-400"],size:"32"},null,l)),r(`<p class="${h([e.form.formato===a.value?"text-teal-600":"text-gray-700","text-sm font-medium"])}">${$(a.label)}</p></button>`)}),r("\x3c!--]--\x3e</div></div>")):r("\x3c!----\x3e"),e.form.formato?(r('<div class="bg-gray-50 p-4 rounded-lg space-y-3"><h4 class="text-sm font-medium text-gray-700 mb-2">Filtros (Opcional)</h4><div class="grid md:grid-cols-2 gap-3"><div><label class="block text-xs text-gray-600 mb-1">Data In√≠cio</label>'),r(b(C,{modelValue:e.form.filtros.dataInicio,"onUpdate:modelValue":a=>e.form.filtros.dataInicio=a,type:"date"},null,l)),r('</div><div><label class="block text-xs text-gray-600 mb-1">Data Fim</label>'),r(b(C,{modelValue:e.form.filtros.dataFim,"onUpdate:modelValue":a=>e.form.filtros.dataFim=a,type:"date"},null,l)),r("</div></div>"),"colaboradores"===e.form.tipoEntidade?(r('<div><label class="block text-xs text-gray-600 mb-1">Status</label>'),r(b(A,{modelValue:e.form.filtros.status,"onUpdate:modelValue":a=>e.form.filtros.status=a},{default:n((e,a,t,o)=>{if(!a)return[c("option",{value:""},"Todos"),c("option",{value:"ativo"},"Ativos"),c("option",{value:"inativo"},"Inativos"),c("option",{value:"ferias"},"Em F√©rias"),c("option",{value:"afastado"},"Afastados")];a(`<option value=""${o}>Todos</option><option value="ativo"${o}>Ativos</option><option value="inativo"${o}>Inativos</option><option value="ferias"${o}>Em F√©rias</option><option value="afastado"${o}>Afastados</option>`)}),_:1},l)),r("</div>")):r("\x3c!----\x3e"),r(`<label class="flex items-center gap-2"><input type="checkbox"${E(Array.isArray(e.form.incluirInativos)?I(e.form.incluirInativos,null):e.form.incluirInativos)?" checked":""} class="rounded text-teal-600"><span class="text-sm text-gray-700">Incluir registros inativos</span></label></div>`)):r("\x3c!----\x3e"),e.form.formato?r(b(T,{onClick:e=>o.$emit("exportar"),theme:"admin",variant:"primary","full-width":"",disabled:e.exportando},{default:n((a,t,o,r)=>{if(!t)return[c(_,{name:"heroicons:arrow-down-tray",class:"mr-2",size:"18"}),d(" "+v(e.exportando?"Gerando...":"Gerar Exporta√ß√£o"),1)];t(b(_,{name:"heroicons:arrow-down-tray",class:"mr-2",size:"18"},null,o,r)),t(` ${$(e.exportando?"Gerando...":"Gerar Exporta√ß√£o")}`)}),_:1},l)):r("\x3c!----\x3e"),r("</div></div>"),r(b(V,{titulo:"Hist√≥rico de Exporta√ß√µes",items:e.historico,loading:e.loading,tipo:"exportacao",onRefresh:e=>o.$emit("refresh"),onBaixar:e=>o.$emit("baixar",e)},null,l)),r("</div>")}}}),M=B.setup;B.setup=(e,a)=>{const t=g();return(t.modules||(t.modules=new Set)).add("components/SectionExportarDados.vue"),M?M(e,a):void 0};const P=Object.assign(B,{__name:"SectionExportarDados"}),O=a({__name:"ItemTemplate",__ssrInlineRender:!0,props:{template:{}},emits:["editar","baixar","excluir"],setup:e=>(a,t,o,r)=>{const l=s("Icon"),p=S;var m;t(`<div${f(i({class:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow"},r))}><div class="flex items-start justify-between mb-3"><div class="flex-1"><h4 class="font-semibold text-gray-800 mb-1">${$(e.template.nome)}</h4><p class="text-sm text-gray-600 mb-2">${$(e.template.descricao)}</p><div class="flex items-center gap-3 text-xs text-gray-500"><span class="flex items-center gap-1">`),t(b(l,{name:"heroicons:tag",size:"14"},null,o)),t(` ${$((m=e.template.tipo_entidade,{colaboradores:"Colaboradores",usuarios:"Usu√°rios",ferias:"F√©rias",documentos:"Documentos",ponto:"Ponto",folha:"Folha"}[m]||m))}</span><span class="flex items-center gap-1">`),t(b(l,{name:"heroicons:document",size:"14"},null,o)),t(` ${$(e.template.formato?.toUpperCase())}</span><span class="flex items-center gap-1">`),t(b(l,{name:"heroicons:list-bullet",size:"14"},null,o)),t(` ${$(e.template.campos_mapeamento?.length||0)} campos </span></div></div><span class="${h([e.template.ativo?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600","px-2 py-1 text-xs font-medium rounded-full"])}">${$(e.template.ativo?"Ativo":"Inativo")}</span></div><div class="flex gap-2">`),t(b(p,{onClick:t=>a.$emit("editar",e.template),theme:"admin",variant:"secondary",size:"sm",class:"flex-1"},{default:n((e,a,t,o)=>{if(!a)return[c(l,{name:"heroicons:pencil",class:"mr-1",size:"14"}),d("Editar ")];a(b(l,{name:"heroicons:pencil",class:"mr-1",size:"14"},null,t,o)),a("Editar ")}),_:1},o)),t(b(p,{onClick:t=>a.$emit("baixar",e.template),theme:"admin",variant:"secondary",size:"sm",class:"flex-1"},{default:n((e,a,t,o)=>{if(!a)return[c(l,{name:"heroicons:arrow-down-tray",class:"mr-1",size:"14"}),d("Baixar ")];a(b(l,{name:"heroicons:arrow-down-tray",class:"mr-1",size:"14"},null,t,o)),a("Baixar ")}),_:1},o)),t('<button class="px-3 py-1.5 text-red-600 hover:bg-red-50 rounded-lg transition-colors">'),t(b(l,{name:"heroicons:trash",size:"16"},null,o)),t("</button></div></div>")}}),R=O.setup;O.setup=(e,a)=>{const t=g();return(t.modules||(t.modules=new Set)).add("components/ItemTemplate.vue"),R?R(e,a):void 0};const N=Object.assign(O,{__name:"ItemTemplate"}),H=a({__name:"FormConfigImportacao",__ssrInlineRender:!0,props:{config:{},salvando:{type:Boolean}},emits:["salvar"],setup:e=>(a,t,o,r)=>{const l=s("Icon"),p=z,m=k,u=S;t(`<div${f(i({class:"card"},r))}><h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">`),t(b(l,{name:"heroicons:cog-6-tooth",class:"text-teal-600",size:"24"},null,o)),t(' Configura√ß√µes Gerais </h3><div class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-2">Tamanho M√°ximo de Arquivo (MB)</label>'),t(b(p,{modelValue:e.config.tamanhoMaximoArquivo,"onUpdate:modelValue":a=>e.config.tamanhoMaximoArquivo=a,modelModifiers:{number:!0},type:"number",min:"1",max:"100"},null,o)),t('<p class="text-xs text-gray-500 mt-1">Limite: 1MB a 100MB</p></div><div><label class="block text-sm font-medium text-gray-700 mb-2">Tempo de Expira√ß√£o de Exporta√ß√µes (horas)</label>'),t(b(p,{modelValue:e.config.tempoExpiracaoExportacao,"onUpdate:modelValue":a=>e.config.tempoExpiracaoExportacao=a,modelModifiers:{number:!0},type:"number",min:"1",max:"168"},null,o)),t('<p class="text-xs text-gray-500 mt-1">Arquivos exportados ser√£o exclu√≠dos ap√≥s este per√≠odo</p></div><div><label class="block text-sm font-medium text-gray-700 mb-2">Limite de Registros por Exporta√ß√£o</label>'),t(b(p,{modelValue:e.config.limiteRegistrosExportacao,"onUpdate:modelValue":a=>e.config.limiteRegistrosExportacao=a,modelModifiers:{number:!0},type:"number",min:"100",max:"100000"},null,o)),t('</div><div><label class="block text-sm font-medium text-gray-700 mb-2">Encoding Padr√£o</label>'),t(b(m,{modelValue:e.config.encodingPadrao,"onUpdate:modelValue":a=>e.config.encodingPadrao=a},{default:n((e,a,t,o)=>{if(!a)return[c("option",{value:"UTF-8"},"UTF-8"),c("option",{value:"ISO-8859-1"},"ISO-8859-1"),c("option",{value:"Windows-1252"},"Windows-1252")];a(`<option value="UTF-8"${o}>UTF-8</option><option value="ISO-8859-1"${o}>ISO-8859-1</option><option value="Windows-1252"${o}>Windows-1252</option>`)}),_:1},o)),t('</div><div><label class="block text-sm font-medium text-gray-700 mb-2">Delimitador CSV</label>'),t(b(m,{modelValue:e.config.delimitadorCsv,"onUpdate:modelValue":a=>e.config.delimitadorCsv=a},{default:n((e,a,t,o)=>{if(!a)return[c("option",{value:","},", (v√≠rgula)"),c("option",{value:";"},"; (ponto e v√≠rgula)"),c("option",{value:"\\t"},"Tab")];a(`<option value=","${o}>, (v√≠rgula)</option><option value=";"${o}>; (ponto e v√≠rgula)</option><option value="\\t"${o}>Tab</option>`)}),_:1},o)),t(`</div><div class="space-y-3 pt-4 border-t border-gray-200"><label class="flex items-center gap-2"><input type="checkbox"${E(Array.isArray(e.config.validacaoAutomatica)?I(e.config.validacaoAutomatica,null):e.config.validacaoAutomatica)?" checked":""} class="rounded text-teal-600"><span class="text-sm text-gray-700">Validar dados automaticamente antes de importar</span></label><label class="flex items-center gap-2"><input type="checkbox"${E(Array.isArray(e.config.backupAntesImportacao)?I(e.config.backupAntesImportacao,null):e.config.backupAntesImportacao)?" checked":""} class="rounded text-teal-600"><span class="text-sm text-gray-700">Fazer backup autom√°tico antes de importa√ß√µes</span></label><label class="flex items-center gap-2"><input type="checkbox"${E(Array.isArray(e.config.notificarConclusao)?I(e.config.notificarConclusao,null):e.config.notificarConclusao)?" checked":""} class="rounded text-teal-600"><span class="text-sm text-gray-700">Notificar por e-mail ao concluir opera√ß√µes</span></label><label class="flex items-center gap-2"><input type="checkbox"${E(Array.isArray(e.config.permitirImportacaoParalela)?I(e.config.permitirImportacaoParalela,null):e.config.permitirImportacaoParalela)?" checked":""} class="rounded text-teal-600"><span class="text-sm text-gray-700">Permitir m√∫ltiplas importa√ß√µes simult√¢neas</span></label></div>`),t(b(u,{onClick:e=>a.$emit("salvar"),theme:"admin",variant:"primary","full-width":"",disabled:e.salvando},{default:n((a,t,o,r)=>{if(!t)return[d(v(e.salvando?"Salvando...":"Salvar Configura√ß√µes"),1)];t(`${$(e.salvando?"Salvando...":"Salvar Configura√ß√µes")}`)}),_:1},o)),t("</div></div>")}}),W=H.setup;H.setup=(e,a)=>{const t=g();return(t.modules||(t.modules=new Set)).add("components/FormConfigImportacao.vue"),W?W(e,a):void 0};const L=Object.assign(H,{__name:"FormConfigImportacao"}),J=a({__name:"ModalDetalhesErros",__ssrInlineRender:!0,props:{erros:{}},emits:["close"],setup:e=>(a,t,o,r)=>{const l=s("Icon"),c=S;t(`<div${f(i({class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},r))}><div class="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden"><div class="p-6 border-b border-gray-200"><div class="flex items-center justify-between"><h3 class="text-lg font-semibold text-gray-800 flex items-center gap-2">`),t(b(l,{name:"heroicons:exclamation-triangle",class:"text-red-600",size:"24"},null,o)),t(` Detalhes dos Erros (${$(e.erros.length)}) </h3><button class="text-gray-400 hover:text-gray-600">`),t(b(l,{name:"heroicons:x-mark",size:"24"},null,o)),t('</button></div></div><div class="p-6 overflow-y-auto max-h-[calc(90vh-140px)]">'),0===e.erros.length?t('<div class="text-center py-8 text-gray-500"> Nenhum erro encontrado </div>'):(t('<div class="space-y-3">\x3c!--[--\x3e'),y(e.erros,(e,a)=>{t('<div class="border border-red-200 bg-red-50 rounded-lg p-4"><div class="flex items-start gap-3">'),t(b(l,{name:"heroicons:x-circle",class:"text-red-600 flex-shrink-0 mt-0.5",size:"20"},null,o)),t(`<div class="flex-1"><p class="text-sm font-medium text-red-800 mb-1"> Linha ${$(e.linha||a+1)}</p><p class="text-sm text-red-700">${$(e.mensagem)}</p>`),e.campo?t(`<div class="mt-2 text-xs text-red-600"> Campo: <span class="font-medium">${$(e.campo)}</span></div>`):t("\x3c!----\x3e"),e.valor?t(`<div class="mt-1 text-xs text-red-600"> Valor: <span class="font-mono">${$(e.valor)}</span></div>`):t("\x3c!----\x3e"),t("</div></div></div>")}),t("\x3c!--]--\x3e</div>")),t('</div><div class="p-6 border-t border-gray-200 flex justify-end">'),t(b(c,{onClick:e=>a.$emit("close"),theme:"admin",variant:"secondary"},{default:n((e,a,t,o)=>{if(!a)return[d(" Fechar ")];a(" Fechar ")}),_:1},o)),t("</div></div></div>")}}),G=J.setup;J.setup=(e,a)=>{const t=g();return(t.modules||(t.modules=new Set)).add("components/ModalDetalhesErros.vue"),G?G(e,a):void 0};const Q=Object.assign(J,{__name:"ModalDetalhesErros"}),X=a({__name:"ModalTemplateImportacao",__ssrInlineRender:!0,props:{template:{}},emits:["close","saved"],setup(e,{emit:a}){const o=e,r=a,p=t(!1),m=t({nome:o.template?.nome||"",descricao:o.template?.descricao||"",tipo_entidade:o.template?.tipo_entidade||"",formato:o.template?.formato||"csv",ativo:o.template?.ativo??!0}),salvar=async()=>{if(m.value.nome&&m.value.tipo_entidade){p.value=!0;try{o.template?.id?await $fetch(`/api/importacao/templates/${o.template.id}`,{method:"PUT",body:m.value}):await $fetch("/api/importacao/templates",{method:"POST",body:m.value}),alert("‚úÖ Template salvo com sucesso!"),r("saved")}catch(e){console.error("Erro ao salvar:",e),alert(`Erro: ${e.data?.message||e.message}`)}finally{p.value=!1}}else alert("Preencha os campos obrigat√≥rios")};return(a,t,o,r)=>{const u=s("Icon"),x=z,g=k,y=S;t(`<div${f(i({class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},r))}><div class="bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-hidden"><div class="p-6 border-b border-gray-200"><div class="flex items-center justify-between"><h3 class="text-lg font-semibold text-gray-800">${$(e.template?"Editar Template":"Novo Template")}</h3><button class="text-gray-400 hover:text-gray-600">`),t(b(u,{name:"heroicons:x-mark",size:"24"},null,o)),t('</button></div></div><form class="p-6 overflow-y-auto max-h-[calc(90vh-200px)] space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Nome *</label>'),t(b(x,{modelValue:l(m).nome,"onUpdate:modelValue":e=>l(m).nome=e,required:""},null,o)),t(`</div><div><label class="block text-sm font-medium text-gray-700 mb-1">Descri√ß√£o</label><textarea rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">${$(l(m).descricao)}</textarea></div><div class="grid md:grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Tipo de Entidade *</label>`),t(b(g,{modelValue:l(m).tipo_entidade,"onUpdate:modelValue":e=>l(m).tipo_entidade=e,required:""},{default:n((e,a,t,o)=>{if(!a)return[c("option",{value:""},"Selecione"),c("option",{value:"colaboradores"},"Colaboradores"),c("option",{value:"usuarios"},"Usu√°rios"),c("option",{value:"ferias"},"F√©rias"),c("option",{value:"documentos"},"Documentos"),c("option",{value:"ponto"},"Ponto"),c("option",{value:"folha"},"Folha")];a(`<option value=""${o}>Selecione</option><option value="colaboradores"${o}>Colaboradores</option><option value="usuarios"${o}>Usu√°rios</option><option value="ferias"${o}>F√©rias</option><option value="documentos"${o}>Documentos</option><option value="ponto"${o}>Ponto</option><option value="folha"${o}>Folha</option>`)}),_:1},o)),t('</div><div><label class="block text-sm font-medium text-gray-700 mb-1">Formato *</label>'),t(b(g,{modelValue:l(m).formato,"onUpdate:modelValue":e=>l(m).formato=e,required:""},{default:n((e,a,t,o)=>{if(!a)return[c("option",{value:"csv"},"CSV"),c("option",{value:"xlsx"},"Excel"),c("option",{value:"json"},"JSON")];a(`<option value="csv"${o}>CSV</option><option value="xlsx"${o}>Excel</option><option value="json"${o}>JSON</option>`)}),_:1},o)),t(`</div></div><div><label class="flex items-center gap-2"><input type="checkbox"${E(Array.isArray(l(m).ativo)?I(l(m).ativo,null):l(m).ativo)?" checked":""} class="rounded text-teal-600"><span class="text-sm text-gray-700">Template ativo</span></label></div></form><div class="p-6 border-t border-gray-200 flex gap-3">`),t(b(y,{onClick:e=>a.$emit("close"),theme:"admin",variant:"secondary",class:"flex-1"},{default:n((e,a,t,o)=>{if(!a)return[d(" Cancelar ")];a(" Cancelar ")}),_:1},o)),t(b(y,{onClick:salvar,theme:"admin",variant:"primary",class:"flex-1",disabled:l(p)},{default:n((e,a,t,o)=>{if(!a)return[d(v(l(p)?"Salvando...":"Salvar"),1)];a(`${$(l(p)?"Salvando...":"Salvar")}`)}),_:1},o)),t("</div></div></div>")}}}),K=X.setup;X.setup=(e,a)=>{const t=g();return(t.modules||(t.modules=new Set)).add("components/ModalTemplateImportacao.vue"),K?K(e,a):void 0};const Y=Object.assign(X,{__name:"ModalTemplateImportacao"}),Z=a({__name:"importacao-exportacao",__ssrInlineRender:!0,setup(a){const{templates:p,historicoImportacoes:m,historicoExportacoes:u,config:x,erroMigration:v,loading:g,carregarTemplates:w,carregarHistoricoImportacoes:E,carregarHistoricoExportacoes:I,executarImportacao:k,executarExportacao:z,excluirTemplate:A}=(()=>{const e=t([]),a=t([]),o=t([]),r=t({tamanhoMaximoArquivo:10,tempoExpiracaoExportacao:24,limiteRegistrosExportacao:5e4,encodingPadrao:"UTF-8",delimitadorCsv:",",validacaoAutomatica:!0,backupAntesImportacao:!0,notificarConclusao:!0,permitirImportacaoParalela:!1}),s=t(!1),i=t(!1),carregarTemplates=async()=>{try{const a=await $fetch("/api/importacao/templates");e.value=a.data||[],s.value=!1}catch(e){e.message?.includes("does not exist")&&(s.value=!0)}},carregarHistoricoImportacoes=async()=>{i.value=!0;try{const e=await $fetch("/api/importacao/historico");a.value=e.data||[]}catch(e){console.error(e)}finally{i.value=!1}},carregarHistoricoExportacoes=async()=>{i.value=!0;try{const e=await $fetch("/api/exportacao/historico");o.value=e.data||[]}catch(e){console.error(e)}finally{i.value=!1}};return{templates:e,historicoImportacoes:a,historicoExportacoes:o,config:r,erroMigration:s,loading:i,carregarTemplates:carregarTemplates,carregarHistoricoImportacoes:carregarHistoricoImportacoes,carregarHistoricoExportacoes:carregarHistoricoExportacoes,carregarConfig:async()=>{try{const e=await $fetch("/api/importacao/config");e.data&&(r.value={tamanhoMaximoArquivo:e.data.tamanho_maximo_arquivo/1048576,tempoExpiracaoExportacao:e.data.tempo_expiracao_exportacao,limiteRegistrosExportacao:e.data.limite_registros_exportacao,encodingPadrao:e.data.encoding_padrao,delimitadorCsv:e.data.delimitador_csv,validacaoAutomatica:e.data.validacao_automatica,backupAntesImportacao:e.data.backup_antes_importacao,notificarConclusao:e.data.notificar_conclusao,permitirImportacaoParalela:e.data.permitir_importacao_paralela}),s.value=!1}catch(e){e.message?.includes("does not exist")&&(s.value=!0)}},executarImportacao:async e=>{if(!e.arquivo||!e.tipoEntidade)throw new Error("Selecione o tipo e arquivo");const a=new FormData;a.append("arquivo",e.arquivo),a.append("tipoEntidade",e.tipoEntidade),a.append("templateId",e.templateId),a.append("validarAntes",String(e.validarAntes)),a.append("fazerBackup",String(e.fazerBackup)),a.append("atualizarExistentes",String(e.atualizarExistentes)),await $fetch("/api/importacao/executar",{method:"POST",body:a}),await carregarHistoricoImportacoes()},executarExportacao:async e=>{if(!e.tipoEntidade||!e.formato)throw new Error("Selecione tipo e formato");await $fetch("/api/exportacao/executar",{method:"POST",body:e}),await carregarHistoricoExportacoes()},excluirTemplate:async e=>{await $fetch(`/api/importacao/templates/${e}`,{method:"DELETE"}),await carregarTemplates()}}})(),C=t("importar"),V=t(!1),D=t(!1),q=t(!1),F=[{id:"importar",label:"Importar",icon:"heroicons:arrow-up-tray"},{id:"exportar",label:"Exportar",icon:"heroicons:arrow-down-tray"},{id:"templates",label:"Templates",icon:"heroicons:document-duplicate"},{id:"configuracoes",label:"Configura√ß√µes",icon:"heroicons:cog-6-tooth"}],j=t({tipoEntidade:"",templateId:"",arquivo:null,validarAntes:!0,fazerBackup:!0,atualizarExistentes:!1}),B=t({tipoEntidade:"",formato:"",incluirInativos:!1,filtros:{dataInicio:"",dataFim:"",status:""}}),M=t({aberto:!1,erros:[]}),O=t({aberto:!1,template:null}),R=o(()=>p.value.filter(e=>e.tipo_entidade===j.value.tipoEntidade&&e.ativo)),handleImportar=async()=>{V.value=!0;try{await k(j.value),alert("‚úÖ Importa√ß√£o iniciada com sucesso!"),j.value.arquivo=null}catch(e){alert(`Erro: ${e.message}`)}finally{V.value=!1}},handleExportar=async()=>{D.value=!0;try{await z(B.value),alert("‚úÖ Exporta√ß√£o gerada com sucesso!")}catch(e){alert(`Erro: ${e.message}`)}finally{D.value=!1}},handleExcluirTemplate=async e=>{if(confirm("Deseja realmente excluir este template?"))try{await A(e),alert("‚úÖ Template exclu√≠do!")}catch(e){alert(`Erro: ${e.message}`)}},verDetalhesErros=e=>{M.value={aberto:!0,erros:e.erros_detalhes||[]}},abrirModalTemplate=()=>{O.value={aberto:!0,template:null}},editarTemplate=e=>{O.value={aberto:!0,template:e}},baixarTemplate=async e=>{alert("Template baixado!")},baixarArquivo=e=>{e.arquivo_url&&(void 0).open(e.arquivo_url,"_blank")},onTemplateSaved=()=>{O.value.aberto=!1,w()},salvarConfiguracoes=()=>{alert("‚ö†Ô∏è Funcionalidade temporariamente desabilitada. As configura√ß√µes padr√£o j√° est√£o ativas.")};return r(C,e=>{"exportar"===e&&0===u.value.length&&I()}),(a,t,o,r)=>{const w=e,k=T,z=s("Icon"),A=U,H=P,W=S,J=N,G=L,X=Q,K=Y;t(`<div${f(i({class:"min-h-screen bg-gray-50"},r))}>`),t(b(w,{title:"Importa√ß√£o/Exporta√ß√£o",subtitle:"Importe e exporte dados em lote",backTo:"/configuracoes",theme:"admin"},null,o)),t('<div class="max-w-7xl mx-auto p-8">'),t(b(k,{show:l(v),titulo:"Migration 22 N√£o Executada",mensagem:"O sistema de Importa√ß√£o/Exporta√ß√£o requer que voc√™ execute a Migration 22 no banco de dados primeiro.",arquivoMigration:"database/migrations/22_importacao_exportacao.sql"},null,o)),t('<div class="bg-white rounded-lg shadow-sm mb-6"><div class="border-b border-gray-200"><nav class="flex -mb-px">\x3c!--[--\x3e'),y(F,e=>{t(`<button class="${h([l(C)===e.id?"border-teal-600 text-teal-600":"border-transparent text-gray-500 hover:text-gray-700","px-6 py-3 text-sm font-medium border-b-2 transition-colors"])}">`),t(b(z,{name:e.icon,class:"inline mr-2",size:"18"},null,o)),t(`${$(e.label)}</button>`)}),t("\x3c!--]--\x3e</nav></div></div>"),t(b(A,{style:"importar"===l(C)?null:{display:"none"},form:l(j),templatesDisponiveis:l(R),historico:l(m),loading:l(g),importando:l(V),onImportar:handleImportar,onRefresh:l(E),onVerErros:verDetalhesErros},null,o)),t(b(H,{style:"exportar"===l(C)?null:{display:"none"},form:l(B),historico:l(u),loading:l(g),exportando:l(D),onExportar:handleExportar,onRefresh:l(I),onBaixar:baixarArquivo},null,o)),t(`<div class="space-y-6" style="${_("templates"===l(C)?null:{display:"none"})}"><div class="card"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold text-gray-800 flex items-center gap-2">`),t(b(z,{name:"heroicons:document-duplicate",class:"text-teal-600",size:"24"},null,o)),t(" Templates de Importa√ß√£o </h3>"),t(b(W,{onClick:abrirModalTemplate,theme:"admin",variant:"primary",size:"sm"},{default:n((e,a,t,o)=>{if(!a)return[c(z,{name:"heroicons:plus",class:"mr-1",size:"16"}),d("Novo Template ")];a(b(z,{name:"heroicons:plus",class:"mr-1",size:"16"},null,t,o)),a("Novo Template ")}),_:1},o)),t("</div>"),0===l(p).length?(t('<div class="text-center py-8">'),t(b(z,{name:"heroicons:document",class:"text-gray-300 mx-auto mb-2",size:"48"},null,o)),t('<p class="text-gray-500">Nenhum template cadastrado</p></div>')):(t('<div class="grid md:grid-cols-2 gap-4">\x3c!--[--\x3e'),y(l(p),e=>{t(b(J,{key:e.id,template:e,onEditar:editarTemplate,onBaixar:baixarTemplate,onExcluir:handleExcluirTemplate},null,o))}),t("\x3c!--]--\x3e</div>")),t(`</div></div><div class="space-y-6" style="${_("configuracoes"===l(C)?null:{display:"none"})}">`),t(b(G,{config:l(x),salvando:l(q),onSalvar:salvarConfiguracoes},null,o)),t("</div></div>"),l(M).aberto?t(b(X,{erros:l(M).erros,onClose:e=>l(M).aberto=!1},null,o)):t("\x3c!----\x3e"),l(O).aberto?t(b(K,{template:l(O).template,onClose:e=>l(O).aberto=!1,onSaved:onTemplateSaved},null,o)):t("\x3c!----\x3e"),t("</div>")}}}),ee=Z.setup;Z.setup=(e,a)=>{const t=g();return(t.modules||(t.modules=new Set)).add("pages/configuracoes/importacao-exportacao.vue"),ee?ee(e,a):void 0};export{Z as default};
