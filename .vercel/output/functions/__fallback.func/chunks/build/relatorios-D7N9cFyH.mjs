import{_ as e}from"./server.mjs";import{_ as o}from"./UserProfileDropdown-D7V90wtd.mjs";import{_ as a}from"./UISelect-C9tnEbh5.mjs";import{_ as t}from"./UIInput-CnioD5-Q.mjs";import{_ as r}from"./UIButton-BfdUCxqX.mjs";import{defineComponent as l,ref as i,computed as s,resolveComponent as n,mergeProps as d,withCtx as c,createVNode as p,unref as u,isRef as m,createTextVNode as v,toDisplayString as x,useSSRContext as g}from"vue";import{ssrRenderAttrs as f,ssrRenderComponent as b,ssrRenderList as h,ssrRenderClass as y,ssrInterpolate as _,ssrRenderAttr as $,ssrIncludeBooleanAttr as w,ssrLooseContain as C}from"vue/server-renderer";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"pinia";import"vue-router";import"@supabase/ssr";const k=l({__name:"ModalRelatorioTemplate",__ssrInlineRender:!0,props:{template:{}},emits:["close","saved"],setup(e,{emit:o}){const l=i(!1),s=i(""),m=i({id:"",nome:"",descricao:"",categoria:"colaboradores",entidade_principal:"colaboradores",campos_selecionados:[],formato_padrao:"pdf",orientacao:"portrait",incluir_logo:!0,incluir_cabecalho:!0,incluir_rodape:!0,ativo:!0});return(o,i,g,h)=>{const y=n("Icon"),$=t,k=a,z=r;i(`<div${f(d({class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},h))}><div class="bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto"><div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"><h2 class="text-xl font-bold text-gray-800">${_(e.template?"Editar Relat√≥rio":"Novo Relat√≥rio")}</h2><button class="text-gray-400 hover:text-gray-600">`),i(b(y,{name:"heroicons:x-mark",size:"24"},null,g)),i('</button></div><form class="p-6 space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Nome do Relat√≥rio *</label>'),i(b($,{modelValue:u(m).nome,"onUpdate:modelValue":e=>u(m).nome=e,required:"",placeholder:"Ex: Lista de Colaboradores Ativos"},null,g)),i(`</div><div><label class="block text-sm font-medium text-gray-700 mb-1">Descri√ß√£o</label><textarea rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent" placeholder="Descri√ß√£o do relat√≥rio...">${_(u(m).descricao)}</textarea></div><div class="grid md:grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Categoria *</label>`),i(b(k,{modelValue:u(m).categoria,"onUpdate:modelValue":e=>u(m).categoria=e,required:""},{default:c((e,o,a,t)=>{if(!o)return[p("option",{value:""},"Selecione"),p("option",{value:"colaboradores"},"Colaboradores"),p("option",{value:"folha"},"Folha de Pagamento"),p("option",{value:"ponto"},"Ponto"),p("option",{value:"ferias"},"F√©rias"),p("option",{value:"documentos"},"Documentos"),p("option",{value:"geral"},"Geral")];o(`<option value=""${t}>Selecione</option><option value="colaboradores"${t}>Colaboradores</option><option value="folha"${t}>Folha de Pagamento</option><option value="ponto"${t}>Ponto</option><option value="ferias"${t}>F√©rias</option><option value="documentos"${t}>Documentos</option><option value="geral"${t}>Geral</option>`)}),_:1},g)),i('</div><div><label class="block text-sm font-medium text-gray-700 mb-1">Entidade Principal *</label>'),i(b(k,{modelValue:u(m).entidade_principal,"onUpdate:modelValue":e=>u(m).entidade_principal=e,required:""},{default:c((e,o,a,t)=>{if(!o)return[p("option",{value:""},"Selecione"),p("option",{value:"colaboradores"},"colaboradores"),p("option",{value:"folha_pagamento"},"folha_pagamento"),p("option",{value:"registros_ponto"},"registros_ponto"),p("option",{value:"ferias"},"ferias"),p("option",{value:"documentos_colaboradores"},"documentos_colaboradores")];o(`<option value=""${t}>Selecione</option><option value="colaboradores"${t}>colaboradores</option><option value="folha_pagamento"${t}>folha_pagamento</option><option value="registros_ponto"${t}>registros_ponto</option><option value="ferias"${t}>ferias</option><option value="documentos_colaboradores"${t}>documentos_colaboradores</option>`)}),_:1},g)),i(`</div></div><div><label class="block text-sm font-medium text-gray-700 mb-1">Campos a Incluir *</label><textarea rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent font-mono text-sm" placeholder="Digite os campos separados por v√≠rgula\nEx: nome, cpf, cargo, departamento, salario" required>${_(u(s))}</textarea><p class="text-xs text-gray-500 mt-1">Separe os campos por v√≠rgula</p></div><div class="grid md:grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Formato Padr√£o</label>`),i(b(k,{modelValue:u(m).formato_padrao,"onUpdate:modelValue":e=>u(m).formato_padrao=e},{default:c((e,o,a,t)=>{if(!o)return[p("option",{value:"pdf"},"PDF"),p("option",{value:"excel"},"Excel"),p("option",{value:"csv"},"CSV"),p("option",{value:"json"},"JSON")];o(`<option value="pdf"${t}>PDF</option><option value="excel"${t}>Excel</option><option value="csv"${t}>CSV</option><option value="json"${t}>JSON</option>`)}),_:1},g)),i('</div><div><label class="block text-sm font-medium text-gray-700 mb-1">Orienta√ß√£o</label>'),i(b(k,{modelValue:u(m).orientacao,"onUpdate:modelValue":e=>u(m).orientacao=e},{default:c((e,o,a,t)=>{if(!o)return[p("option",{value:"portrait"},"Retrato"),p("option",{value:"landscape"},"Paisagem")];o(`<option value="portrait"${t}>Retrato</option><option value="landscape"${t}>Paisagem</option>`)}),_:1},g)),i(`</div></div><div class="space-y-2"><label class="flex items-center gap-2"><input type="checkbox"${w(Array.isArray(u(m).incluir_logo)?C(u(m).incluir_logo,null):u(m).incluir_logo)?" checked":""} class="rounded text-red-600 focus:ring-red-500"><span class="text-sm text-gray-700">Incluir logo da empresa</span></label><label class="flex items-center gap-2"><input type="checkbox"${w(Array.isArray(u(m).incluir_cabecalho)?C(u(m).incluir_cabecalho,null):u(m).incluir_cabecalho)?" checked":""} class="rounded text-red-600 focus:ring-red-500"><span class="text-sm text-gray-700">Incluir cabe√ßalho</span></label><label class="flex items-center gap-2"><input type="checkbox"${w(Array.isArray(u(m).incluir_rodape)?C(u(m).incluir_rodape,null):u(m).incluir_rodape)?" checked":""} class="rounded text-red-600 focus:ring-red-500"><span class="text-sm text-gray-700">Incluir rodap√©</span></label><label class="flex items-center gap-2"><input type="checkbox"${w(Array.isArray(u(m).ativo)?C(u(m).ativo,null):u(m).ativo)?" checked":""} class="rounded text-red-600 focus:ring-red-500"><span class="text-sm text-gray-700">Ativo</span></label></div><div class="flex gap-4 pt-4">`),i(b(z,{type:"button",onClick:e=>o.$emit("close"),theme:"admin",variant:"secondary","full-width":""},{default:c((e,o,a,t)=>{if(!o)return[v(" Cancelar ")];o(" Cancelar ")}),_:1},g)),i(b(z,{type:"submit",theme:"admin",variant:"primary","full-width":"",disabled:u(l)},{default:c((e,o,a,t)=>{if(!o)return[v(x(u(l)?"Salvando...":"Salvar"),1)];o(`${_(u(l)?"Salvando...":"Salvar")}`)}),_:1},g)),i("</div></form></div></div>")}}}),z=k.setup;k.setup=(e,o)=>{const a=g();return(a.modules||(a.modules=new Set)).add("components/ModalRelatorioTemplate.vue"),z?z(e,o):void 0};const P=Object.assign(k,{__name:"ModalRelatorioTemplate"}),S=l({__name:"relatorios",__ssrInlineRender:!0,setup(l){const x=i(!0),g=i("templates"),w=i(!1),C=i(null),k=i([]),z=i(""),S=i(""),R=[{id:"templates",label:"Templates",icon:"heroicons:document-text"},{id:"agendamentos",label:"Agendamentos",icon:"heroicons:clock"},{id:"historico",label:"Hist√≥rico",icon:"heroicons:archive-box"}],carregarTemplates=async()=>{x.value=!0;try{const e=await $fetch("/api/relatorios/templates");k.value=e.data||[]}catch(e){console.error("Erro ao carregar templates:",e),alert("Erro ao carregar relat√≥rios")}finally{x.value=!1}},V=s(()=>{let e=k.value;if(z.value&&(e=e.filter(e=>e.categoria===z.value)),S.value){const o=S.value.toLowerCase();e=e.filter(e=>e.nome.toLowerCase().includes(o)||e.descricao&&e.descricao.toLowerCase().includes(o))}return e.sort((e,o)=>e.favorito&&!o.favorito?-1:!e.favorito&&o.favorito?1:e.nome.localeCompare(o.nome))}),abrirModalTemplate=(e=null)=>{C.value=e,w.value=!0},fecharModalTemplate=()=>{w.value=!1,C.value=null};return(l,i,s,k)=>{const j=e,A=n("Icon"),E=o,U=a,D=t,I=r,F=P;i(`<div${f(d({class:"min-h-screen bg-gray-50"},k))}><header class="bg-white border-b border-gray-200 sticky top-0 z-40"><div class="max-w-7xl mx-auto px-8 py-4"><div class="flex items-center justify-between"><div class="flex items-center gap-4">`),i(b(j,{to:"/configuracoes",class:"w-10 h-10 bg-red-700 rounded-lg flex items-center justify-center hover:bg-red-800 transition-colors"},{default:c((e,o,a,t)=>{if(!o)return[p(A,{name:"heroicons:arrow-left",class:"text-white",size:"20"})];o(b(A,{name:"heroicons:arrow-left",class:"text-white",size:"20"},null,a,t))}),_:1},s)),i('<div><h1 class="text-xl font-bold text-gray-800">Relat√≥rios Personalizados</h1><p class="text-sm text-gray-500">Crie, agende e gere relat√≥rios customizados</p></div></div>'),i(b(E,{theme:"admin"},null,s)),i('</div></div></header><div class="bg-white border-b border-gray-200"><div class="max-w-7xl mx-auto px-8"><div class="flex gap-6">\x3c!--[--\x3e'),h(R,e=>{i(`<button class="${y([u(g)===e.id?"border-red-600 text-red-600":"border-transparent text-gray-600 hover:text-gray-800","px-4 py-3 font-medium text-sm border-b-2 transition-colors"])}">`),i(b(A,{name:e.icon,size:"18",class:"inline mr-2"},null,s)),i(` ${_(e.label)}</button>`)}),i('\x3c!--]--\x3e</div></div></div><div class="max-w-7xl mx-auto p-8">'),"templates"===u(g)?(i('<div><div class="card mb-6"><div class="flex flex-wrap gap-4 items-center justify-between"><div class="flex gap-4 items-center flex-1">'),i(b(U,{modelValue:u(z),"onUpdate:modelValue":e=>m(z)?z.value=e:null,class:"w-48"},{default:c((e,o,a,t)=>{if(!o)return[p("option",{value:""},"Todas as Categorias"),p("option",{value:"colaboradores"},"Colaboradores"),p("option",{value:"folha"},"Folha de Pagamento"),p("option",{value:"ponto"},"Ponto"),p("option",{value:"ferias"},"F√©rias"),p("option",{value:"documentos"},"Documentos"),p("option",{value:"geral"},"Geral")];o(`<option value=""${t}>Todas as Categorias</option><option value="colaboradores"${t}>Colaboradores</option><option value="folha"${t}>Folha de Pagamento</option><option value="ponto"${t}>Ponto</option><option value="ferias"${t}>F√©rias</option><option value="documentos"${t}>Documentos</option><option value="geral"${t}>Geral</option>`)}),_:1},s)),i(b(D,{modelValue:u(S),"onUpdate:modelValue":e=>m(S)?S.value=e:null,placeholder:"Buscar relat√≥rios...",class:"flex-1 max-w-md"},{prefix:c((e,o,a,t)=>{if(!o)return[p(A,{name:"heroicons:magnifying-glass",class:"text-gray-400",size:"20"})];o(b(A,{name:"heroicons:magnifying-glass",class:"text-gray-400",size:"20"},null,a,t))}),_:1},s)),i("</div>"),i(b(I,{onClick:e=>abrirModalTemplate(),theme:"admin"},{default:c((e,o,a,t)=>{if(!o)return[p(A,{name:"heroicons:plus",size:"20"}),v(" Novo Relat√≥rio ")];o(b(A,{name:"heroicons:plus",size:"20"},null,a,t)),o(" Novo Relat√≥rio ")}),_:1},s)),i("</div></div>"),u(x)?(i('<div class="card text-center py-12">'),i(b(A,{name:"heroicons:arrow-path",class:"animate-spin text-gray-400 mx-auto mb-4",size:"48"},null,s)),i('<p class="text-gray-600">Carregando relat√≥rios...</p></div>')):(i('<div class="grid md:grid-cols-2 gap-4">\x3c!--[--\x3e'),h(u(V),e=>{i(`<div class="card hover:shadow-lg transition-shadow"><div class="flex items-start justify-between mb-3"><div class="flex-1"><div class="flex items-center gap-2 mb-1"><h3 class="font-semibold text-gray-800">${_(e.nome)}</h3>`),e.favorito?i(b(A,{name:"heroicons:star-solid",class:"text-yellow-500",size:"16"},null,s)):i("\x3c!----\x3e"),i(`</div><p class="text-sm text-gray-600 mb-2">${_(e.descricao)}</p><div class="flex gap-2 flex-wrap"><span class="text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-700">${_(e.categoria)}</span><span class="text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-700">${_(e.formato_padrao?.toUpperCase())}</span>`),e.total_execucoes>0?i(`<span class="text-xs px-2 py-1 rounded-full bg-green-100 text-green-700">${_(e.total_execucoes)} execu√ß√µes </span>`):i("\x3c!----\x3e"),i('</div></div></div><div class="flex gap-2">'),i(b(I,{onClick:o=>(async e=>{if(confirm(`Gerar relat√≥rio "${e.nome}"?`))try{(await $fetch("/api/relatorios/gerar",{method:"POST",body:{template_id:e.id}})).success&&alert("‚úÖ Relat√≥rio gerado com sucesso!\n\nO arquivo ser√° baixado em instantes.")}catch(e){console.error("Erro ao gerar relat√≥rio:",e),alert("Erro ao gerar relat√≥rio")}})(e),theme:"admin",variant:"primary",size:"sm",class:"flex-1"},{default:c((e,o,a,t)=>{if(!o)return[p(A,{name:"heroicons:play",size:"16"}),v(" Gerar ")];o(b(A,{name:"heroicons:play",size:"16"},null,a,t)),o(" Gerar ")}),_:2},s)),i(`<button class="p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"${$("title",e.favorito?"Remover dos favoritos":"Adicionar aos favoritos")}>`),i(b(A,{name:e.favorito?"heroicons:star-solid":"heroicons:star",size:"18"},null,s)),i('</button><button class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors" title="Editar">'),i(b(A,{name:"heroicons:pencil",size:"18"},null,s)),i('</button><button class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors" title="Excluir">'),i(b(A,{name:"heroicons:trash",size:"18"},null,s)),i("</button></div></div>")}),i("\x3c!--]--\x3e</div>")),u(x)||0!==u(V).length?i("\x3c!----\x3e"):(i('<div class="card text-center py-12">'),i(b(A,{name:"heroicons:document-chart-bar",class:"text-gray-300 mx-auto mb-4",size:"64"},null,s)),i('<h3 class="text-lg font-semibold text-gray-800 mb-2">Nenhum relat√≥rio encontrado</h3><p class="text-gray-600 mb-4">Crie relat√≥rios personalizados para suas necessidades</p>'),i(b(I,{onClick:e=>abrirModalTemplate(),theme:"admin"},{default:c((e,o,a,t)=>{if(!o)return[p(A,{name:"heroicons:plus",size:"20"}),v(" Criar Primeiro Relat√≥rio ")];o(b(A,{name:"heroicons:plus",size:"20"},null,a,t)),o(" Criar Primeiro Relat√≥rio ")}),_:1},s)),i("</div>")),i("</div>")):i("\x3c!----\x3e"),"agendamentos"===u(g)?i('<div><div class="card"><p class="text-gray-600 text-center py-8"> üöß Agendamentos de relat√≥rios em desenvolvimento </p></div></div>'):i("\x3c!----\x3e"),"historico"===u(g)?i('<div><div class="card"><p class="text-gray-600 text-center py-8"> üöß Hist√≥rico de execu√ß√µes em desenvolvimento </p></div></div>'):i("\x3c!----\x3e"),i("</div>"),u(w)?i(b(F,{template:u(C),onClose:fecharModalTemplate,onSaved:carregarTemplates},null,s)):i("\x3c!----\x3e"),i("</div>")}}}),R=S.setup;S.setup=(e,o)=>{const a=g();return(a.modules||(a.modules=new Set)).add("pages/configuracoes/relatorios.vue"),R?R(e,o):void 0};export{S as default};
