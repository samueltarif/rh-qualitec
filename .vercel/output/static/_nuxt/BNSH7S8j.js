import{d as P,f as v,b as t,t as p,o as c,h as r,z as b,A as w,e as f,l as _,y as j,_ as M,F as q,j as F,k as T,s as ot,v as N,g as n,i as O,n as R,c as E,r as $,x as L,I as lt,B as G,w as I}from"./DNqCZqpD.js";const it={class:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8"},nt={class:"card"},rt={class:"text-2xl font-bold text-gray-800"},dt={class:"card"},mt={class:"text-2xl font-bold text-amber-600"},ut={class:"card"},ct={class:"text-2xl font-bold text-red-600"},pt={class:"card"},vt={class:"text-2xl font-bold text-green-600"},bt={class:"card"},xt={class:"text-2xl font-bold text-blue-600"},ft={class:"card"},gt={class:"text-2xl font-bold text-purple-600"},yt=P({__name:"CardEmailStats",props:{stats:{}},setup(a){return(g,e)=>(c(),v("div",it,[t("div",nt,[e[0]||(e[0]=t("div",{class:"text-sm text-gray-600 mb-1"},"Enviados",-1)),t("div",rt,p(a.stats.totalEnviados),1)]),t("div",dt,[e[1]||(e[1]=t("div",{class:"text-sm text-gray-600 mb-1"},"Pendentes",-1)),t("div",mt,p(a.stats.totalPendentes),1)]),t("div",ut,[e[2]||(e[2]=t("div",{class:"text-sm text-gray-600 mb-1"},"Falhas",-1)),t("div",ct,p(a.stats.totalFalhas),1)]),t("div",pt,[e[3]||(e[3]=t("div",{class:"text-sm text-gray-600 mb-1"},"Taxa Abertura",-1)),t("div",vt,p(a.stats.taxaAbertura)+"%",1)]),t("div",bt,[e[4]||(e[4]=t("div",{class:"text-sm text-gray-600 mb-1"},"Hoje",-1)),t("div",xt,p(a.stats.enviadosHoje),1)]),t("div",ft,[e[5]||(e[5]=t("div",{class:"text-sm text-gray-600 mb-1"},"Templates",-1)),t("div",gt,p(a.stats.totalTemplates),1)])]))}}),$t=Object.assign(yt,{__name:"CardEmailStats"}),_t={class:"card"},kt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},St={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Tt={class:"flex items-center"},Ct={class:"flex items-center"},Vt={class:"flex items-center"},wt={class:"flex gap-3 pt-4"},Ut=["disabled"],ht=["disabled"],Et=P({__name:"FormSmtpConfig",props:{smtp:{},salvando:{type:Boolean},testando:{type:Boolean}},emits:["salvar","testar"],setup(a){return(g,e)=>{const o=M;return c(),v("div",_t,[e[24]||(e[24]=t("h2",{class:"text-xl font-semibold mb-4"},"Configurações SMTP",-1)),t("form",{onSubmit:e[12]||(e[12]=j(i=>g.$emit("salvar"),["prevent"])),class:"space-y-4"},[t("div",kt,[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Servidor SMTP *",-1)),r(t("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>a.smtp.servidor_smtp=i),type:"text",required:"",placeholder:"smtp.gmail.com",class:"input"},null,512),[[b,a.smtp.servidor_smtp]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Porta *",-1)),r(t("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>a.smtp.porta=i),type:"number",required:"",placeholder:"587",class:"input"},null,512),[[b,a.smtp.porta,void 0,{number:!0}]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Usuário SMTP *",-1)),r(t("input",{"onUpdate:modelValue":e[2]||(e[2]=i=>a.smtp.usuario_smtp=i),type:"text",required:"",placeholder:"seu-email@empresa.com",class:"input"},null,512),[[b,a.smtp.usuario_smtp]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Senha SMTP *",-1)),r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=i=>a.smtp.senha_smtp=i),type:"password",required:"",placeholder:"••••••••",class:"input"},null,512),[[b,a.smtp.senha_smtp]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"E-mail Remetente *",-1)),r(t("input",{"onUpdate:modelValue":e[4]||(e[4]=i=>a.smtp.email_remetente=i),type:"email",required:"",placeholder:"noreply@empresa.com",class:"input"},null,512),[[b,a.smtp.email_remetente]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nome Remetente *",-1)),r(t("input",{"onUpdate:modelValue":e[5]||(e[5]=i=>a.smtp.nome_remetente=i),type:"text",required:"",placeholder:"RH Empresa",class:"input"},null,512),[[b,a.smtp.nome_remetente]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"E-mail Resposta",-1)),r(t("input",{"onUpdate:modelValue":e[6]||(e[6]=i=>a.smtp.email_resposta=i),type:"email",placeholder:"rh@empresa.com",class:"input"},null,512),[[b,a.smtp.email_resposta]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Timeout (segundos)",-1)),r(t("input",{"onUpdate:modelValue":e[7]||(e[7]=i=>a.smtp.timeout=i),type:"number",placeholder:"30",class:"input"},null,512),[[b,a.smtp.timeout,void 0,{number:!0}]])])]),t("div",St,[t("div",Tt,[r(t("input",{"onUpdate:modelValue":e[8]||(e[8]=i=>a.smtp.usa_ssl=i),type:"checkbox",id:"usa_ssl",class:"checkbox"},null,512),[[w,a.smtp.usa_ssl]]),e[21]||(e[21]=t("label",{for:"usa_ssl",class:"ml-2 text-sm text-gray-700"},"Usar SSL",-1))]),t("div",Ct,[r(t("input",{"onUpdate:modelValue":e[9]||(e[9]=i=>a.smtp.usa_tls=i),type:"checkbox",id:"usa_tls",class:"checkbox"},null,512),[[w,a.smtp.usa_tls]]),e[22]||(e[22]=t("label",{for:"usa_tls",class:"ml-2 text-sm text-gray-700"},"Usar TLS",-1))]),t("div",Vt,[r(t("input",{"onUpdate:modelValue":e[10]||(e[10]=i=>a.smtp.ativo=i),type:"checkbox",id:"smtp_ativo",class:"checkbox"},null,512),[[w,a.smtp.ativo]]),e[23]||(e[23]=t("label",{for:"smtp_ativo",class:"ml-2 text-sm text-gray-700"},"Ativo",-1))])]),t("div",wt,[t("button",{type:"submit",class:"btn-primary",disabled:a.salvando},[f(o,{name:"mdi:content-save",class:"mr-2"}),_(" "+p(a.salvando?"Salvando...":"Salvar Configurações"),1)],8,Ut),t("button",{type:"button",onClick:e[11]||(e[11]=i=>g.$emit("testar")),class:"btn-secondary",disabled:a.testando||!a.smtp.servidor_smtp},[f(o,{name:"mdi:test-tube",class:"mr-2"}),_(" "+p(a.testando?"Testando...":"Testar Conexão"),1)],8,ht)])],32)])}}}),Pt=Object.assign(Et,{__name:"FormSmtpConfig"}),Mt={class:"space-y-6"},qt={class:"flex justify-between items-center mb-4"},Ft={class:"grid grid-cols-1 gap-4"},At={class:"flex justify-between items-start"},jt={class:"flex-1"},Dt={class:"flex items-center gap-2 mb-2"},Nt={class:"text-lg font-semibold"},Ht={key:0,class:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded"},Bt={key:1,class:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded"},zt={class:"text-sm text-gray-600 mb-2"},It={class:"flex items-center gap-4 text-xs text-gray-500"},Ot={key:0},Rt={class:"flex gap-2"},Lt=["onClick"],Gt=["onClick"],Jt=P({__name:"SectionEmailTemplates",props:{templates:{}},emits:["novo","editar","excluir"],setup(a){return(g,e)=>{const o=M;return c(),v("div",Mt,[t("div",qt,[e[2]||(e[2]=t("div",null,[t("h2",{class:"text-xl font-semibold"},"Templates de E-mail"),t("p",{class:"text-sm text-gray-600"},"Gerencie templates reutilizáveis")],-1)),t("button",{onClick:e[0]||(e[0]=i=>g.$emit("novo")),class:"btn-primary"},[f(o,{name:"mdi:plus",class:"mr-2"}),e[1]||(e[1]=_(" Novo Template ",-1))])]),t("div",Ft,[(c(!0),v(q,null,F(a.templates,i=>(c(),v("div",{key:i.id,class:"card hover:shadow-lg transition-shadow"},[t("div",At,[t("div",jt,[t("div",Dt,[t("h3",Nt,p(i.nome),1),i.sistema?(c(),v("span",Ht,"Sistema")):T("",!0),i.ativo?T("",!0):(c(),v("span",Bt,"Inativo"))]),t("p",zt,p(i.descricao),1),t("div",It,[t("span",null,[f(o,{name:"mdi:tag",class:"inline"}),_(" "+p(i.categoria),1)]),t("span",null,[f(o,{name:"mdi:email-send",class:"inline"}),_(" "+p(i.total_enviados)+" enviados",1)]),i.total_enviados>0?(c(),v("span",Ot,[f(o,{name:"mdi:email-open",class:"inline"}),_(" "+p((i.total_abertos/i.total_enviados*100).toFixed(1))+"% abertos ",1)])):T("",!0)])]),t("div",Rt,[t("button",{onClick:l=>g.$emit("editar",i),class:"btn-icon",title:"Editar"},[f(o,{name:"mdi:pencil"})],8,Lt),i.sistema?T("",!0):(c(),v("button",{key:0,onClick:l=>g.$emit("excluir",i.id),class:"btn-icon text-red-600 hover:bg-red-50",title:"Excluir"},[f(o,{name:"mdi:delete"})],8,Gt))])])]))),128))])])}}}),Kt=Object.assign(Jt,{__name:"SectionEmailTemplates"}),Qt={class:"card"},Wt={class:"space-y-3"},Xt={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Yt=["onUpdate:modelValue"],Zt={class:"ml-2 text-sm text-gray-700"},te={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ee={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},se={class:"flex items-center pt-8"},ae={class:"flex items-center gap-4"},oe={class:"flex items-center"},le={class:"flex items-center"},ie={class:"flex gap-3 pt-4"},ne=["disabled"],re=P({__name:"FormComunicacaoConfig",props:{comunicacao:{},salvando:{type:Boolean}},emits:["salvar"],setup(a){const g=[{key:"notificar_admissao",label:"Admissão de colaborador"},{key:"notificar_demissao",label:"Demissão de colaborador"},{key:"notificar_aniversario",label:"Aniversário de colaborador"},{key:"notificar_ferias_aprovadas",label:"Férias aprovadas"},{key:"notificar_ferias_vencendo",label:"Férias vencendo"},{key:"notificar_documentos_vencendo",label:"Documentos vencendo"},{key:"notificar_ponto_inconsistente",label:"Ponto inconsistente"},{key:"notificar_folha_gerada",label:"Folha de pagamento gerada"}];return(e,o)=>{const i=M;return c(),v("div",Qt,[o[19]||(o[19]=t("h2",{class:"text-xl font-semibold mb-4"},"Notificações Automáticas",-1)),t("form",{onSubmit:o[8]||(o[8]=j(l=>e.$emit("salvar"),["prevent"])),class:"space-y-6"},[t("div",Wt,[o[9]||(o[9]=t("h3",{class:"font-medium text-gray-700"},"Eventos que Disparam E-mails",-1)),t("div",Xt,[(c(),v(q,null,F(g,l=>t("label",{key:l.key,class:"flex items-center"},[r(t("input",{"onUpdate:modelValue":C=>a.comunicacao[l.key]=C,type:"checkbox",class:"checkbox"},null,8,Yt),[[w,a.comunicacao[l.key]]]),t("span",Zt,p(l.label),1)])),64))])]),t("div",te,[t("div",null,[o[10]||(o[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Alerta Férias (dias)",-1)),r(t("input",{"onUpdate:modelValue":o[0]||(o[0]=l=>a.comunicacao.dias_alerta_ferias=l),type:"number",min:"1",class:"input"},null,512),[[b,a.comunicacao.dias_alerta_ferias,void 0,{number:!0}]])]),t("div",null,[o[11]||(o[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Alerta Documentos (dias)",-1)),r(t("input",{"onUpdate:modelValue":o[1]||(o[1]=l=>a.comunicacao.dias_alerta_documentos=l),type:"number",min:"1",class:"input"},null,512),[[b,a.comunicacao.dias_alerta_documentos,void 0,{number:!0}]])]),t("div",null,[o[12]||(o[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Alerta Aniversário (dias)",-1)),r(t("input",{"onUpdate:modelValue":o[2]||(o[2]=l=>a.comunicacao.dias_alerta_aniversario=l),type:"number",min:"0",class:"input"},null,512),[[b,a.comunicacao.dias_alerta_aniversario,void 0,{number:!0}]])])]),t("div",null,[o[16]||(o[16]=t("h3",{class:"font-medium text-gray-700 mb-3"},"Horários de Envio",-1)),t("div",ee,[t("div",null,[o[13]||(o[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Início",-1)),r(t("input",{"onUpdate:modelValue":o[3]||(o[3]=l=>a.comunicacao.horario_envio_inicio=l),type:"time",class:"input"},null,512),[[b,a.comunicacao.horario_envio_inicio]])]),t("div",null,[o[14]||(o[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Fim",-1)),r(t("input",{"onUpdate:modelValue":o[4]||(o[4]=l=>a.comunicacao.horario_envio_fim=l),type:"time",class:"input"},null,512),[[b,a.comunicacao.horario_envio_fim]])]),t("div",se,[r(t("input",{"onUpdate:modelValue":o[5]||(o[5]=l=>a.comunicacao.enviar_finais_semana=l),type:"checkbox",class:"checkbox"},null,512),[[w,a.comunicacao.enviar_finais_semana]]),o[15]||(o[15]=t("span",{class:"ml-2 text-sm text-gray-700"},"Enviar nos finais de semana",-1))])])]),t("div",ae,[t("label",oe,[r(t("input",{"onUpdate:modelValue":o[6]||(o[6]=l=>a.comunicacao.rastrear_abertura=l),type:"checkbox",class:"checkbox"},null,512),[[w,a.comunicacao.rastrear_abertura]]),o[17]||(o[17]=t("span",{class:"ml-2 text-sm text-gray-700"},"Rastrear abertura de e-mails",-1))]),t("label",le,[r(t("input",{"onUpdate:modelValue":o[7]||(o[7]=l=>a.comunicacao.rastrear_cliques=l),type:"checkbox",class:"checkbox"},null,512),[[w,a.comunicacao.rastrear_cliques]]),o[18]||(o[18]=t("span",{class:"ml-2 text-sm text-gray-700"},"Rastrear cliques em links",-1))])]),t("div",ie,[t("button",{type:"submit",class:"btn-primary",disabled:a.salvando},[f(i,{name:"mdi:content-save",class:"mr-2"}),_(" "+p(a.salvando?"Salvando...":"Salvar Configurações"),1)],8,ne)])],32)])}}}),de=Object.assign(re,{__name:"FormComunicacaoConfig"}),me={class:"card"},ue={class:"flex justify-between items-center mb-4"},ce={class:"overflow-x-auto"},pe={class:"table"},ve={class:"font-medium"},be={class:"text-xs text-gray-500"},xe={key:0,class:"text-sm text-gray-600"},fe={key:1,class:"text-xs text-gray-400"},ge=P({__name:"SectionEmailHistorico",props:{historico:{},filtroStatus:{}},emits:["update:filtroStatus"],setup(a,{emit:g}){const e=a,o=g,i=ot({get:()=>e.filtroStatus,set:k=>o("update:filtroStatus",k)}),l=k=>new Date(k).toLocaleString("pt-BR"),C=k=>({enviado:"bg-green-100 text-green-700",pendente:"bg-amber-100 text-amber-700",falha:"bg-red-100 text-red-700"})[k]||"bg-gray-100 text-gray-700";return(k,x)=>{const U=M;return c(),v("div",me,[t("div",ue,[x[2]||(x[2]=t("h2",{class:"text-xl font-semibold"},"Histórico de Envios",-1)),r(t("select",{"onUpdate:modelValue":x[0]||(x[0]=m=>O(i)?i.value=m:null),class:"input w-40"},[...x[1]||(x[1]=[t("option",{value:""},"Todos",-1),t("option",{value:"enviado"},"Enviados",-1),t("option",{value:"pendente"},"Pendentes",-1),t("option",{value:"falha"},"Falhas",-1)])],512),[[N,n(i)]])]),t("div",ce,[t("table",pe,[x[3]||(x[3]=t("thead",null,[t("tr",null,[t("th",null,"Data"),t("th",null,"Destinatário"),t("th",null,"Assunto"),t("th",null,"Template"),t("th",null,"Status"),t("th",null,"Aberto")])],-1)),t("tbody",null,[(c(!0),v(q,null,F(a.historico,m=>(c(),v("tr",{key:m.id},[t("td",null,p(l(m.created_at)),1),t("td",null,[t("div",ve,p(m.destinatario_nome),1),t("div",be,p(m.destinatario_email),1)]),t("td",null,p(m.assunto),1),t("td",null,[m.templates_email?(c(),v("span",xe,p(m.templates_email.nome),1)):(c(),v("span",fe,"-"))]),t("td",null,[t("span",{class:R(["px-2 py-1 text-xs rounded",C(m.status)])},p(m.status),3)]),t("td",null,[m.aberto_em?(c(),E(U,{key:0,name:"mdi:email-open",class:"text-green-600",title:"E-mail aberto"})):(c(),E(U,{key:1,name:"mdi:email",class:"text-gray-400",title:"Não aberto"}))])]))),128))])])])])}}}),ye=Object.assign(ge,{__name:"SectionEmailHistorico"}),$e={class:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col"},_e={class:"flex items-center justify-between p-6 border-b border-gray-200"},ke={class:"text-2xl font-bold text-gray-900"},Se={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3"},Te={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ce=["disabled"],Ve={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},we={class:"text-xs text-gray-500 mt-1"},Ue={class:"space-y-2"},he=["onUpdate:modelValue"],Ee=["onUpdate:modelValue"],Pe=["onClick"],Me={class:"flex items-center gap-4"},qe={class:"flex items-center"},Fe={class:"flex items-center"},Ae={class:"flex items-center justify-between gap-4 p-6 border-t border-gray-200 bg-gray-50"},je={class:"flex gap-3"},De=["disabled"],Ne=P({__name:"ModalTemplateEmail",props:{template:{}},emits:["close","saved"],setup(a,{emit:g}){const e=a,o=g,i=$(!1),l=$({codigo:"",nome:"",descricao:"",categoria:"",assunto:"",corpo_html:"",corpo_texto:"",prioridade:"normal",variaveis_disponiveis:[],ativo:!0,requer_confirmacao_leitura:!1});L(()=>{e.template&&(l.value={...l.value,...e.template,variaveis_disponiveis:e.template.variaveis_disponiveis||[]})});function C(){l.value.variaveis_disponiveis.push({nome:"",descricao:""})}function k(m){l.value.variaveis_disponiveis.splice(m,1)}function x(){G("/configuracoes")}async function U(){i.value=!0;try{e.template?(await $fetch(`/api/email/templates/${e.template.id}`,{method:"PUT",body:l.value}),alert("Template atualizado com sucesso!")):(await $fetch("/api/email/templates",{method:"POST",body:l.value}),alert("Template criado com sucesso!")),o("saved"),o("close")}catch(m){console.error("Erro ao salvar template:",m);const s=m?.data?.message||m?.message||"Erro ao salvar template";alert(`Erro: ${s}`)}finally{i.value=!1}}return(m,s)=>{const V=M;return c(),v("div",{class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:s[12]||(s[12]=j(d=>m.$emit("close"),["self"]))},[t("div",$e,[t("div",_e,[t("h2",ke,p(a.template?"Editar Template":"Novo Template"),1),t("button",{onClick:s[0]||(s[0]=d=>m.$emit("close")),class:"text-gray-400 hover:text-gray-600 transition-colors",type:"button"},[f(V,{name:"mdi:close",size:"28"})])]),t("form",{onSubmit:j(U,["prevent"]),class:"flex-1 overflow-y-auto p-6 space-y-4"},[a.template?.sistema?(c(),v("div",Se,[f(V,{name:"mdi:information",class:"text-blue-600 flex-shrink-0 mt-0.5",size:"20"}),s[13]||(s[13]=t("div",{class:"text-sm text-blue-800"},[t("strong",null,"Template do Sistema:"),_(" O código e categoria não podem ser alterados. Você pode editar o conteúdo, assunto e outras configurações. ")],-1))])):T("",!0),t("div",Te,[t("div",null,[s[14]||(s[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Código * ",-1)),r(t("input",{"onUpdate:modelValue":s[1]||(s[1]=d=>n(l).codigo=d),type:"text",required:"",disabled:a.template?.sistema,placeholder:"bem_vindo",class:"input"},null,8,Ce),[[b,n(l).codigo]]),s[15]||(s[15]=t("p",{class:"text-xs text-gray-500 mt-1"}," Identificador único (sem espaços) ",-1))]),t("div",null,[s[16]||(s[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nome * ",-1)),r(t("input",{"onUpdate:modelValue":s[2]||(s[2]=d=>n(l).nome=d),type:"text",required:"",placeholder:"Boas-vindas",class:"input"},null,512),[[b,n(l).nome]])])]),t("div",null,[s[17]||(s[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Descrição ",-1)),r(t("textarea",{"onUpdate:modelValue":s[3]||(s[3]=d=>n(l).descricao=d),rows:"2",placeholder:"Descrição do template",class:"input"},null,512),[[b,n(l).descricao]])]),t("div",Ve,[t("div",null,[s[19]||(s[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Categoria * ",-1)),r(t("select",{"onUpdate:modelValue":s[4]||(s[4]=d=>n(l).categoria=d),required:"",class:"input"},[...s[18]||(s[18]=[lt('<option value="">Selecione...</option><option value="sistema">Sistema</option><option value="rh">RH</option><option value="folha">Folha de Pagamento</option><option value="ferias">Férias</option><option value="ponto">Ponto</option><option value="documentos">Documentos</option>',7)])],512),[[N,n(l).categoria]])]),t("div",null,[s[21]||(s[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Prioridade ",-1)),r(t("select",{"onUpdate:modelValue":s[5]||(s[5]=d=>n(l).prioridade=d),class:"input"},[...s[20]||(s[20]=[t("option",{value:"baixa"},"Baixa",-1),t("option",{value:"normal"},"Normal",-1),t("option",{value:"alta"},"Alta",-1),t("option",{value:"urgente"},"Urgente",-1)])],512),[[N,n(l).prioridade]])])]),t("div",null,[s[22]||(s[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Assunto * ",-1)),r(t("input",{"onUpdate:modelValue":s[6]||(s[6]=d=>n(l).assunto=d),type:"text",required:"",placeholder:"Bem-vindo à {{nome_empresa}}!",class:"input"},null,512),[[b,n(l).assunto]]),t("p",we," Use "+p(m.variavel)+" para inserir dados dinâmicos ",1)]),t("div",null,[s[23]||(s[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Corpo HTML * ",-1)),r(t("textarea",{"onUpdate:modelValue":s[7]||(s[7]=d=>n(l).corpo_html=d),rows:"8",required:"",placeholder:"<h2>Olá {{nome_colaborador}}!</h2><p>Conteúdo do e-mail...</p>",class:"input font-mono text-sm"},null,512),[[b,n(l).corpo_html]])]),t("div",null,[s[24]||(s[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Corpo Texto (opcional) ",-1)),r(t("textarea",{"onUpdate:modelValue":s[8]||(s[8]=d=>n(l).corpo_texto=d),rows:"4",placeholder:"Versão em texto puro do e-mail",class:"input"},null,512),[[b,n(l).corpo_texto]])]),t("div",null,[s[26]||(s[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Variáveis Disponíveis ",-1)),t("div",Ue,[(c(!0),v(q,null,F(n(l).variaveis_disponiveis,(d,A)=>(c(),v("div",{key:A,class:"flex gap-2"},[r(t("input",{"onUpdate:modelValue":h=>d.nome=h,type:"text",placeholder:"nome_variavel",class:"input flex-1"},null,8,he),[[b,d.nome]]),r(t("input",{"onUpdate:modelValue":h=>d.descricao=h,type:"text",placeholder:"Descrição",class:"input flex-1"},null,8,Ee),[[b,d.descricao]]),t("button",{type:"button",onClick:h=>k(A),class:"btn-icon text-red-600"},[f(V,{name:"mdi:delete"})],8,Pe)]))),128)),t("button",{type:"button",onClick:C,class:"btn-secondary text-sm"},[f(V,{name:"mdi:plus",class:"mr-1"}),s[25]||(s[25]=_(" Adicionar Variável ",-1))])])]),t("div",Me,[t("div",qe,[r(t("input",{"onUpdate:modelValue":s[9]||(s[9]=d=>n(l).ativo=d),type:"checkbox",id:"template_ativo",class:"checkbox"},null,512),[[w,n(l).ativo]]),s[27]||(s[27]=t("label",{for:"template_ativo",class:"ml-2 text-sm text-gray-700"}," Ativo ",-1))]),t("div",Fe,[r(t("input",{"onUpdate:modelValue":s[10]||(s[10]=d=>n(l).requer_confirmacao_leitura=d),type:"checkbox",id:"confirmacao_leitura",class:"checkbox"},null,512),[[w,n(l).requer_confirmacao_leitura]]),s[28]||(s[28]=t("label",{for:"confirmacao_leitura",class:"ml-2 text-sm text-gray-700"}," Requer confirmação de leitura ",-1))])]),t("div",Ae,[t("button",{type:"button",onClick:x,class:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"},[f(V,{name:"mdi:arrow-left",size:"20"}),s[29]||(s[29]=_(" Voltar para Configurações ",-1))]),t("div",je,[t("button",{type:"button",onClick:s[11]||(s[11]=d=>m.$emit("close")),class:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"}," Cancelar "),t("button",{type:"submit",class:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:n(i)},[f(V,{name:"mdi:content-save",size:"20"}),_(" "+p(n(i)?"Salvando...":"Salvar"),1)],8,De)])])],32)])])}}}),He=Object.assign(Ne,{__name:"ModalTemplateEmail"}),Be={class:"container mx-auto px-4 py-8"},ze={class:"mb-6"},Ie={class:"mb-6"},Oe={class:"border-b border-gray-200"},Re={class:"-mb-px flex space-x-8"},Le=["onClick"],Ke=P({__name:"email",setup(a){const g=[{id:"smtp",label:"Configurações SMTP",icon:"mdi:email-settings"},{id:"templates",label:"Templates",icon:"mdi:email-edit"},{id:"comunicacao",label:"Notificações",icon:"mdi:bell"},{id:"historico",label:"Histórico",icon:"mdi:history"}],e=$("smtp"),o=$(!1),i=$(!1),l=$(!1),C=$(!1),k=$(null),x=$(""),U=$({totalEnviados:0,totalPendentes:0,totalFalhas:0,taxaAbertura:"0.0",enviadosHoje:0,totalTemplates:0}),m=$({servidor_smtp:"",porta:587,usa_ssl:!0,usa_tls:!0,usuario_smtp:"",senha_smtp:"",email_remetente:"",nome_remetente:"",email_resposta:"",timeout:30,ativo:!0}),s=$({notificar_admissao:!0,notificar_demissao:!0,notificar_aniversario:!0,notificar_ferias_aprovadas:!0,notificar_ferias_vencendo:!0,notificar_documentos_vencendo:!0,notificar_ponto_inconsistente:!0,notificar_folha_gerada:!0,dias_alerta_ferias:30,dias_alerta_documentos:15,dias_alerta_aniversario:3,horario_envio_inicio:"08:00",horario_envio_fim:"18:00",enviar_finais_semana:!1,rastrear_abertura:!0,rastrear_cliques:!0}),V=$([]),d=$([]),A=async()=>{try{U.value=await $fetch("/api/email/stats")}catch(u){console.error(u)}},h=async()=>{try{const u=await $fetch("/api/email/smtp");u&&(m.value={...m.value,...u})}catch(u){console.error(u)}},J=async()=>{try{const u=await $fetch("/api/email/comunicacao");u&&(s.value={...s.value,...u})}catch(u){console.error(u)}},D=async()=>{try{V.value=await $fetch("/api/email/templates")}catch(u){console.error(u)}},H=async()=>{try{const u=x.value?`?status=${x.value}`:"",y=await $fetch(`/api/email/historico${u}`);d.value=y.data}catch(u){console.error(u)}},K=async()=>{o.value=!0;try{await $fetch("/api/email/smtp",{method:"PUT",body:m.value}),alert("Configurações SMTP salvas!")}catch{alert("Erro ao salvar SMTP")}finally{o.value=!1}},Q=async()=>{l.value=!0;try{const u=await $fetch("/api/email/smtp-test",{method:"POST",body:m.value});alert(u.message),u.success&&await h()}catch{alert("Erro ao testar SMTP")}finally{l.value=!1}},W=async()=>{i.value=!0;try{await $fetch("/api/email/comunicacao",{method:"PUT",body:s.value}),alert("Configurações salvas!")}catch{alert("Erro ao salvar")}finally{i.value=!1}},B=(u=null)=>{k.value=u,C.value=!0},X=async u=>{if(confirm("Deseja excluir este template?"))try{await $fetch(`/api/email/templates/${u}`,{method:"DELETE"}),await D(),alert("Template excluído!")}catch{alert("Erro ao excluir")}};return I(e,u=>{u==="historico"&&H()}),I(x,()=>H()),L(()=>Promise.all([A(),h(),J(),D()])),(u,y)=>{const z=M,Y=$t,Z=Pt,tt=Kt,et=de,st=ye,at=He;return c(),v("div",Be,[t("div",ze,[t("button",{onClick:y[0]||(y[0]=S=>("navigateTo"in u?u.navigateTo:n(G))("/configuracoes")),class:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors shadow-sm"},[f(z,{name:"mdi:arrow-left",size:"20"}),y[4]||(y[4]=_(" Voltar para Configurações ",-1))])]),y[5]||(y[5]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-gray-800 mb-2"},"E-mail e Comunicação"),t("p",{class:"text-gray-600"},"Configure SMTP, templates de e-mail e notificações automáticas")],-1)),f(Y,{stats:n(U)},null,8,["stats"]),t("div",Ie,[t("div",Oe,[t("nav",Re,[(c(),v(q,null,F(g,S=>t("button",{key:S.id,onClick:Ge=>e.value=S.id,class:R(["py-4 px-1 border-b-2 font-medium text-sm transition-colors",n(e)===S.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"])},[f(z,{name:S.icon,class:"inline mr-2"},null,8,["name"]),_(p(S.label),1)],10,Le)),64))])])]),n(e)==="smtp"?(c(),E(Z,{key:0,smtp:n(m),salvando:n(o),testando:n(l),onSalvar:K,onTestar:Q},null,8,["smtp","salvando","testando"])):T("",!0),n(e)==="templates"?(c(),E(tt,{key:1,templates:n(V),onNovo:y[1]||(y[1]=S=>B()),onEditar:B,onExcluir:X},null,8,["templates"])):T("",!0),n(e)==="comunicacao"?(c(),E(et,{key:2,comunicacao:n(s),salvando:n(i),onSalvar:W},null,8,["comunicacao","salvando"])):T("",!0),n(e)==="historico"?(c(),E(st,{key:3,historico:n(d),filtroStatus:n(x),"onUpdate:filtroStatus":y[2]||(y[2]=S=>O(x)?x.value=S:null)},null,8,["historico","filtroStatus"])):T("",!0),n(C)?(c(),E(at,{key:4,template:n(k),onClose:y[3]||(y[3]=S=>C.value=!1),onSaved:D},null,8,["template"])):T("",!0)])}}});export{Ke as default};
