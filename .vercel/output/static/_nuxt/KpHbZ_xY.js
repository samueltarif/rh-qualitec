import{d as q,r as i,w as G,x as H,a as J,g as r,o as n,e,f as d,b as V,_ as O,t as s,h as l,i as U,v as $,j as y,p,n as A,F as j,k,l as z}from"./BSA_tgdP.js";import{_ as Q}from"./yUH5lwCE.js";import{_ as W}from"./Df5jURw6.js";import{_ as X}from"./BaRlud3k.js";import"./BBzIiODl.js";const Y={class:"min-h-screen bg-gray-50"},Z={class:"bg-white border-b border-gray-200 sticky top-0 z-40"},ee={class:"max-w-7xl mx-auto px-8 py-4"},te={class:"flex items-center justify-between"},oe={class:"flex items-center gap-4"},ae={class:"max-w-7xl mx-auto p-8"},se={class:"grid grid-cols-3 gap-4 mb-6"},re={class:"bg-amber-50 border border-amber-200 rounded-xl p-4 text-center"},ne={class:"text-2xl font-bold text-amber-700"},de={class:"bg-green-50 border border-green-200 rounded-xl p-4 text-center"},le={class:"text-2xl font-bold text-green-700"},ie={class:"bg-red-50 border border-red-200 rounded-xl p-4 text-center"},ce={class:"text-2xl font-bold text-red-700"},pe={class:"flex gap-4 mb-6"},me={key:0,class:"text-center py-12"},ue={key:1,class:"text-center py-12 bg-slate-50 rounded-xl"},xe={key:2,class:"space-y-4"},ve={class:"flex items-start justify-between"},_e={class:"flex items-center gap-3 mb-2"},be={class:"font-semibold text-slate-800"},ge={class:"text-sm text-slate-500"},fe={class:"text-sm text-slate-600 mb-3"},he={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},ye={class:"p-3 bg-red-50 rounded-lg"},we={class:"font-medium"},je={class:"p-3 bg-green-50 rounded-lg"},ke={class:"font-medium"},Ce={class:"text-xs text-slate-400 mt-3"},Re={key:0},De={key:0,class:"flex gap-2"},Ve=["onClick"],Ue=["onClick"],$e={class:"space-y-4"},Ae={class:"flex justify-end gap-3"},Ee=q({__name:"alteracoes-dados",setup(ze){const f=i(!0),w=i([]),h=i({pendentes:0,aprovadas:0,rejeitadas:0}),m=i(""),u=i(""),x=i(!1),v=i(""),C=i(null),S=async()=>{try{const o=await $fetch("/api/admin/alteracoes-dados/stats");h.value=o}catch(o){console.error("Erro ao carregar stats:",o)}},_=async()=>{f.value=!0;try{const o=new URLSearchParams;m.value&&o.append("status",m.value),u.value&&o.append("tipo",u.value),w.value=await $fetch(`/api/admin/alteracoes-dados?${o}`),await S()}catch(o){console.error(o)}finally{f.value=!1}};G([m,u],_),H(_);const P=o=>({"bg-amber-100 text-amber-700":o==="pendente","bg-green-100 text-green-700":o==="aprovada","bg-red-100 text-red-700":o==="rejeitada"}),N=o=>({pendente:"Pendente",aprovada:"Aprovada",rejeitada:"Rejeitada"})[o]||o,T=o=>({dados_bancarios:"Dados Bancários",endereco:"Endereço",contato_emergencia:"Contato de Emergência",dados_pessoais:"Dados Pessoais",documentos:"Documentos"})[o]||o,R=o=>o.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase()),D=o=>new Date(o).toLocaleString("pt-BR"),B=async o=>{if(confirm("Confirma a aprovação desta alteração?"))try{await $fetch(`/api/admin/alteracoes-dados/${o.id}`,{method:"PUT",body:{acao:"aprovar"}}),_()}catch(t){alert(t.data?.message||"Erro ao aprovar")}},E=o=>{C.value=o,v.value="",x.value=!0},I=async()=>{if(!v.value.trim()){alert("Informe o motivo da rejeição");return}try{await $fetch(`/api/admin/alteracoes-dados/${C.value.id}`,{method:"PUT",body:{acao:"rejeitar",motivo:v.value}}),x.value=!1,_()}catch(o){alert(o.data?.message||"Erro ao rejeitar")}};return(o,t)=>{const c=J("Icon"),L=O,M=Q,F=W,K=X;return n(),r("div",Y,[e("header",Z,[e("div",ee,[e("div",te,[e("div",oe,[d(L,{to:"/admin",class:"w-10 h-10 bg-red-700 rounded-lg flex items-center justify-center hover:bg-red-800 transition-colors"},{default:V(()=>[d(c,{name:"heroicons:arrow-left",class:"text-white",size:"20"})]),_:1}),t[5]||(t[5]=e("div",null,[e("h1",{class:"text-xl font-bold text-gray-800"},"Alterações de Dados"),e("p",{class:"text-sm text-gray-500"},"Aprovar ou rejeitar solicitações de alteração de dados bancários")],-1))]),d(M,{theme:"admin"})])])]),e("div",ae,[e("div",se,[e("div",re,[e("p",ne,s(l(h).pendentes),1),t[6]||(t[6]=e("p",{class:"text-sm text-amber-600"},"Pendentes",-1))]),e("div",de,[e("p",le,s(l(h).aprovadas),1),t[7]||(t[7]=e("p",{class:"text-sm text-green-600"},"Aprovadas",-1))]),e("div",ie,[e("p",ce,s(l(h).rejeitadas),1),t[8]||(t[8]=e("p",{class:"text-sm text-red-600"},"Rejeitadas",-1))])]),e("div",pe,[U(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>y(m)?m.value=a:null),class:"px-3 py-2 border border-slate-300 rounded-lg"},[...t[9]||(t[9]=[e("option",{value:""},"Todos os status",-1),e("option",{value:"pendente"},"Pendentes",-1),e("option",{value:"aprovada"},"Aprovadas",-1),e("option",{value:"rejeitada"},"Rejeitadas",-1)])],512),[[$,l(m)]]),U(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>y(u)?u.value=a:null),class:"px-3 py-2 border border-slate-300 rounded-lg"},[...t[10]||(t[10]=[e("option",{value:""},"Todos os tipos",-1),e("option",{value:"dados_bancarios"},"Dados Bancários",-1)])],512),[[$,l(u)]]),e("button",{onClick:_,class:"px-4 py-2 bg-slate-800 text-white rounded-lg hover:bg-slate-700 flex items-center gap-2"},[d(c,{name:"heroicons:arrow-path",class:A({"animate-spin":l(f)}),size:"18"},null,8,["class"]),t[11]||(t[11]=p(" Atualizar ",-1))])]),l(f)?(n(),r("div",me,[d(c,{name:"heroicons:arrow-path",class:"animate-spin text-slate-400",size:"32"})])):l(w).length===0?(n(),r("div",ue,[d(c,{name:"heroicons:check-circle",class:"text-green-400 mx-auto",size:"48"}),t[12]||(t[12]=e("p",{class:"text-slate-600 mt-2"},"Nenhuma solicitação encontrada",-1))])):(n(),r("div",xe,[(n(!0),r(j,null,k(l(w),a=>(n(),r("div",{key:a.id,class:"bg-white border border-slate-200 rounded-xl p-5"},[e("div",ve,[e("div",null,[e("div",_e,[e("span",be,s(a.colaborador?.nome),1),e("span",ge,s(a.colaborador?.matricula),1),e("span",{class:A([P(a.status),"px-2 py-0.5 text-xs font-medium rounded-full"])},s(N(a.status)),3)]),e("p",fe,[d(c,{name:"heroicons:banknotes",class:"inline mr-1"}),p(" Alteração de "+s(T(a.tipo)),1)]),e("div",he,[e("div",ye,[t[13]||(t[13]=e("p",{class:"font-medium text-red-700 mb-2"},"Dados Atuais",-1)),(n(!0),r(j,null,k(a.dados_anteriores,(b,g)=>(n(),r("div",{key:g,class:"text-slate-600"},[e("span",we,s(R(g))+":",1),p(" "+s(b||"-"),1)]))),128))]),e("div",je,[t[14]||(t[14]=e("p",{class:"font-medium text-green-700 mb-2"},"Novos Dados",-1)),(n(!0),r(j,null,k(a.dados_novos,(b,g)=>(n(),r("div",{key:g,class:"text-slate-600"},[e("span",ke,s(R(g))+":",1),p(" "+s(b||"-"),1)]))),128))])]),e("p",Ce,[p(" Solicitado em "+s(D(a.created_at))+" ",1),a.aprovado_em?(n(),r("span",Re," • "+s(a.status==="aprovada"?"Aprovado":"Rejeitado")+" em "+s(D(a.aprovado_em))+" por "+s(a.aprovador?.nome),1)):z("",!0)])]),a.status==="pendente"?(n(),r("div",De,[e("button",{onClick:b=>B(a),class:"px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700"},[d(c,{name:"heroicons:check",size:"16",class:"mr-1"}),t[15]||(t[15]=p("Aprovar ",-1))],8,Ve),e("button",{onClick:b=>E(a),class:"px-3 py-1.5 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700"},[d(c,{name:"heroicons:x-mark",size:"16",class:"mr-1"}),t[16]||(t[16]=p("Rejeitar ",-1))],8,Ue)])):z("",!0)])]))),128))])),d(K,{modelValue:l(x),"onUpdate:modelValue":t[4]||(t[4]=a=>y(x)?x.value=a:null),title:"Rejeitar Solicitação"},{default:V(()=>[e("div",$e,[d(F,{modelValue:l(v),"onUpdate:modelValue":t[2]||(t[2]=a=>y(v)?v.value=a:null),label:"Motivo da Rejeição",placeholder:"Informe o motivo...",rows:"3"},null,8,["modelValue"]),e("div",Ae,[e("button",{onClick:t[3]||(t[3]=a=>x.value=!1),class:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg"},"Cancelar"),e("button",{onClick:I,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"},"Confirmar Rejeição")])])]),_:1},8,["modelValue"])])])}}});export{Ee as default};
