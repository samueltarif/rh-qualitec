import{d as A,r as n,x as E,w as z,f as S,b as a,e as s,a as L,g as o,l as u,n as d,t as p,_ as N,p as P,o as M}from"./DNqCZqpD.js";import{_ as V}from"./BDJByVvn.js";import"./DdnJSzYT.js";const j={class:"min-h-screen bg-gray-50"},D={class:"bg-white border-b border-gray-200 sticky top-0 z-40"},T={class:"max-w-7xl mx-auto px-8 py-4"},I={class:"flex items-center justify-between"},O={class:"flex items-center gap-4"},U={class:"flex items-center gap-3"},F=["disabled"],G={class:"max-w-7xl mx-auto p-8"},H={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8"},J={class:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white"},K={class:"flex items-center gap-3"},Q={class:"text-2xl font-bold"},R={class:"card bg-gradient-to-br from-green-500 to-green-600 text-white"},W={class:"flex items-center gap-3"},X={class:"text-2xl font-bold"},Y={class:"card bg-gradient-to-br from-purple-500 to-purple-600 text-white"},Z={class:"flex items-center gap-3"},aa={class:"text-2xl font-bold"},ta={class:"card bg-gradient-to-br from-amber-500 to-amber-600 text-white"},ea={class:"flex items-center gap-3"},sa={class:"text-2xl font-bold"},oa={class:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6"},ra={class:"flex border-b border-gray-200 overflow-x-auto"},ua=A({__name:"seguranca",setup(ia){const i=n("backup");n(!1);const c=n(!1),l=n({backups:{total:0,sucesso:0,erro:0,ultimo:null},sessoes:{ativas:0,total:0},logs:{total:0,sucessos:0,erros:0,logins:0},auditoria:{total:0,creates:0,updates:0,deletes:0},tentativas_login:{total:0,sucesso:0,falhas:0}}),_=n({backup_automatico:!0,frequencia:"diario",horario_backup:"02:00:00",dia_semana:1,dia_mes:1,manter_backups_dias:30,manter_backups_quantidade:10,incluir_colaboradores:!0,incluir_documentos:!0,incluir_folha:!0,incluir_ponto:!0,incluir_ferias:!0,incluir_configuracoes:!0,notificar_backup_sucesso:!1,notificar_backup_erro:!0,emails_notificacao:[],criptografar_backup:!0}),g=n({senha_minimo_caracteres:8,senha_requer_maiuscula:!0,senha_requer_minuscula:!0,senha_requer_numero:!0,senha_requer_especial:!0,senha_expira_dias:90,senha_historico:5,max_tentativas_login:5,bloqueio_temporario_minutos:30,sessao_expira_horas:8,logout_automatico_inatividade:!0,inatividade_minutos:30,requer_2fa:!1,permitir_multiplas_sessoes:!0,registrar_todos_acessos:!0,registrar_mudancas_dados:!0,manter_logs_dias:90,termo_uso_obrigatorio:!0}),b=n([]),x=n([]),f=n([]),h=async()=>{try{const t=await $fetch("/api/seguranca/stats");l.value=t}catch(t){console.error("Erro ao carregar stats:",t)}},y=async()=>{try{const t=await $fetch("/api/seguranca/config-backup");t&&(_.value={..._.value,...t})}catch(t){console.error("Erro ao carregar config backup:",t)}},k=async()=>{try{const t=await $fetch("/api/seguranca/politicas");t&&(g.value={...g.value,...t})}catch(t){console.error("Erro ao carregar políticas:",t)}},v=async()=>{try{const t=await $fetch("/api/seguranca/backups");b.value=t}catch(t){console.error("Erro ao carregar backups:",t),b.value=[]}},w=async()=>{try{const t=await $fetch("/api/seguranca/logs-acesso",{params:{limit:100}});x.value=t}catch(t){console.error("Erro ao carregar logs:",t),x.value=[]}},B=async()=>{try{const t=await $fetch("/api/seguranca/auditoria",{params:{limit:100}});f.value=t}catch(t){console.error("Erro ao carregar auditorias:",t),f.value=[]}},$=async()=>{if(confirm("Criar backup manual agora?")){c.value=!0;try{await $fetch("/api/seguranca/backup-manual",{method:"POST"}),alert("Backup iniciado com sucesso!"),await v(),await h()}catch{alert("Erro ao criar backup")}finally{c.value=!1}}};return E(()=>{h(),y(),k(),v()}),z(i,t=>{t==="logs"&&w(),t==="auditoria"&&B()}),(t,e)=>{const r=N,C=P,q=V;return M(),S("div",j,[a("header",D,[a("div",T,[a("div",I,[a("div",O,[s(C,{to:"/configuracoes",class:"w-10 h-10 bg-red-700 rounded-lg flex items-center justify-center hover:bg-red-800 transition-colors"},{default:L(()=>[s(r,{name:"heroicons:arrow-left",class:"text-white",size:"20"})]),_:1}),e[4]||(e[4]=a("div",null,[a("h1",{class:"text-xl font-bold text-gray-800"},"Backup e Segurança"),a("p",{class:"text-sm text-gray-500"},"Backups automáticos, logs de acesso e auditoria")],-1))]),a("div",U,[a("button",{onClick:$,disabled:o(c),class:"btn-secondary"},[s(r,{name:o(c)?"heroicons:arrow-path":"heroicons:arrow-down-tray",class:d([{"animate-spin":o(c)},"mr-2"])},null,8,["name","class"]),e[5]||(e[5]=u(" Backup Manual ",-1))],8,F),s(q,{theme:"admin"})])])])]),a("div",G,[a("div",H,[a("div",J,[a("div",K,[s(r,{name:"heroicons:server",size:"32",class:"opacity-80"}),a("div",null,[a("p",Q,p(o(l).backups.total),1),e[6]||(e[6]=a("p",{class:"text-sm opacity-80"},"Backups",-1))])])]),a("div",R,[a("div",W,[s(r,{name:"heroicons:user-group",size:"32",class:"opacity-80"}),a("div",null,[a("p",X,p(o(l).sessoes.ativas),1),e[7]||(e[7]=a("p",{class:"text-sm opacity-80"},"Sessões Ativas",-1))])])]),a("div",Y,[a("div",Z,[s(r,{name:"heroicons:document-text",size:"32",class:"opacity-80"}),a("div",null,[a("p",aa,p(o(l).logs.total),1),e[8]||(e[8]=a("p",{class:"text-sm opacity-80"},"Logs (30d)",-1))])])]),a("div",ta,[a("div",ea,[s(r,{name:"heroicons:shield-check",size:"32",class:"opacity-80"}),a("div",null,[a("p",sa,p(o(l).auditoria.total),1),e[9]||(e[9]=a("p",{class:"text-sm opacity-80"},"Auditorias (30d)",-1))])])])]),a("div",oa,[a("div",ra,[a("button",{onClick:e[0]||(e[0]=m=>i.value="backup"),class:d(["px-6 py-3 font-medium transition-colors whitespace-nowrap",o(i)==="backup"?"text-red-700 border-b-2 border-red-700":"text-gray-500 hover:text-gray-700"])},[s(r,{name:"heroicons:server",class:"inline mr-2"}),e[10]||(e[10]=u(" Backup ",-1))],2),a("button",{onClick:e[1]||(e[1]=m=>i.value="politicas"),class:d(["px-6 py-3 font-medium transition-colors whitespace-nowrap",o(i)==="politicas"?"text-red-700 border-b-2 border-red-700":"text-gray-500 hover:text-gray-700"])},[s(r,{name:"heroicons:shield-check",class:"inline mr-2"}),e[11]||(e[11]=u(" Políticas de Segurança ",-1))],2),a("button",{onClick:e[2]||(e[2]=m=>i.value="logs"),class:d(["px-6 py-3 font-medium transition-colors whitespace-nowrap",o(i)==="logs"?"text-red-700 border-b-2 border-red-700":"text-gray-500 hover:text-gray-700"])},[s(r,{name:"heroicons:document-text",class:"inline mr-2"}),e[12]||(e[12]=u(" Logs de Acesso ",-1))],2),a("button",{onClick:e[3]||(e[3]=m=>i.value="auditoria"),class:d(["px-6 py-3 font-medium transition-colors whitespace-nowrap",o(i)==="auditoria"?"text-red-700 border-b-2 border-red-700":"text-gray-500 hover:text-gray-700"])},[s(r,{name:"heroicons:clipboard-document-list",class:"inline mr-2"}),e[13]||(e[13]=u(" Auditoria ",-1))],2)])]),e[14]||(e[14]=a("div",{class:"text-center py-12 text-gray-500"}," Selecione uma aba acima ",-1))])])}}});export{ua as default};
