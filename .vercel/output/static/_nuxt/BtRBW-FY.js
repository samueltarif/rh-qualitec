import{_ as gt}from"./6ATFcLRG.js";import{d as S,a as T,g as c,l as v,o as l,e as t,f as r,t as f,p as b,b as h,F as z,k as U,n as B,r as k,c as M,i as E,A as V,y as vt,h as p,z as bt,s as yt,w as $t,x as ht,M as O}from"./BSA_tgdP.js";import{_ as R}from"./DUWoehAD.js";import{_ as D}from"./BBzIiODl.js";import{_ as L}from"./yogEyCnZ.js";import"./yUH5lwCE.js";const kt={key:0,class:"bg-red-50 border-l-4 border-red-500 p-6 mb-6 rounded-lg"},It={class:"flex items-start gap-4"},Et={class:"flex-1"},wt={class:"text-lg font-semibold text-red-800 mb-2"},Ct={class:"text-red-700 mb-3"},_t={class:"bg-white p-4 rounded border border-red-200 mb-3"},Vt={class:"text-sm text-gray-700 space-y-1 list-decimal list-inside"},St={class:"bg-gray-100 px-2 py-0.5 rounded text-xs"},Tt={href:"https://supabase.com/dashboard",target:"_blank",class:"inline-flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium"},zt=S({__name:"CardMigrationWarning",props:{show:{type:Boolean},titulo:{},mensagem:{},arquivoMigration:{}},setup(e){return(y,o)=>{const x=T("Icon");return e.show?(l(),c("div",kt,[t("div",It,[r(x,{name:"heroicons:exclamation-triangle",class:"text-red-600 flex-shrink-0 mt-1",size:"24"}),t("div",Et,[t("h3",wt,f(e.titulo),1),t("p",Ct,f(e.mensagem),1),t("div",_t,[o[4]||(o[4]=t("p",{class:"text-sm font-medium text-gray-800 mb-2"},"ðŸ“‹ Passos rÃ¡pidos:",-1)),t("ol",Vt,[o[1]||(o[1]=t("li",null,"Acesse o Supabase SQL Editor",-1)),t("li",null,[o[0]||(o[0]=b("Copie o conteÃºdo de: ",-1)),t("code",St,f(e.arquivoMigration),1)]),o[2]||(o[2]=t("li",null,"Execute o SQL",-1)),o[3]||(o[3]=t("li",null,"Recarregue esta pÃ¡gina",-1))])]),t("a",Tt,[r(x,{name:"heroicons:arrow-top-right-on-square",size:"16"}),o[5]||(o[5]=b(" Abrir Supabase ",-1))])])])])):v("",!0)}}}),Ut=Object.assign(zt,{__name:"CardMigrationWarning"}),Dt={class:"card"},qt={class:"flex items-center justify-between mb-4"},Bt={class:"text-lg font-semibold text-gray-800 flex items-center gap-2"},Ft={key:0,class:"text-center py-8"},Mt={key:1,class:"text-center py-8"},At={key:2,class:"overflow-x-auto"},Pt={class:"w-full"},jt={class:"bg-gray-50 border-b border-gray-200"},Ot={key:0,class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Rt={key:1,class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Nt={class:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase"},Ht={key:2,class:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase"},Lt={key:3,class:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase"},Wt={key:4,class:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase"},Jt={class:"divide-y divide-gray-200"},Gt={class:"px-4 py-3 text-sm text-gray-900"},Qt={class:"px-4 py-3 text-sm text-gray-700"},Xt={key:0,class:"px-4 py-3 text-sm text-gray-700"},Kt={key:1,class:"px-4 py-3 text-sm text-gray-700 uppercase"},Yt={class:"px-4 py-3 text-sm text-center text-gray-900"},Zt={key:2,class:"px-4 py-3 text-sm text-center text-green-600 font-medium"},te={key:3,class:"px-4 py-3 text-sm text-center text-red-600 font-medium"},ee={key:4,class:"px-4 py-3 text-sm text-center text-gray-700"},oe={class:"px-4 py-3 text-center"},ae={class:"px-4 py-3 text-center"},se=["onClick"],ne=["onClick"],re={key:2,class:"text-xs text-gray-400"},ie=S({__name:"WidgetHistoricoOperacoes",props:{titulo:{},items:{},loading:{type:Boolean},tipo:{}},emits:["refresh","ver-erros","baixar"],setup(e){const y=a=>new Date(a).toLocaleString("pt-BR"),o=a=>({colaboradores:"Colaboradores",usuarios:"UsuÃ¡rios",ferias:"FÃ©rias",documentos:"Documentos",ponto:"Ponto",folha:"Folha",departamentos:"Departamentos",cargos:"Cargos",jornadas:"Jornadas"})[a]||a,x=a=>({processando:"Processando",concluido:"ConcluÃ­do",erro:"Erro",parcial:"Parcial",expirado:"Expirado"})[a]||a,s=a=>({processando:"bg-blue-100 text-blue-700",concluido:"bg-green-100 text-green-700",erro:"bg-red-100 text-red-700",parcial:"bg-yellow-100 text-yellow-700",expirado:"bg-gray-100 text-gray-600"})[a]||"bg-gray-100 text-gray-600",m=a=>a?a<1024?a+" B":a<1048576?(a/1024).toFixed(1)+" KB":(a/1048576).toFixed(1)+" MB":"-";return(a,n)=>{const u=T("Icon"),w=D;return l(),c("div",Dt,[t("div",qt,[t("h3",Bt,[r(u,{name:"heroicons:clock",class:"text-gray-600",size:"24"}),b(" "+f(e.titulo),1)]),r(w,{onClick:n[0]||(n[0]=d=>a.$emit("refresh")),theme:"admin",variant:"secondary",size:"sm"},{default:h(()=>[r(u,{name:"heroicons:arrow-path",class:"mr-1",size:"16"}),n[1]||(n[1]=b(" Atualizar ",-1))]),_:1})]),e.loading?(l(),c("div",Ft,[r(u,{name:"heroicons:arrow-path",class:"animate-spin text-gray-400 mx-auto mb-2",size:"32"}),n[2]||(n[2]=t("p",{class:"text-sm text-gray-600"},"Carregando...",-1))])):e.items.length===0?(l(),c("div",Mt,[r(u,{name:"heroicons:inbox",class:"text-gray-300 mx-auto mb-2",size:"48"}),n[3]||(n[3]=t("p",{class:"text-gray-500"},"Nenhum registro encontrado",-1))])):(l(),c("div",At,[t("table",Pt,[t("thead",jt,[t("tr",null,[n[4]||(n[4]=t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Data",-1)),n[5]||(n[5]=t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Tipo",-1)),e.tipo==="importacao"?(l(),c("th",Ot,"Arquivo")):v("",!0),e.tipo==="exportacao"?(l(),c("th",Rt,"Formato")):v("",!0),t("th",Nt,f(e.tipo==="importacao"?"Total":"Registros"),1),e.tipo==="importacao"?(l(),c("th",Ht,"Sucesso")):v("",!0),e.tipo==="importacao"?(l(),c("th",Lt,"Erros")):v("",!0),e.tipo==="exportacao"?(l(),c("th",Wt,"Tamanho")):v("",!0),n[6]||(n[6]=t("th",{class:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase"},"Status",-1)),n[7]||(n[7]=t("th",{class:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase"},"AÃ§Ãµes",-1))])]),t("tbody",Jt,[(l(!0),c(z,null,U(e.items,d=>(l(),c("tr",{key:d.id,class:"hover:bg-gray-50"},[t("td",Gt,f(y(d.created_at)),1),t("td",Qt,f(o(d.tipo_entidade)),1),e.tipo==="importacao"?(l(),c("td",Xt,f(d.arquivo_nome),1)):v("",!0),e.tipo==="exportacao"?(l(),c("td",Kt,f(d.formato),1)):v("",!0),t("td",Yt,f(d.total_registros),1),e.tipo==="importacao"?(l(),c("td",Zt,f(d.registros_sucesso),1)):v("",!0),e.tipo==="importacao"?(l(),c("td",te,f(d.registros_erro),1)):v("",!0),e.tipo==="exportacao"?(l(),c("td",ee,f(m(d.arquivo_tamanho)),1)):v("",!0),t("td",oe,[t("span",{class:B(["px-2 py-1 text-xs font-medium rounded-full",s(d.status)])},f(x(d.status)),3)]),t("td",ae,[e.tipo==="importacao"&&d.registros_erro>0?(l(),c("button",{key:0,onClick:g=>a.$emit("ver-erros",d),class:"text-teal-600 hover:text-teal-800 text-sm"},"Ver Erros",8,se)):v("",!0),e.tipo==="exportacao"&&d.status==="concluido"&&d.arquivo_url?(l(),c("button",{key:1,onClick:g=>a.$emit("baixar",d),class:"text-teal-600 hover:text-teal-800 text-sm font-medium"},[r(u,{name:"heroicons:arrow-down-tray",class:"inline mr-1",size:"16"}),n[8]||(n[8]=b("Baixar ",-1))],8,ne)):v("",!0),e.tipo==="exportacao"&&d.status==="expirado"?(l(),c("span",re,"Expirado")):v("",!0)])]))),128))])])]))])}}}),J=Object.assign(ie,{__name:"WidgetHistoricoOperacoes"}),le={class:"space-y-6"},de={class:"card"},me={class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},ce={class:"space-y-4"},ue=["value"],pe={key:0},xe=["value"],fe={key:1,class:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-teal-500 transition-colors"},ge={class:"text-gray-600 mb-2"},ve={key:2,class:"space-y-3 bg-gray-50 p-4 rounded-lg"},be={class:"flex items-center gap-2"},ye={class:"flex items-center gap-2"},$e={class:"flex items-center gap-2"},he=S({__name:"SectionImportarDados",props:{form:{},templatesDisponiveis:{},historico:{},loading:{type:Boolean},importando:{type:Boolean}},emits:["importar","refresh","ver-erros"],setup(e){const y=e,o=k(),x=[{value:"colaboradores",label:"Colaboradores"},{value:"usuarios",label:"UsuÃ¡rios"},{value:"ferias",label:"FÃ©rias"},{value:"documentos",label:"Documentos (Metadados)"},{value:"ponto",label:"Registros de Ponto"},{value:"folha",label:"Dados de Folha"}],s=m=>{const a=m.target;a.files&&a.files[0]&&(y.form.arquivo=a.files[0])};return(m,a)=>{const n=T("Icon"),u=R,w=D,d=J;return l(),c("div",le,[t("div",de,[t("h3",me,[r(n,{name:"heroicons:arrow-up-tray",class:"text-teal-600",size:"24"}),a[9]||(a[9]=b(" Importar Dados ",-1))]),t("div",ce,[t("div",null,[a[11]||(a[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tipo de Dados",-1)),r(u,{modelValue:e.form.tipoEntidade,"onUpdate:modelValue":a[0]||(a[0]=g=>e.form.tipoEntidade=g)},{default:h(()=>[a[10]||(a[10]=t("option",{value:""},"Selecione o tipo",-1)),(l(),c(z,null,U(x,g=>t("option",{key:g.value,value:g.value},f(g.label),9,ue)),64))]),_:1},8,["modelValue"])]),e.form.tipoEntidade?(l(),c("div",pe,[a[13]||(a[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Template (Opcional)",-1)),r(u,{modelValue:e.form.templateId,"onUpdate:modelValue":a[1]||(a[1]=g=>e.form.templateId=g)},{default:h(()=>[a[12]||(a[12]=t("option",{value:""},"Sem template",-1)),(l(!0),c(z,null,U(e.templatesDisponiveis,g=>(l(),c("option",{key:g.id,value:g.id},f(g.nome),9,xe))),128))]),_:1},8,["modelValue"])])):v("",!0),e.form.tipoEntidade?(l(),c("div",fe,[t("input",{type:"file",ref_key:"fileInput",ref:o,onChange:s,accept:".csv,.xlsx,.xls,.json",class:"hidden"},null,544),r(n,{name:"heroicons:document-arrow-up",class:"text-gray-400 mx-auto mb-4",size:"48"}),t("p",ge,f(e.form.arquivo?e.form.arquivo.name:"Arraste um arquivo ou clique para selecionar"),1),a[15]||(a[15]=t("p",{class:"text-xs text-gray-500 mb-4"},"CSV, XLSX ou JSON (mÃ¡x. 10MB)",-1)),r(w,{onClick:a[2]||(a[2]=g=>m.$refs.fileInput.click()),theme:"admin",variant:"secondary"},{default:h(()=>[...a[14]||(a[14]=[b("Selecionar Arquivo",-1)])]),_:1})])):v("",!0),e.form.arquivo?(l(),c("div",ve,[t("label",be,[E(t("input",{type:"checkbox","onUpdate:modelValue":a[3]||(a[3]=g=>e.form.validarAntes=g),class:"rounded text-teal-600"},null,512),[[V,e.form.validarAntes]]),a[16]||(a[16]=t("span",{class:"text-sm text-gray-700"},"Validar dados antes de importar",-1))]),t("label",ye,[E(t("input",{type:"checkbox","onUpdate:modelValue":a[4]||(a[4]=g=>e.form.fazerBackup=g),class:"rounded text-teal-600"},null,512),[[V,e.form.fazerBackup]]),a[17]||(a[17]=t("span",{class:"text-sm text-gray-700"},"Fazer backup antes da importaÃ§Ã£o",-1))]),t("label",$e,[E(t("input",{type:"checkbox","onUpdate:modelValue":a[5]||(a[5]=g=>e.form.atualizarExistentes=g),class:"rounded text-teal-600"},null,512),[[V,e.form.atualizarExistentes]]),a[18]||(a[18]=t("span",{class:"text-sm text-gray-700"},"Atualizar registros existentes",-1))])])):v("",!0),e.form.arquivo?(l(),M(w,{key:3,onClick:a[6]||(a[6]=g=>m.$emit("importar")),theme:"admin",variant:"primary","full-width":"",disabled:e.importando},{default:h(()=>[r(n,{name:"heroicons:arrow-up-tray",class:"mr-2",size:"18"}),b(" "+f(e.importando?"Importando...":"Iniciar ImportaÃ§Ã£o"),1)]),_:1},8,["disabled"])):v("",!0)])]),r(d,{titulo:"HistÃ³rico de ImportaÃ§Ãµes",items:e.historico,loading:e.loading,tipo:"importacao",onRefresh:a[7]||(a[7]=g=>m.$emit("refresh")),onVerErros:a[8]||(a[8]=g=>m.$emit("ver-erros",g))},null,8,["items","loading"])])}}}),ke=Object.assign(he,{__name:"SectionImportarDados"}),Ie={class:"space-y-6"},Ee={class:"card"},we={class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},Ce={class:"space-y-4"},_e=["value"],Ve={key:0},Se={class:"grid grid-cols-3 gap-3"},Te=["onClick"],ze={key:1,class:"bg-gray-50 p-4 rounded-lg space-y-3"},Ue={class:"grid md:grid-cols-2 gap-3"},De={key:0},qe={class:"flex items-center gap-2"},Be=S({__name:"SectionExportarDados",props:{form:{},historico:{},loading:{type:Boolean},exportando:{type:Boolean}},emits:["exportar","refresh","baixar"],setup(e){const y=[{value:"colaboradores",label:"Colaboradores"},{value:"usuarios",label:"UsuÃ¡rios"},{value:"ferias",label:"FÃ©rias"},{value:"documentos",label:"Documentos"},{value:"ponto",label:"Registros de Ponto"},{value:"folha",label:"Folha de Pagamento"},{value:"departamentos",label:"Departamentos"},{value:"cargos",label:"Cargos"},{value:"jornadas",label:"Jornadas de Trabalho"}],o=[{value:"csv",label:"CSV",icon:"heroicons:document-text"},{value:"xlsx",label:"Excel",icon:"heroicons:table-cells"},{value:"json",label:"JSON",icon:"heroicons:code-bracket"}];return(x,s)=>{const m=T("Icon"),a=R,n=L,u=D,w=J;return l(),c("div",Ie,[t("div",Ee,[t("h3",we,[r(m,{name:"heroicons:arrow-down-tray",class:"text-teal-600",size:"24"}),s[8]||(s[8]=b(" Exportar Dados ",-1))]),t("div",Ce,[t("div",null,[s[10]||(s[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tipo de Dados",-1)),r(a,{modelValue:e.form.tipoEntidade,"onUpdate:modelValue":s[0]||(s[0]=d=>e.form.tipoEntidade=d)},{default:h(()=>[s[9]||(s[9]=t("option",{value:""},"Selecione o tipo",-1)),(l(),c(z,null,U(y,d=>t("option",{key:d.value,value:d.value},f(d.label),9,_e)),64))]),_:1},8,["modelValue"])]),e.form.tipoEntidade?(l(),c("div",Ve,[s[11]||(s[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Formato",-1)),t("div",Se,[(l(),c(z,null,U(o,d=>t("button",{key:d.value,onClick:g=>e.form.formato=d.value,class:B(["p-4 border-2 rounded-lg text-center transition-all",e.form.formato===d.value?"border-teal-600 bg-teal-50":"border-gray-200 hover:border-gray-300"])},[r(m,{name:d.icon,class:B(["mx-auto mb-2",e.form.formato===d.value?"text-teal-600":"text-gray-400"]),size:"32"},null,8,["name","class"]),t("p",{class:B(["text-sm font-medium",e.form.formato===d.value?"text-teal-600":"text-gray-700"])},f(d.label),3)],10,Te)),64))])])):v("",!0),e.form.formato?(l(),c("div",ze,[s[17]||(s[17]=t("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Filtros (Opcional)",-1)),t("div",Ue,[t("div",null,[s[12]||(s[12]=t("label",{class:"block text-xs text-gray-600 mb-1"},"Data InÃ­cio",-1)),r(n,{modelValue:e.form.filtros.dataInicio,"onUpdate:modelValue":s[1]||(s[1]=d=>e.form.filtros.dataInicio=d),type:"date"},null,8,["modelValue"])]),t("div",null,[s[13]||(s[13]=t("label",{class:"block text-xs text-gray-600 mb-1"},"Data Fim",-1)),r(n,{modelValue:e.form.filtros.dataFim,"onUpdate:modelValue":s[2]||(s[2]=d=>e.form.filtros.dataFim=d),type:"date"},null,8,["modelValue"])])]),e.form.tipoEntidade==="colaboradores"?(l(),c("div",De,[s[15]||(s[15]=t("label",{class:"block text-xs text-gray-600 mb-1"},"Status",-1)),r(a,{modelValue:e.form.filtros.status,"onUpdate:modelValue":s[3]||(s[3]=d=>e.form.filtros.status=d)},{default:h(()=>[...s[14]||(s[14]=[t("option",{value:""},"Todos",-1),t("option",{value:"ativo"},"Ativos",-1),t("option",{value:"inativo"},"Inativos",-1),t("option",{value:"ferias"},"Em FÃ©rias",-1),t("option",{value:"afastado"},"Afastados",-1)])]),_:1},8,["modelValue"])])):v("",!0),t("label",qe,[E(t("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=d=>e.form.incluirInativos=d),class:"rounded text-teal-600"},null,512),[[V,e.form.incluirInativos]]),s[16]||(s[16]=t("span",{class:"text-sm text-gray-700"},"Incluir registros inativos",-1))])])):v("",!0),e.form.formato?(l(),M(u,{key:2,onClick:s[5]||(s[5]=d=>x.$emit("exportar")),theme:"admin",variant:"primary","full-width":"",disabled:e.exportando},{default:h(()=>[r(m,{name:"heroicons:arrow-down-tray",class:"mr-2",size:"18"}),b(" "+f(e.exportando?"Gerando...":"Gerar ExportaÃ§Ã£o"),1)]),_:1},8,["disabled"])):v("",!0)])]),r(w,{titulo:"HistÃ³rico de ExportaÃ§Ãµes",items:e.historico,loading:e.loading,tipo:"exportacao",onRefresh:s[6]||(s[6]=d=>x.$emit("refresh")),onBaixar:s[7]||(s[7]=d=>x.$emit("baixar",d))},null,8,["items","loading"])])}}}),Fe=Object.assign(Be,{__name:"SectionExportarDados"}),Me={class:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow"},Ae={class:"flex items-start justify-between mb-3"},Pe={class:"flex-1"},je={class:"font-semibold text-gray-800 mb-1"},Oe={class:"text-sm text-gray-600 mb-2"},Re={class:"flex items-center gap-3 text-xs text-gray-500"},Ne={class:"flex items-center gap-1"},He={class:"flex items-center gap-1"},Le={class:"flex items-center gap-1"},We={class:"flex gap-2"},Je=S({__name:"ItemTemplate",props:{template:{}},emits:["editar","baixar","excluir"],setup(e){const y=o=>({colaboradores:"Colaboradores",usuarios:"UsuÃ¡rios",ferias:"FÃ©rias",documentos:"Documentos",ponto:"Ponto",folha:"Folha"})[o]||o;return(o,x)=>{const s=T("Icon"),m=D;return l(),c("div",Me,[t("div",Ae,[t("div",Pe,[t("h4",je,f(e.template.nome),1),t("p",Oe,f(e.template.descricao),1),t("div",Re,[t("span",Ne,[r(s,{name:"heroicons:tag",size:"14"}),b(" "+f(y(e.template.tipo_entidade)),1)]),t("span",He,[r(s,{name:"heroicons:document",size:"14"}),b(" "+f(e.template.formato?.toUpperCase()),1)]),t("span",Le,[r(s,{name:"heroicons:list-bullet",size:"14"}),b(" "+f(e.template.campos_mapeamento?.length||0)+" campos ",1)])])]),t("span",{class:B(["px-2 py-1 text-xs font-medium rounded-full",e.template.ativo?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"])},f(e.template.ativo?"Ativo":"Inativo"),3)]),t("div",We,[r(m,{onClick:x[0]||(x[0]=a=>o.$emit("editar",e.template)),theme:"admin",variant:"secondary",size:"sm",class:"flex-1"},{default:h(()=>[r(s,{name:"heroicons:pencil",class:"mr-1",size:"14"}),x[3]||(x[3]=b("Editar ",-1))]),_:1}),r(m,{onClick:x[1]||(x[1]=a=>o.$emit("baixar",e.template)),theme:"admin",variant:"secondary",size:"sm",class:"flex-1"},{default:h(()=>[r(s,{name:"heroicons:arrow-down-tray",class:"mr-1",size:"14"}),x[4]||(x[4]=b("Baixar ",-1))]),_:1}),t("button",{onClick:x[2]||(x[2]=a=>o.$emit("excluir",e.template.id)),class:"px-3 py-1.5 text-red-600 hover:bg-red-50 rounded-lg transition-colors"},[r(s,{name:"heroicons:trash",size:"16"})])])])}}}),Ge=Object.assign(Je,{__name:"ItemTemplate"}),Qe={class:"card"},Xe={class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},Ke={class:"space-y-4"},Ye={class:"space-y-3 pt-4 border-t border-gray-200"},Ze={class:"flex items-center gap-2"},to={class:"flex items-center gap-2"},eo={class:"flex items-center gap-2"},oo={class:"flex items-center gap-2"},ao=S({__name:"FormConfigImportacao",props:{config:{},salvando:{type:Boolean}},emits:["salvar"],setup(e){return(y,o)=>{const x=T("Icon"),s=L,m=R,a=D;return l(),c("div",Qe,[t("h3",Xe,[r(x,{name:"heroicons:cog-6-tooth",class:"text-teal-600",size:"24"}),o[10]||(o[10]=b(" ConfiguraÃ§Ãµes Gerais ",-1))]),t("div",Ke,[t("div",null,[o[11]||(o[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tamanho MÃ¡ximo de Arquivo (MB)",-1)),r(s,{modelValue:e.config.tamanhoMaximoArquivo,"onUpdate:modelValue":o[0]||(o[0]=n=>e.config.tamanhoMaximoArquivo=n),modelModifiers:{number:!0},type:"number",min:"1",max:"100"},null,8,["modelValue"]),o[12]||(o[12]=t("p",{class:"text-xs text-gray-500 mt-1"},"Limite: 1MB a 100MB",-1))]),t("div",null,[o[13]||(o[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tempo de ExpiraÃ§Ã£o de ExportaÃ§Ãµes (horas)",-1)),r(s,{modelValue:e.config.tempoExpiracaoExportacao,"onUpdate:modelValue":o[1]||(o[1]=n=>e.config.tempoExpiracaoExportacao=n),modelModifiers:{number:!0},type:"number",min:"1",max:"168"},null,8,["modelValue"]),o[14]||(o[14]=t("p",{class:"text-xs text-gray-500 mt-1"},"Arquivos exportados serÃ£o excluÃ­dos apÃ³s este perÃ­odo",-1))]),t("div",null,[o[15]||(o[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Limite de Registros por ExportaÃ§Ã£o",-1)),r(s,{modelValue:e.config.limiteRegistrosExportacao,"onUpdate:modelValue":o[2]||(o[2]=n=>e.config.limiteRegistrosExportacao=n),modelModifiers:{number:!0},type:"number",min:"100",max:"100000"},null,8,["modelValue"])]),t("div",null,[o[17]||(o[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Encoding PadrÃ£o",-1)),r(m,{modelValue:e.config.encodingPadrao,"onUpdate:modelValue":o[3]||(o[3]=n=>e.config.encodingPadrao=n)},{default:h(()=>[...o[16]||(o[16]=[t("option",{value:"UTF-8"},"UTF-8",-1),t("option",{value:"ISO-8859-1"},"ISO-8859-1",-1),t("option",{value:"Windows-1252"},"Windows-1252",-1)])]),_:1},8,["modelValue"])]),t("div",null,[o[19]||(o[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Delimitador CSV",-1)),r(m,{modelValue:e.config.delimitadorCsv,"onUpdate:modelValue":o[4]||(o[4]=n=>e.config.delimitadorCsv=n)},{default:h(()=>[...o[18]||(o[18]=[t("option",{value:","},", (vÃ­rgula)",-1),t("option",{value:";"},"; (ponto e vÃ­rgula)",-1),t("option",{value:"\\t"},"Tab",-1)])]),_:1},8,["modelValue"])]),t("div",Ye,[t("label",Ze,[E(t("input",{type:"checkbox","onUpdate:modelValue":o[5]||(o[5]=n=>e.config.validacaoAutomatica=n),class:"rounded text-teal-600"},null,512),[[V,e.config.validacaoAutomatica]]),o[20]||(o[20]=t("span",{class:"text-sm text-gray-700"},"Validar dados automaticamente antes de importar",-1))]),t("label",to,[E(t("input",{type:"checkbox","onUpdate:modelValue":o[6]||(o[6]=n=>e.config.backupAntesImportacao=n),class:"rounded text-teal-600"},null,512),[[V,e.config.backupAntesImportacao]]),o[21]||(o[21]=t("span",{class:"text-sm text-gray-700"},"Fazer backup automÃ¡tico antes de importaÃ§Ãµes",-1))]),t("label",eo,[E(t("input",{type:"checkbox","onUpdate:modelValue":o[7]||(o[7]=n=>e.config.notificarConclusao=n),class:"rounded text-teal-600"},null,512),[[V,e.config.notificarConclusao]]),o[22]||(o[22]=t("span",{class:"text-sm text-gray-700"},"Notificar por e-mail ao concluir operaÃ§Ãµes",-1))]),t("label",oo,[E(t("input",{type:"checkbox","onUpdate:modelValue":o[8]||(o[8]=n=>e.config.permitirImportacaoParalela=n),class:"rounded text-teal-600"},null,512),[[V,e.config.permitirImportacaoParalela]]),o[23]||(o[23]=t("span",{class:"text-sm text-gray-700"},"Permitir mÃºltiplas importaÃ§Ãµes simultÃ¢neas",-1))])]),r(a,{onClick:o[9]||(o[9]=n=>y.$emit("salvar")),theme:"admin",variant:"primary","full-width":"",disabled:e.salvando},{default:h(()=>[b(f(e.salvando?"Salvando...":"Salvar ConfiguraÃ§Ãµes"),1)]),_:1},8,["disabled"])])])}}}),so=Object.assign(ao,{__name:"FormConfigImportacao"}),no={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},ro={class:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden"},io={class:"p-6 border-b border-gray-200"},lo={class:"flex items-center justify-between"},mo={class:"text-lg font-semibold text-gray-800 flex items-center gap-2"},co={class:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]"},uo={key:0,class:"text-center py-8 text-gray-500"},po={key:1,class:"space-y-3"},xo={class:"flex items-start gap-3"},fo={class:"flex-1"},go={class:"text-sm font-medium text-red-800 mb-1"},vo={class:"text-sm text-red-700"},bo={key:0,class:"mt-2 text-xs text-red-600"},yo={class:"font-medium"},$o={key:1,class:"mt-1 text-xs text-red-600"},ho={class:"font-mono"},ko={class:"p-6 border-t border-gray-200 flex justify-end"},Io=S({__name:"ModalDetalhesErros",props:{erros:{}},emits:["close"],setup(e){return(y,o)=>{const x=T("Icon"),s=D;return l(),c("div",no,[t("div",ro,[t("div",io,[t("div",lo,[t("h3",mo,[r(x,{name:"heroicons:exclamation-triangle",class:"text-red-600",size:"24"}),b(" Detalhes dos Erros ("+f(e.erros.length)+") ",1)]),t("button",{onClick:o[0]||(o[0]=m=>y.$emit("close")),class:"text-gray-400 hover:text-gray-600"},[r(x,{name:"heroicons:x-mark",size:"24"})])])]),t("div",co,[e.erros.length===0?(l(),c("div",uo," Nenhum erro encontrado ")):(l(),c("div",po,[(l(!0),c(z,null,U(e.erros,(m,a)=>(l(),c("div",{key:a,class:"border border-red-200 bg-red-50 rounded-lg p-4"},[t("div",xo,[r(x,{name:"heroicons:x-circle",class:"text-red-600 flex-shrink-0 mt-0.5",size:"20"}),t("div",fo,[t("p",go," Linha "+f(m.linha||a+1),1),t("p",vo,f(m.mensagem),1),m.campo?(l(),c("div",bo,[o[2]||(o[2]=b(" Campo: ",-1)),t("span",yo,f(m.campo),1)])):v("",!0),m.valor?(l(),c("div",$o,[o[3]||(o[3]=b(" Valor: ",-1)),t("span",ho,f(m.valor),1)])):v("",!0)])])]))),128))]))]),t("div",ko,[r(s,{onClick:o[1]||(o[1]=m=>y.$emit("close")),theme:"admin",variant:"secondary"},{default:h(()=>[...o[4]||(o[4]=[b(" Fechar ",-1)])]),_:1})])])])}}}),Eo=Object.assign(Io,{__name:"ModalDetalhesErros"}),wo={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Co={class:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-hidden"},_o={class:"p-6 border-b border-gray-200"},Vo={class:"flex items-center justify-between"},So={class:"text-lg font-semibold text-gray-800"},To={class:"grid md:grid-cols-2 gap-4"},zo={class:"flex items-center gap-2"},Uo={class:"p-6 border-t border-gray-200 flex gap-3"},Do=S({__name:"ModalTemplateImportacao",props:{template:{}},emits:["close","saved"],setup(e,{emit:y}){const o=e,x=y,s=k(!1),m=k({nome:o.template?.nome||"",descricao:o.template?.descricao||"",tipo_entidade:o.template?.tipo_entidade||"",formato:o.template?.formato||"csv",ativo:o.template?.ativo??!0}),a=async()=>{if(!m.value.nome||!m.value.tipo_entidade){alert("Preencha os campos obrigatÃ³rios");return}s.value=!0;try{o.template?.id?await $fetch(`/api/importacao/templates/${o.template.id}`,{method:"PUT",body:m.value}):await $fetch("/api/importacao/templates",{method:"POST",body:m.value}),alert("âœ… Template salvo com sucesso!"),x("saved")}catch(n){console.error("Erro ao salvar:",n),alert(`Erro: ${n.data?.message||n.message}`)}finally{s.value=!1}};return(n,u)=>{const w=T("Icon"),d=L,g=R,F=D;return l(),c("div",wo,[t("div",Co,[t("div",_o,[t("div",Vo,[t("h3",So,f(e.template?"Editar Template":"Novo Template"),1),t("button",{onClick:u[0]||(u[0]=i=>n.$emit("close")),class:"text-gray-400 hover:text-gray-600"},[r(w,{name:"heroicons:x-mark",size:"24"})])])]),t("form",{onSubmit:vt(a,["prevent"]),class:"p-6 overflow-y-auto max-h-[calc(90vh-200px)] space-y-4"},[t("div",null,[u[7]||(u[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nome *",-1)),r(d,{modelValue:p(m).nome,"onUpdate:modelValue":u[1]||(u[1]=i=>p(m).nome=i),required:""},null,8,["modelValue"])]),t("div",null,[u[8]||(u[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"DescriÃ§Ã£o",-1)),E(t("textarea",{"onUpdate:modelValue":u[2]||(u[2]=i=>p(m).descricao=i),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"},null,512),[[bt,p(m).descricao]])]),t("div",To,[t("div",null,[u[10]||(u[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tipo de Entidade *",-1)),r(g,{modelValue:p(m).tipo_entidade,"onUpdate:modelValue":u[3]||(u[3]=i=>p(m).tipo_entidade=i),required:""},{default:h(()=>[...u[9]||(u[9]=[t("option",{value:""},"Selecione",-1),t("option",{value:"colaboradores"},"Colaboradores",-1),t("option",{value:"usuarios"},"UsuÃ¡rios",-1),t("option",{value:"ferias"},"FÃ©rias",-1),t("option",{value:"documentos"},"Documentos",-1),t("option",{value:"ponto"},"Ponto",-1),t("option",{value:"folha"},"Folha",-1)])]),_:1},8,["modelValue"])]),t("div",null,[u[12]||(u[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Formato *",-1)),r(g,{modelValue:p(m).formato,"onUpdate:modelValue":u[4]||(u[4]=i=>p(m).formato=i),required:""},{default:h(()=>[...u[11]||(u[11]=[t("option",{value:"csv"},"CSV",-1),t("option",{value:"xlsx"},"Excel",-1),t("option",{value:"json"},"JSON",-1)])]),_:1},8,["modelValue"])])]),t("div",null,[t("label",zo,[E(t("input",{type:"checkbox","onUpdate:modelValue":u[5]||(u[5]=i=>p(m).ativo=i),class:"rounded text-teal-600"},null,512),[[V,p(m).ativo]]),u[13]||(u[13]=t("span",{class:"text-sm text-gray-700"},"Template ativo",-1))])])],32),t("div",Uo,[r(F,{onClick:u[6]||(u[6]=i=>n.$emit("close")),theme:"admin",variant:"secondary",class:"flex-1"},{default:h(()=>[...u[14]||(u[14]=[b(" Cancelar ",-1)])]),_:1}),r(F,{onClick:a,theme:"admin",variant:"primary",class:"flex-1",disabled:p(s)},{default:h(()=>[b(f(p(s)?"Salvando...":"Salvar"),1)]),_:1},8,["disabled"])])])])}}}),qo=Object.assign(Do,{__name:"ModalTemplateImportacao"}),Bo=()=>{const e=k([]),y=k([]),o=k([]),x=k({tamanhoMaximoArquivo:10,tempoExpiracaoExportacao:24,limiteRegistrosExportacao:5e4,encodingPadrao:"UTF-8",delimitadorCsv:",",validacaoAutomatica:!0,backupAntesImportacao:!0,notificarConclusao:!0,permitirImportacaoParalela:!1}),s=k(!1),m=k(!1),a=async()=>{try{const i=await $fetch("/api/importacao/templates");e.value=i.data||[],s.value=!1}catch(i){i.message?.includes("does not exist")&&(s.value=!0)}},n=async()=>{m.value=!0;try{const i=await $fetch("/api/importacao/historico");y.value=i.data||[]}catch(i){console.error(i)}finally{m.value=!1}},u=async()=>{m.value=!0;try{const i=await $fetch("/api/exportacao/historico");o.value=i.data||[]}catch(i){console.error(i)}finally{m.value=!1}};return{templates:e,historicoImportacoes:y,historicoExportacoes:o,config:x,erroMigration:s,loading:m,carregarTemplates:a,carregarHistoricoImportacoes:n,carregarHistoricoExportacoes:u,carregarConfig:async()=>{try{const i=await $fetch("/api/importacao/config");i.data&&(x.value={tamanhoMaximoArquivo:i.data.tamanho_maximo_arquivo/1048576,tempoExpiracaoExportacao:i.data.tempo_expiracao_exportacao,limiteRegistrosExportacao:i.data.limite_registros_exportacao,encodingPadrao:i.data.encoding_padrao,delimitadorCsv:i.data.delimitador_csv,validacaoAutomatica:i.data.validacao_automatica,backupAntesImportacao:i.data.backup_antes_importacao,notificarConclusao:i.data.notificar_conclusao,permitirImportacaoParalela:i.data.permitir_importacao_paralela}),s.value=!1}catch(i){i.message?.includes("does not exist")&&(s.value=!0)}},executarImportacao:async i=>{if(!i.arquivo||!i.tipoEntidade)throw new Error("Selecione o tipo e arquivo");const I=new FormData;I.append("arquivo",i.arquivo),I.append("tipoEntidade",i.tipoEntidade),I.append("templateId",i.templateId),I.append("validarAntes",String(i.validarAntes)),I.append("fazerBackup",String(i.fazerBackup)),I.append("atualizarExistentes",String(i.atualizarExistentes)),await $fetch("/api/importacao/executar",{method:"POST",body:I}),await n()},executarExportacao:async i=>{if(!i.tipoEntidade||!i.formato)throw new Error("Selecione tipo e formato");await $fetch("/api/exportacao/executar",{method:"POST",body:i}),await u()},excluirTemplate:async i=>{await $fetch(`/api/importacao/templates/${i}`,{method:"DELETE"}),await a()}}},Fo={class:"min-h-screen bg-gray-50"},Mo={class:"max-w-7xl mx-auto p-8"},Ao={class:"bg-white rounded-lg shadow-sm mb-6"},Po={class:"border-b border-gray-200"},jo={class:"flex -mb-px"},Oo=["onClick"],Ro={class:"space-y-6"},No={class:"card"},Ho={class:"flex items-center justify-between mb-4"},Lo={class:"text-lg font-semibold text-gray-800 flex items-center gap-2"},Wo={key:0,class:"text-center py-8"},Jo={key:1,class:"grid md:grid-cols-2 gap-4"},Go={class:"space-y-6"},oa=S({__name:"importacao-exportacao",setup(e){const{templates:y,historicoImportacoes:o,historicoExportacoes:x,config:s,erroMigration:m,loading:a,carregarTemplates:n,carregarHistoricoImportacoes:u,carregarHistoricoExportacoes:w,carregarConfig:d,executarImportacao:g,executarExportacao:F,excluirTemplate:i}=Bo(),I=k("importar"),N=k(!1),H=k(!1),G=k(!1),Q=[{id:"importar",label:"Importar",icon:"heroicons:arrow-up-tray"},{id:"exportar",label:"Exportar",icon:"heroicons:arrow-down-tray"},{id:"templates",label:"Templates",icon:"heroicons:document-duplicate"},{id:"configuracoes",label:"ConfiguraÃ§Ãµes",icon:"heroicons:cog-6-tooth"}],A=k({tipoEntidade:"",templateId:"",arquivo:null,validarAntes:!0,fazerBackup:!0,atualizarExistentes:!1}),W=k({tipoEntidade:"",formato:"",incluirInativos:!1,filtros:{dataInicio:"",dataFim:"",status:""}}),P=k({aberto:!1,erros:[]}),q=k({aberto:!1,template:null}),X=yt(()=>y.value.filter($=>$.tipo_entidade===A.value.tipoEntidade&&$.ativo)),K=async()=>{N.value=!0;try{await g(A.value),alert("âœ… ImportaÃ§Ã£o iniciada com sucesso!"),A.value.arquivo=null}catch($){alert(`Erro: ${$.message}`)}finally{N.value=!1}},Y=async()=>{H.value=!0;try{await F(W.value),alert("âœ… ExportaÃ§Ã£o gerada com sucesso!")}catch($){alert(`Erro: ${$.message}`)}finally{H.value=!1}},Z=async $=>{if(confirm("Deseja realmente excluir este template?"))try{await i($),alert("âœ… Template excluÃ­do!")}catch(C){alert(`Erro: ${C.message}`)}},tt=$=>{P.value={aberto:!0,erros:$.erros_detalhes||[]}},et=()=>{q.value={aberto:!0,template:null}},ot=$=>{q.value={aberto:!0,template:$}},at=async $=>{alert("Template baixado!")},st=$=>{$.arquivo_url&&window.open($.arquivo_url,"_blank")},nt=()=>{q.value.aberto=!1,n()},rt=()=>{alert("âš ï¸ Funcionalidade temporariamente desabilitada. As configuraÃ§Ãµes padrÃ£o jÃ¡ estÃ£o ativas.")};return $t(I,$=>{$==="exportar"&&x.value.length===0&&w()}),ht(()=>{u(),n(),d()}),($,C)=>{const it=gt,lt=Ut,j=T("Icon"),dt=ke,mt=Fe,ct=D,ut=Ge,pt=so,xt=Eo,ft=qo;return l(),c("div",Fo,[r(it,{title:"ImportaÃ§Ã£o/ExportaÃ§Ã£o",subtitle:"Importe e exporte dados em lote",backTo:"/configuracoes",theme:"admin"}),t("div",Mo,[r(lt,{show:p(m),titulo:"Migration 22 NÃ£o Executada",mensagem:"O sistema de ImportaÃ§Ã£o/ExportaÃ§Ã£o requer que vocÃª execute a Migration 22 no banco de dados primeiro.",arquivoMigration:"database/migrations/22_importacao_exportacao.sql"},null,8,["show"]),t("div",Ao,[t("div",Po,[t("nav",jo,[(l(),c(z,null,U(Q,_=>t("button",{key:_.id,onClick:Qo=>I.value=_.id,class:B(["px-6 py-3 text-sm font-medium border-b-2 transition-colors",p(I)===_.id?"border-teal-600 text-teal-600":"border-transparent text-gray-500 hover:text-gray-700"])},[r(j,{name:_.icon,class:"inline mr-2",size:"18"},null,8,["name"]),b(f(_.label),1)],10,Oo)),64))])])]),E(r(dt,{form:p(A),templatesDisponiveis:p(X),historico:p(o),loading:p(a),importando:p(N),onImportar:K,onRefresh:p(u),onVerErros:tt},null,8,["form","templatesDisponiveis","historico","loading","importando","onRefresh"]),[[O,p(I)==="importar"]]),E(r(mt,{form:p(W),historico:p(x),loading:p(a),exportando:p(H),onExportar:Y,onRefresh:p(w),onBaixar:st},null,8,["form","historico","loading","exportando","onRefresh"]),[[O,p(I)==="exportar"]]),E(t("div",Ro,[t("div",No,[t("div",Ho,[t("h3",Lo,[r(j,{name:"heroicons:document-duplicate",class:"text-teal-600",size:"24"}),C[2]||(C[2]=b(" Templates de ImportaÃ§Ã£o ",-1))]),r(ct,{onClick:et,theme:"admin",variant:"primary",size:"sm"},{default:h(()=>[r(j,{name:"heroicons:plus",class:"mr-1",size:"16"}),C[3]||(C[3]=b("Novo Template ",-1))]),_:1})]),p(y).length===0?(l(),c("div",Wo,[r(j,{name:"heroicons:document",class:"text-gray-300 mx-auto mb-2",size:"48"}),C[4]||(C[4]=t("p",{class:"text-gray-500"},"Nenhum template cadastrado",-1))])):(l(),c("div",Jo,[(l(!0),c(z,null,U(p(y),_=>(l(),M(ut,{key:_.id,template:_,onEditar:ot,onBaixar:at,onExcluir:Z},null,8,["template"]))),128))]))])],512),[[O,p(I)==="templates"]]),E(t("div",Go,[r(pt,{config:p(s),salvando:p(G),onSalvar:rt},null,8,["config","salvando"])],512),[[O,p(I)==="configuracoes"]])]),p(P).aberto?(l(),M(xt,{key:0,erros:p(P).erros,onClose:C[0]||(C[0]=_=>p(P).aberto=!1)},null,8,["erros"])):v("",!0),p(q).aberto?(l(),M(ft,{key:1,template:p(q).template,onClose:C[1]||(C[1]=_=>p(q).aberto=!1),onSaved:nt},null,8,["template"])):v("",!0)])}}});export{oa as default};
