import{d as P,f as u,b as e,t as v,y as ge,e as s,a as _,o as d,F as A,k as F,p as w,r as b,i as pe,g as r,j as oe,s as xe,x as fe,c as te,l as O,G as be,_ as _e,n as D}from"./Cx4dxf1F.js";import{_ as ye}from"./CYmwnrxE.js";import{_ as se}from"./LFDSo-VX.js";import{_ as H}from"./CL2Zebya.js";import{_ as J}from"./Cu_3WJXs.js";import{u as he}from"./CpKZjYUa.js";import{u as E}from"./CKYXWbbW.js";const Ce={class:"fixed inset-0 z-50 flex items-center justify-center"},we={class:"relative bg-white rounded-xl shadow-xl w-full max-w-md mx-4 p-6"},$e={class:"text-xl font-bold text-gray-800 mb-6"},ke={class:"mb-4"},Ge={class:"mb-4"},Ne={class:"mb-4"},Ve=["value"],je={class:"mb-6"},ze=["value"],Ie={class:"flex gap-3"},Ue=P({__name:"CargoFormModal",props:{isEditing:{type:Boolean},form:{},saving:{type:Boolean},departamentos:{}},emits:["close","submit","update:form"],setup(c,{emit:G}){const I=c,p=G,C=(y,o)=>{p("update:form",{...I.form,[y]:o})};return(y,o)=>{const a=se,$=H,N=J;return d(),u("div",Ce,[e("div",{class:"absolute inset-0 bg-black/50",onClick:o[0]||(o[0]=m=>y.$emit("close"))}),e("div",we,[e("h3",$e,v(c.isEditing?"Editar Cargo":"Novo Cargo"),1),e("form",{onSubmit:o[6]||(o[6]=ge(m=>y.$emit("submit"),["prevent"]))},[e("div",ke,[o[7]||(o[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nome do Cargo *",-1)),s(a,{"model-value":c.form.nome,"onUpdate:modelValue":o[1]||(o[1]=m=>C("nome",m)),type:"text",placeholder:"Ex: Gerente de Vendas",required:""},null,8,["model-value"])]),e("div",Ge,[o[9]||(o[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"N√≠vel *",-1)),s($,{"model-value":c.form.nivel,"onUpdate:modelValue":o[2]||(o[2]=m=>C("nivel",m)),required:""},{default:_(()=>[...o[8]||(o[8]=[e("option",{value:""},"Selecione o n√≠vel",-1),e("option",{value:"operacional"},"Operacional",-1),e("option",{value:"gestao"},"Gest√£o",-1)])]),_:1},8,["model-value"])]),e("div",Ne,[o[11]||(o[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Departamento",-1)),s($,{"model-value":c.form.departamento_id,"onUpdate:modelValue":o[3]||(o[3]=m=>C("departamento_id",m))},{default:_(()=>[o[10]||(o[10]=e("option",{value:""},"Nenhum departamento",-1)),(d(!0),u(A,null,F(c.departamentos,m=>(d(),u("option",{key:m.id,value:m.id},v(m.nome),9,Ve))),128))]),_:1},8,["model-value"]),o[12]||(o[12]=e("p",{class:"text-xs text-gray-500 mt-1"},"Opcional: vincule este cargo a um departamento espec√≠fico",-1))]),e("div",je,[o[13]||(o[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Descri√ß√£o",-1)),e("textarea",{value:c.form.descricao,onInput:o[4]||(o[4]=m=>C("descricao",m.target.value)),class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors",rows:"3",placeholder:"Descri√ß√£o das responsabilidades do cargo..."},null,40,ze)]),e("div",Ie,[s(N,{type:"button",theme:"admin",variant:"secondary","full-width":"",onClick:o[5]||(o[5]=m=>y.$emit("close"))},{default:_(()=>[...o[14]||(o[14]=[w("Cancelar",-1)])]),_:1}),s(N,{type:"submit",theme:"admin",variant:"primary","full-width":"",disabled:c.saving},{default:_(()=>[w(v(c.saving?"Salvando...":c.isEditing?"Salvar":"Criar Cargo"),1)]),_:1},8,["disabled"])])],32)])])}}}),Se=Object.assign(Ue,{__name:"CargoFormModal"}),Me={class:"fixed inset-0 z-50 flex items-center justify-center"},Be={class:"relative bg-white rounded-xl shadow-xl w-full max-w-2xl mx-4 p-6 max-h-[80vh] overflow-y-auto"},Oe={class:"text-sm text-gray-600 mb-6"},De={class:"mb-6"},Ee={key:0,class:"space-y-2"},Ae={class:"flex items-center gap-3"},Fe={class:"w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center text-white text-sm font-semibold"},Re={class:"font-medium text-gray-800"},Te={class:"text-xs text-gray-500"},qe=["onClick"],Le={key:1,class:"text-center py-6 text-gray-500"},Pe={class:"mb-6"},He={class:"flex gap-3"},Je={value:""},Ke=["value"],Qe={class:"flex justify-end"},We=P({__name:"CargoGestoresModal",props:{cargo:{},colaboradores:{},loadingColaboradores:{type:Boolean},saving:{type:Boolean}},emits:["close","add","remove"],setup(c,{emit:G}){const I=G,p=b(""),C=o=>{if(!o)return"?";const a=o.split(" ");return a.length===1?a[0].substring(0,2).toUpperCase():(a[0][0]+a[a.length-1][0]).toUpperCase()},y=()=>{p.value&&(I("add",p.value),p.value="")};return(o,a)=>{const $=oe("Icon"),N=H,m=J;return d(),u("div",Me,[e("div",{class:"absolute inset-0 bg-black/50",onClick:a[0]||(a[0]=g=>o.$emit("close"))}),e("div",Be,[a[8]||(a[8]=e("h3",{class:"text-xl font-bold text-gray-800 mb-2"},"Gerenciar Gestores",-1)),e("p",Oe,[a[3]||(a[3]=w("Cargo: ",-1)),e("strong",null,v(c.cargo?.nome),1)]),e("div",De,[a[5]||(a[5]=e("h4",{class:"font-semibold text-gray-800 mb-3"},"Gestores Vinculados",-1)),c.cargo?.gestores&&c.cargo.gestores.length>0?(d(),u("div",Ee,[(d(!0),u(A,null,F(c.cargo.gestores,g=>(d(),u("div",{key:g.id,class:"flex items-center justify-between p-3 bg-purple-50 border border-purple-200 rounded-lg"},[e("div",Ae,[e("div",Fe,v(C(g.colaborador?.nome||"")),1),e("div",null,[e("p",Re,v(g.colaborador?.nome),1),e("p",Te,v(g.colaborador?.email_corporativo||"-"),1)])]),e("button",{class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remover",onClick:S=>o.$emit("remove",g.id)},[s($,{name:"heroicons:x-mark",size:"18"})],8,qe)]))),128))])):(d(),u("div",Le,[s($,{name:"heroicons:user-group",class:"mx-auto mb-2 text-gray-300",size:"48"}),a[4]||(a[4]=e("p",null,"Nenhum gestor vinculado",-1))]))]),e("div",Pe,[a[6]||(a[6]=e("h4",{class:"font-semibold text-gray-800 mb-3"},"Adicionar Gestor",-1)),e("div",He,[s(N,{modelValue:r(p),"onUpdate:modelValue":a[1]||(a[1]=g=>pe(p)?p.value=g:null),class:"flex-1",disabled:c.loadingColaboradores},{default:_(()=>[e("option",Je,v(c.loadingColaboradores?"Carregando...":"Selecione um funcion√°rio"),1),(d(!0),u(A,null,F(c.colaboradores,g=>(d(),u("option",{key:g.id,value:g.id},v(g.nome),9,Ke))),128))]),_:1},8,["modelValue","disabled"]),s(m,{theme:"admin",variant:"primary","icon-left":"heroicons:plus",disabled:!r(p)||c.saving,onClick:y},{default:_(()=>[w(v(c.saving?"Adicionando...":"Adicionar"),1)]),_:1},8,["disabled"])])]),e("div",Qe,[s(m,{theme:"admin",variant:"secondary",onClick:a[2]||(a[2]=g=>o.$emit("close"))},{default:_(()=>[...a[7]||(a[7]=[w("Fechar",-1)])]),_:1})])])])}}}),Xe=Object.assign(We,{__name:"CargoGestoresModal"}),Ye={class:"min-h-screen bg-gray-50"},Ze={class:"bg-white border-b border-gray-200 sticky top-0 z-40"},et={class:"max-w-7xl mx-auto px-8 py-4"},tt={class:"flex items-center justify-between"},ot={class:"flex items-center gap-4"},st={class:"max-w-7xl mx-auto p-8"},at={class:"grid md:grid-cols-4 gap-6 mb-8"},lt={class:"card bg-red-50 border-2 border-red-200"},nt={class:"flex items-center gap-4"},it={class:"w-12 h-12 bg-red-700 rounded-lg flex items-center justify-center"},rt={class:"text-2xl font-bold text-gray-800"},dt={class:"card"},ct={class:"flex items-center gap-4"},ut={class:"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center"},mt={class:"text-2xl font-bold text-gray-800"},vt={class:"card"},gt={class:"flex items-center gap-4"},pt={class:"w-12 h-12 bg-purple-600 rounded-lg flex items-center justify-center"},xt={class:"text-2xl font-bold text-gray-800"},ft={class:"card"},bt={class:"flex items-center gap-4"},_t={class:"w-12 h-12 bg-green-600 rounded-lg flex items-center justify-center"},yt={class:"text-2xl font-bold text-gray-800"},ht={class:"card mb-8"},Ct={class:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between"},wt={class:"flex flex-col md:flex-row gap-4 flex-1"},$t={class:"flex-1"},kt={key:0,class:"card text-center py-12"},Gt={key:1,class:"card overflow-hidden"},Nt={class:"overflow-x-auto"},Vt={class:"w-full"},jt={class:"divide-y divide-gray-200"},zt={class:"px-6 py-4"},It={class:"flex items-center gap-3"},Ut={class:"flex items-center gap-2"},St={class:"font-medium text-gray-800"},Mt={key:0,class:"text-xl",title:"Cargo de Gest√£o"},Bt={key:1,class:"text-lg",title:"Cargo Operacional"},Ot={key:2,class:"text-xs text-gray-500 ml-2"},Dt={class:"px-6 py-4"},Et={class:"px-6 py-4 text-sm text-gray-600"},At={class:"px-6 py-4"},Ft={class:"px-6 py-4"},Rt={class:"flex items-center justify-end gap-2"},Tt=["onClick"],qt=["onClick"],Lt=["title","onClick"],Pt={key:2,class:"card text-center py-12"},Ht={class:"card mt-8 bg-blue-50 border-2 border-blue-200"},Jt={class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},to=P({__name:"cargos",setup(c){const{cargos:G,loading:I,countByNivel:p,countByStatus:C,fetchCargos:y,filterCargos:o,createCargo:a,updateCargo:$,toggleCargoStatus:N,addGestor:m,removeGestor:g,fetchColaboradoresDisponiveis:S,fetchDepartamentos:ae}=he(),k=b({search:"",nivel:"all",status:"all"}),M=b(!1),V=b(!1),B=b(null),R=b(!1),x=b({nome:"",nivel:"",descricao:"",departamento_id:""}),K=b([]),T=b(!1),f=b(null),j=b([]),q=b(!1),L=b(!1),Q=xe(()=>o(k.value));fe(async()=>{await y();const n=await ae();n.success&&(K.value=n.data||[])});const W=()=>{V.value=!1,B.value=null,x.value={nome:"",nivel:"",descricao:"",departamento_id:""},M.value=!0},le=n=>{V.value=!0,B.value=n.id,x.value={nome:n.nome,nivel:n.nivel,descricao:n.descricao||"",departamento_id:n.departamento_id||""},M.value=!0},X=()=>{M.value=!1,x.value={nome:"",nivel:"",descricao:"",departamento_id:""}},ne=async()=>{const n=E();if(!x.value.nome||!x.value.nivel){n.warning("Campos obrigat√≥rios","Preencha todos os campos obrigat√≥rios");return}R.value=!0;try{const t={nome:x.value.nome,nivel:x.value.nivel,descricao:x.value.descricao||void 0,departamento_id:x.value.departamento_id||void 0},i=V.value&&B.value?await $(B.value,t):await a(t);i.success?(n.success(V.value?"Cargo atualizado!":"Cargo criado!",V.value?`O cargo "${x.value.nome}" foi atualizado com sucesso.`:`O cargo "${x.value.nome}" foi criado com sucesso.`),X()):n.error("Erro ao salvar cargo",i.error||"Ocorreu um erro ao processar a solicita√ß√£o.")}finally{R.value=!1}},ie=async n=>{const t=E(),i=n.ativo?"desativar":"ativar";if(confirm(`Deseja ${i} o cargo "${n.nome}"?`)){const h=await N(n.id,!n.ativo);h.success?t.success(`Cargo ${i}do!`,`O cargo "${n.nome}" foi ${i}do com sucesso.`):t.error(`Erro ao ${i} cargo`,h.error||"N√£o foi poss√≠vel alterar o status do cargo.")}},re=async n=>{f.value=n,T.value=!0,q.value=!0;const t=await S(n.id);t.success&&(j.value=t.data||[]),q.value=!1},de=()=>{T.value=!1,f.value=null,j.value=[]},ce=async n=>{const t=E();if(!f.value)return;L.value=!0;const i=await m(f.value.id,n);if(i.success){const h=j.value.find(U=>U.id===n);t.success("Gestor adicionado!",`${h?.nome||"Colaborador"} foi adicionado como gestor do cargo "${f.value.nome}".`);const z=await S(f.value.id);z.success&&(j.value=z.data||[]),f.value=G.value.find(U=>U.id===f.value.id)}else t.error("Erro ao adicionar gestor",i.error||"N√£o foi poss√≠vel adicionar o gestor.");L.value=!1},ue=async n=>{const t=E();if(!confirm("Deseja remover este gestor?"))return;const i=await g(n);if(i.success){if(t.success("Gestor removido!","O gestor foi removido do cargo com sucesso."),f.value){const h=await S(f.value.id);h.success&&(j.value=h.data||[]),f.value=G.value.find(z=>z.id===f.value.id)}}else t.error("Erro ao remover gestor",i.error||"N√£o foi poss√≠vel remover o gestor.")};return(n,t)=>{const i=oe("Icon"),h=_e,z=ye,U=se,Y=H,Z=J,me=Se,ve=Xe;return d(),u("div",Ye,[e("header",Ze,[e("div",et,[e("div",tt,[e("div",ot,[s(h,{to:"/admin",class:"w-10 h-10 bg-red-700 rounded-lg flex items-center justify-center hover:bg-red-800 transition-colors"},{default:_(()=>[s(i,{name:"heroicons:arrow-left",class:"text-white",size:"20"})]),_:1}),t[4]||(t[4]=e("div",null,[e("h1",{class:"text-xl font-bold text-gray-800"},"Gest√£o de Cargos"),e("p",{class:"text-sm text-gray-500"},"Gerenciar cargos e n√≠veis do sistema")],-1))]),s(z,{theme:"admin"})])])]),e("div",st,[e("div",at,[e("div",lt,[e("div",nt,[e("div",it,[s(i,{name:"heroicons:briefcase",class:"text-white",size:"24"})]),e("div",null,[t[5]||(t[5]=e("p",{class:"text-sm text-gray-600"},"Total",-1)),e("p",rt,v(r(p).total),1)])])]),e("div",dt,[e("div",ct,[e("div",ut,[s(i,{name:"heroicons:wrench-screwdriver",class:"text-white",size:"24"})]),e("div",null,[t[6]||(t[6]=e("p",{class:"text-sm text-gray-600"},"Operacional",-1)),e("p",mt,v(r(p).operacional),1)])])]),e("div",vt,[e("div",gt,[e("div",pt,[s(i,{name:"heroicons:shield-check",class:"text-white",size:"24"})]),e("div",null,[t[7]||(t[7]=e("p",{class:"text-sm text-gray-600"},"Gest√£o",-1)),e("p",xt,v(r(p).gestao),1)])])]),e("div",ft,[e("div",bt,[e("div",_t,[s(i,{name:"heroicons:check-circle",class:"text-white",size:"24"})]),e("div",null,[t[8]||(t[8]=e("p",{class:"text-sm text-gray-600"},"Ativos",-1)),e("p",yt,v(r(C).ativo),1)])])])]),e("div",ht,[e("div",Ct,[e("div",wt,[e("div",$t,[s(U,{modelValue:r(k).search,"onUpdate:modelValue":t[0]||(t[0]=l=>r(k).search=l),type:"text",placeholder:"Buscar por nome...","icon-left":"heroicons:magnifying-glass"},null,8,["modelValue"])]),s(Y,{modelValue:r(k).nivel,"onUpdate:modelValue":t[1]||(t[1]=l=>r(k).nivel=l),class:"w-full md:w-48"},{default:_(()=>[...t[9]||(t[9]=[e("option",{value:"all"},"Todos os n√≠veis",-1),e("option",{value:"operacional"},"Operacional",-1),e("option",{value:"gestao"},"Gest√£o",-1)])]),_:1},8,["modelValue"]),s(Y,{modelValue:r(k).status,"onUpdate:modelValue":t[2]||(t[2]=l=>r(k).status=l),class:"w-full md:w-48"},{default:_(()=>[...t[10]||(t[10]=[e("option",{value:"all"},"Todos os status",-1),e("option",{value:"ativo"},"Ativos",-1),e("option",{value:"inativo"},"Inativos",-1)])]),_:1},8,["modelValue"])]),s(Z,{theme:"admin",variant:"primary","icon-left":"heroicons:plus",onClick:W},{default:_(()=>[...t[11]||(t[11]=[w("Novo Cargo",-1)])]),_:1})])]),r(I)?(d(),u("div",kt,[s(i,{name:"heroicons:arrow-path",class:"animate-spin text-gray-400 mx-auto mb-4",size:"48"}),t[12]||(t[12]=e("p",{class:"text-gray-600"},"Carregando cargos...",-1))])):r(Q).length>0?(d(),u("div",Gt,[e("div",Nt,[e("table",Vt,[t[13]||(t[13]=e("thead",{class:"bg-gray-50 border-b border-gray-200"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase"},"Cargo"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase"},"N√≠vel"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase"},"Descri√ß√£o"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase"},"Status"),e("th",{class:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase"},"A√ß√µes")])],-1)),e("tbody",jt,[(d(!0),u(A,null,F(r(Q),l=>(d(),u("tr",{key:l.id,class:"hover:bg-gray-50"},[e("td",zt,[e("div",It,[e("div",{class:D(["w-10 h-10 rounded-full flex items-center justify-center text-white",l.nivel==="gestao"?"bg-purple-600":"bg-blue-600"])},[s(i,{name:l.nivel==="gestao"?"heroicons:shield-check":"heroicons:wrench-screwdriver",size:"20"},null,8,["name"])],2),e("div",Ut,[e("p",St,v(l.nome),1),l.nivel==="gestao"?(d(),u("span",Mt," üëë ")):(d(),u("span",Bt," üë∑ ")),l.nivel==="gestao"&&l.gestores?.length?(d(),u("p",Ot,v(l.gestores.length)+" gestor(es)",1)):O("",!0)])])]),e("td",Dt,[e("span",{class:D(["badge",l.nivel==="gestao"?"badge-error":"badge-info"])},v(l.nivel==="gestao"?"Gest√£o":"Operacional"),3)]),e("td",Et,v(l.descricao||"-"),1),e("td",At,[e("span",{class:D(["badge",l.ativo?"badge-success":"badge-warning"])},v(l.ativo?"Ativo":"Inativo"),3)]),e("td",Ft,[e("div",Rt,[l.nivel==="gestao"?(d(),u("button",{key:0,class:"p-2 text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded-lg",title:"Gestores",onClick:ee=>re(l)},[s(i,{name:"heroicons:user-group",size:"18"})],8,Tt)):O("",!0),e("button",{class:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"Editar",onClick:ee=>le(l)},[s(i,{name:"heroicons:pencil",size:"18"})],8,qt),e("button",{class:D(["p-2 rounded-lg",l.ativo?"text-gray-500 hover:text-orange-600 hover:bg-orange-50":"text-gray-500 hover:text-green-600 hover:bg-green-50"]),title:l.ativo?"Desativar":"Ativar",onClick:ee=>ie(l)},[s(i,{name:l.ativo?"heroicons:pause":"heroicons:play",size:"18"},null,8,["name"])],10,Lt)])])]))),128))])])])])):(d(),u("div",Pt,[s(i,{name:"heroicons:briefcase",class:"text-gray-300 mx-auto mb-4",size:"64"}),t[15]||(t[15]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"Nenhum cargo encontrado",-1)),t[16]||(t[16]=e("p",{class:"text-gray-600 mb-6"},"Ajuste os filtros ou crie um novo cargo",-1)),s(Z,{theme:"admin",variant:"primary","icon-left":"heroicons:plus",onClick:W},{default:_(()=>[...t[14]||(t[14]=[w("Novo Cargo",-1)])]),_:1})])),e("div",Ht,[e("h3",Jt,[s(i,{name:"heroicons:information-circle",class:"text-blue-600",size:"24"}),t[17]||(t[17]=w(" Sobre os N√≠veis de Cargo ",-1))]),t[18]||(t[18]=be('<div class="grid md:grid-cols-2 gap-6"><div><h4 class="font-semibold text-blue-800 mb-2">N√≠vel Operacional</h4><p class="text-sm text-gray-600">Cargos operacionais t√™m acesso b√°sico ao sistema.</p></div><div><h4 class="font-semibold text-purple-800 mb-2">N√≠vel Gest√£o</h4><p class="text-sm text-gray-600">Cargos de gest√£o t√™m poderes administrativos, exceto editar/excluir funcion√°rios.</p></div></div>',1))])]),r(M)?(d(),te(me,{key:0,"is-editing":r(V),form:r(x),saving:r(R),departamentos:r(K),onClose:X,onSubmit:ne,"onUpdate:form":t[3]||(t[3]=l=>x.value=l)},null,8,["is-editing","form","saving","departamentos"])):O("",!0),r(T)?(d(),te(ve,{key:1,cargo:r(f),colaboradores:r(j),"loading-colaboradores":r(q),saving:r(L),onClose:de,onAdd:ce,onRemove:ue},null,8,["cargo","colaboradores","loading-colaboradores","saving"])):O("",!0)])}}});export{to as default};
