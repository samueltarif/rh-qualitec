import{d as S,r as c,x as L,a as j,g as l,o as d,e as t,f as i,b as m,_ as q,p as h,h as s,F as A,k as F,n as E,t as r,l as U,y as R,i as x,z as w,v as V,A as O,j as G}from"./BSA_tgdP.js";import{_ as H}from"./BBzIiODl.js";import{_ as J}from"./yUH5lwCE.js";import{_ as K}from"./BLXo4lQY.js";import{_ as Q}from"./BaRlud3k.js";const W={class:"min-h-screen bg-gray-50"},X={class:"bg-white border-b border-gray-200 sticky top-0 z-40"},Y={class:"max-w-7xl mx-auto px-8 py-4"},Z={class:"flex items-center justify-between"},tt={class:"flex items-center gap-4"},et={class:"flex items-center gap-3"},ot={class:"max-w-7xl mx-auto p-8"},at={key:0,class:"text-center py-12"},st={key:1},nt={key:2,class:"space-y-4"},it={class:"flex items-start justify-between gap-4"},rt={class:"flex-1"},lt={class:"flex items-center gap-2 mb-2"},dt={class:"px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-600"},ut={class:"font-semibold text-gray-800"},pt={class:"text-sm text-gray-600 mt-1 line-clamp-2"},ct={class:"text-xs text-gray-400 mt-2"},mt={key:0},xt={class:"flex gap-2"},gt=["onClick"],vt=["onClick"],ft={class:"grid grid-cols-2 gap-4"},bt={key:0,class:"flex items-center gap-2"},yt={class:"flex gap-3"},Et=S({__name:"comunicados",setup(_t){const f=c([]),b=c(!1),u=c(!1),p=c(!1),v=c(null),n=c({titulo:"",conteudo:"",tipo:"Informativo",destino:"todos",destino_ids:[],data_expiracao:"",ativo:!0}),y=async()=>{b.value=!0;try{const a=await $fetch("/api/admin/comunicados");f.value=a}catch(a){console.error("Erro:",a)}finally{b.value=!1}},_=a=>{a?(p.value=!0,v.value=a.id,n.value={titulo:a.titulo,conteudo:a.conteudo,tipo:a.tipo,destino:a.destino,destino_ids:a.destino_ids||[],data_expiracao:a.data_expiracao?.split("T")[0]||"",ativo:a.ativo}):(p.value=!1,v.value=null,n.value={titulo:"",conteudo:"",tipo:"Informativo",destino:"todos",destino_ids:[],data_expiracao:"",ativo:!0}),u.value=!0},C=async()=>{try{p.value&&v.value?await $fetch(`/api/admin/comunicados/${v.value}`,{method:"PUT",body:n.value}):await $fetch("/api/admin/comunicados",{method:"POST",body:n.value}),u.value=!1,await y(),alert("Comunicado salvo com sucesso!")}catch(a){alert(a.message||"Erro ao salvar")}},$=async a=>{if(confirm(`Excluir comunicado "${a.titulo}"?`))try{await $fetch(`/api/admin/comunicados/${a.id}`,{method:"DELETE"}),await y()}catch(e){alert(e.message||"Erro ao excluir")}},D=a=>({Informativo:"bg-blue-100 text-blue-700",Importante:"bg-amber-100 text-amber-700",Urgente:"bg-red-100 text-red-700",Evento:"bg-purple-100 text-purple-700",Beneficio:"bg-green-100 text-green-700"})[a]||"bg-gray-100 text-gray-700",T=a=>({todos:"Todos",departamento:"Por Departamento",cargo:"Por Cargo",individual:"Individual"})[a]||a,k=a=>a?new Date(a).toLocaleDateString("pt-BR"):"-";return L(()=>y()),(a,e)=>{const g=j("Icon"),z=q,I=H,P=J,B=K,M=Q;return d(),l("div",W,[t("header",X,[t("div",Y,[t("div",Z,[t("div",tt,[i(z,{to:"/admin",class:"w-10 h-10 bg-red-700 rounded-lg flex items-center justify-center hover:bg-red-800 transition-colors"},{default:m(()=>[i(g,{name:"heroicons:arrow-left",class:"text-white",size:"20"})]),_:1}),e[10]||(e[10]=t("div",null,[t("h1",{class:"text-xl font-bold text-gray-800"},"Comunicados"),t("p",{class:"text-sm text-gray-500"},"Publique comunicados para os funcionários")],-1))]),t("div",et,[i(I,{theme:"admin",variant:"primary",onClick:e[0]||(e[0]=o=>_())},{default:m(()=>[i(g,{name:"heroicons:plus",size:"20",class:"mr-1"}),e[11]||(e[11]=h(" Novo Comunicado ",-1))]),_:1}),i(P,{theme:"admin"})])])])]),t("div",ot,[s(b)?(d(),l("div",at,[i(g,{name:"heroicons:arrow-path",class:"animate-spin text-gray-400",size:"40"})])):s(f).length===0?(d(),l("div",st,[i(B,{icon:"heroicons:megaphone",title:"Nenhum comunicado",description:"Crie o primeiro comunicado para seus funcionários.",color:"amber"},{action:m(()=>[i(I,{theme:"admin",variant:"primary",onClick:e[1]||(e[1]=o=>_())},{default:m(()=>[...e[12]||(e[12]=[h(" Criar Comunicado ",-1)])]),_:1})]),_:1})])):(d(),l("div",nt,[(d(!0),l(A,null,F(s(f),o=>(d(),l("div",{key:o.id,class:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-md transition-shadow"},[t("div",it,[t("div",rt,[t("div",lt,[t("span",{class:E([D(o.tipo),"px-2 py-1 text-xs font-medium rounded-full"])},r(o.tipo),3),t("span",{class:E([o.ativo?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700","px-2 py-1 text-xs font-medium rounded-full"])},r(o.ativo?"Ativo":"Inativo"),3),t("span",dt,r(T(o.destino)),1)]),t("h4",ut,r(o.titulo),1),t("p",pt,r(o.conteudo),1),t("p",ct,[h(" Publicado por "+r(o.publicado?.nome||"Admin")+" em "+r(k(o.data_publicacao))+" ",1),o.data_expiracao?(d(),l("span",mt," • Expira em "+r(k(o.data_expiracao)),1)):U("",!0)])]),t("div",xt,[t("button",{onClick:N=>_(o),class:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg"},[i(g,{name:"heroicons:pencil",size:"18"})],8,gt),t("button",{onClick:N=>$(o),class:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg"},[i(g,{name:"heroicons:trash",size:"18"})],8,vt)])])]))),128))]))]),i(M,{modelValue:s(u),"onUpdate:modelValue":e[9]||(e[9]=o=>G(u)?u.value=o:null),title:s(p)?"Editar Comunicado":"Novo Comunicado",size:"lg"},{footer:m(()=>[t("div",yt,[t("button",{onClick:e[8]||(e[8]=o=>u.value=!1),class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300"},"Cancelar"),t("button",{onClick:C,class:"px-4 py-2 bg-red-700 text-white font-medium rounded-lg hover:bg-red-800"},r(s(p)?"Salvar":"Publicar"),1)])]),default:m(()=>[t("form",{onSubmit:R(C,["prevent"]),class:"space-y-4"},[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Título *",-1)),x(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s(n).titulo=o),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"},null,512),[[w,s(n).titulo]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Conteúdo *",-1)),x(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=o=>s(n).conteudo=o),rows:"6",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 resize-none"},null,512),[[w,s(n).conteudo]])]),t("div",ft,[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tipo",-1)),x(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>s(n).tipo=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg"},[...e[15]||(e[15]=[t("option",{value:"Informativo"},"Informativo",-1),t("option",{value:"Importante"},"Importante",-1),t("option",{value:"Urgente"},"Urgente",-1),t("option",{value:"Evento"},"Evento",-1),t("option",{value:"Beneficio"},"Benefício",-1)])],512),[[V,s(n).tipo]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Destino",-1)),x(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>s(n).destino=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg"},[...e[17]||(e[17]=[t("option",{value:"todos"},"Todos os funcionários",-1),t("option",{value:"departamento"},"Por departamento",-1),t("option",{value:"cargo"},"Por cargo",-1)])],512),[[V,s(n).destino]])])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Data de Expiração (opcional)",-1)),x(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>s(n).data_expiracao=o),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-lg"},null,512),[[w,s(n).data_expiracao]])]),s(p)?(d(),l("div",bt,[x(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=o=>s(n).ativo=o),id:"ativo",class:"rounded text-red-600"},null,512),[[O,s(n).ativo]]),e[20]||(e[20]=t("label",{for:"ativo",class:"text-sm text-gray-700"},"Comunicado ativo",-1))])):U("",!0)],32)]),_:1},8,["modelValue","title"])])}}});export{Et as default};
