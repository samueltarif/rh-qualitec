import{d as G,r as c,s as $,w as J,x as K,f as l,b as e,e as r,a as h,g as s,i as C,F as Q,j as W,p as X,o as i,_ as Y,k as b,n as A,t as d,l as w,h as Z,z as ee}from"./DNqCZqpD.js";import{_ as te}from"./BDJByVvn.js";import{_ as oe}from"./Bb6QONmn.js";import{_ as ae}from"./D6mXrl8e.js";import{_ as se}from"./DuTwkaXX.js";import{_ as re}from"./DmG97tWo.js";import{_ as ne}from"./CF27ZHw8.js";import"./DdnJSzYT.js";const le={class:"min-h-screen bg-gray-50"},ie={class:"bg-white border-b border-gray-200 sticky top-0 z-40"},de={class:"max-w-7xl mx-auto px-8 py-4"},ce={class:"flex items-center justify-between"},ue={class:"flex items-center gap-4"},pe={class:"max-w-7xl mx-auto p-8"},me={class:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8"},_e={class:"bg-white rounded-xl border border-gray-200 p-4 mb-6"},ve={class:"flex flex-wrap items-center gap-4"},ge={key:0,class:"text-center py-12"},xe={key:1},be={key:2,class:"space-y-4"},fe={class:"flex items-start justify-between gap-4"},ye={class:"flex-1"},he={class:"flex items-center gap-2 mb-2"},we={key:0,class:"px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-700"},Ce={class:"font-semibold text-gray-800"},ke={class:"text-sm text-gray-600 mt-1"},je={class:"font-medium"},Ae={key:0,class:"text-gray-400"},Re={key:1,class:"text-gray-400"},Se={key:0,class:"text-sm text-gray-500 mt-2"},Ve={class:"text-xs text-gray-400 mt-2"},Ue={key:0,class:"flex gap-2"},Ee=["onClick"],$e=["onClick"],Pe={class:"space-y-4"},ze={key:0},De={class:"text-sm text-gray-600 mb-4"},Ie={class:"block text-sm font-medium text-gray-700 mb-1"},Le=["required","placeholder"],Te={class:"flex gap-3"},Fe=["disabled"],Qe=G({__name:"solicitacoes",setup(Me){const R=c([]),p=c({total:0,pendentes:0,em_analise:0,aprovadas:0,rejeitadas:0,concluidas:0}),k=c(!1),f=c(""),m=c("todos"),_=c(""),v=c(!1),g=c(null),n=c("aprovar"),x=c({texto:""}),P=$(()=>n.value==="aprovar"?"Aprovar Solicitação":"Rejeitar Solicitação"),S=$(()=>{let o=R.value;if(f.value){const t=f.value.toLowerCase();o=o.filter(u=>u.colaborador_nome?.toLowerCase().includes(t)||u.titulo?.toLowerCase().includes(t))}return o}),j=async()=>{k.value=!0;try{const o=new URLSearchParams;m.value!=="todos"&&o.append("status",m.value),_.value&&o.append("tipo",_.value);const t=await $fetch(`/api/admin/solicitacoes?${o}`);R.value=t}catch(o){console.error("Erro ao buscar solicitações:",o)}finally{k.value=!1}},V=async()=>{try{const o=await $fetch("/api/admin/solicitacoes/stats");p.value=o}catch(o){console.error("Erro ao buscar stats:",o)}},U=(o,t)=>{g.value=o,n.value=t,x.value.texto="",v.value=!0},z=async()=>{if(g.value)try{await $fetch(`/api/admin/solicitacoes/${g.value.id}`,{method:"PUT",body:{status:n.value==="aprovar"?"Aprovada":"Rejeitada",resposta:n.value==="aprovar"?x.value.texto:null,motivo_rejeicao:n.value==="rejeitar"?x.value.texto:null}}),v.value=!1,await j(),await V(),alert(`Solicitação ${n.value==="aprovar"?"aprovada":"rejeitada"} com sucesso!`)}catch(o){alert(o.message||"Erro ao processar solicitação")}},D=o=>({ferias:"Férias",abono:"Abono",atestado:"Atestado",declaracao:"Declaração",alteracao_dados:"Alteração de Dados",holerite:"Holerite",informe_rendimentos:"Informe de Rendimentos",carta_referencia:"Carta de Referência",outros:"Outros"})[o]||o,I=o=>({ferias:"bg-amber-100 text-amber-700",abono:"bg-blue-100 text-blue-700",atestado:"bg-purple-100 text-purple-700",declaracao:"bg-green-100 text-green-700"})[o]||"bg-gray-100 text-gray-700",L=o=>({Pendente:"Pendente",Em_Analise:"Em Análise",Aprovada:"Aprovada",Rejeitada:"Rejeitada",Cancelada:"Cancelada",Concluida:"Concluída"})[o]||o,T=o=>({Pendente:"bg-yellow-100 text-yellow-700",Em_Analise:"bg-blue-100 text-blue-700",Aprovada:"bg-green-100 text-green-700",Rejeitada:"bg-red-100 text-red-700",Cancelada:"bg-gray-100 text-gray-700",Concluida:"bg-green-100 text-green-700"})[o]||"bg-gray-100 text-gray-700",F=o=>o?new Date(o).toLocaleDateString("pt-BR"):"-";return J([m,_],()=>j()),K(()=>{j(),V()}),(o,t)=>{const u=Y,M=X,N=te,y=oe,B=ae,E=se,O=re,q=ne;return i(),l("div",le,[e("header",ie,[e("div",de,[e("div",ce,[e("div",ue,[r(M,{to:"/admin",class:"w-10 h-10 bg-red-700 rounded-lg flex items-center justify-center hover:bg-red-800 transition-colors"},{default:h(()=>[r(u,{name:"heroicons:arrow-left",class:"text-white",size:"20"})]),_:1}),t[6]||(t[6]=e("div",null,[e("h1",{class:"text-xl font-bold text-gray-800"},"Solicitações de Funcionários"),e("p",{class:"text-sm text-gray-500"},"Gerencie as solicitações dos colaboradores")],-1))]),r(N,{theme:"admin"})])])]),e("div",pe,[e("div",me,[r(y,{label:"Pendentes",value:s(p).pendentes,icon:"heroicons:clock",color:"amber"},null,8,["value"]),r(y,{label:"Em Análise",value:s(p).em_analise,icon:"heroicons:magnifying-glass",color:"blue"},null,8,["value"]),r(y,{label:"Aprovadas",value:s(p).aprovadas,icon:"heroicons:check-circle",color:"green"},null,8,["value"]),r(y,{label:"Rejeitadas",value:s(p).rejeitadas,icon:"heroicons:x-circle",color:"red"},null,8,["value"]),r(y,{label:"Concluídas",value:s(p).concluidas,icon:"heroicons:check-badge",color:"gray"},null,8,["value"])]),e("div",_e,[e("div",ve,[r(B,{modelValue:s(f),"onUpdate:modelValue":t[0]||(t[0]=a=>C(f)?f.value=a:null),placeholder:"Buscar por colaborador...",class:"w-64"},null,8,["modelValue"]),r(E,{modelValue:s(m),"onUpdate:modelValue":t[1]||(t[1]=a=>C(m)?m.value=a:null),class:"w-48"},{default:h(()=>[...t[7]||(t[7]=[e("option",{value:"todos"},"Todos os status",-1),e("option",{value:"Pendente"},"Pendentes",-1),e("option",{value:"Em_Analise"},"Em Análise",-1),e("option",{value:"Aprovada"},"Aprovadas",-1),e("option",{value:"Rejeitada"},"Rejeitadas",-1),e("option",{value:"Concluida"},"Concluídas",-1)])]),_:1},8,["modelValue"]),r(E,{modelValue:s(_),"onUpdate:modelValue":t[2]||(t[2]=a=>C(_)?_.value=a:null),class:"w-48"},{default:h(()=>[...t[8]||(t[8]=[e("option",{value:""},"Todos os tipos",-1),e("option",{value:"ferias"},"Férias",-1),e("option",{value:"abono"},"Abono",-1),e("option",{value:"atestado"},"Atestado",-1),e("option",{value:"declaracao"},"Declaração",-1),e("option",{value:"holerite"},"Holerite",-1),e("option",{value:"outros"},"Outros",-1)])]),_:1},8,["modelValue"])])]),s(k)?(i(),l("div",ge,[r(u,{name:"heroicons:arrow-path",class:"animate-spin text-gray-400",size:"40"}),t[9]||(t[9]=e("p",{class:"text-gray-500 mt-2"},"Carregando...",-1))])):s(S).length===0?(i(),l("div",xe,[r(O,{icon:"heroicons:document-text",title:"Nenhuma solicitação encontrada",description:"Não há solicitações com os filtros selecionados.",color:"gray"})])):(i(),l("div",be,[(i(!0),l(Q,null,W(s(S),a=>(i(),l("div",{key:a.id,class:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-md transition-shadow"},[e("div",fe,[e("div",ye,[e("div",he,[e("span",{class:A([I(a.tipo),"px-2 py-1 text-xs font-medium rounded-full"])},d(D(a.tipo)),3),e("span",{class:A([T(a.status),"px-2 py-1 text-xs font-medium rounded-full"])},d(L(a.status)),3),a.prioridade==="Urgente"?(i(),l("span",we," Urgente ")):b("",!0)]),e("h4",Ce,d(a.titulo),1),e("p",ke,[e("span",je,d(a.colaborador_nome),1),a.cargo?(i(),l("span",Ae," • "+d(a.cargo),1)):b("",!0),a.departamento?(i(),l("span",Re," • "+d(a.departamento),1)):b("",!0)]),a.descricao?(i(),l("p",Se,d(a.descricao),1)):b("",!0),e("p",Ve," Solicitado em "+d(F(a.data_solicitacao)),1)]),a.status==="Pendente"||a.status==="Em_Analise"?(i(),l("div",Ue,[e("button",{onClick:H=>U(a,"aprovar"),class:"px-3 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700"},[r(u,{name:"heroicons:check",size:"16",class:"mr-1"}),t[10]||(t[10]=w(" Aprovar ",-1))],8,Ee),e("button",{onClick:H=>U(a,"rejeitar"),class:"px-3 py-2 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700"},[r(u,{name:"heroicons:x-mark",size:"16",class:"mr-1"}),t[11]||(t[11]=w(" Rejeitar ",-1))],8,$e)])):b("",!0)])]))),128))]))]),r(q,{modelValue:s(v),"onUpdate:modelValue":t[5]||(t[5]=a=>C(v)?v.value=a:null),title:s(P),size:"md"},{footer:h(()=>[e("div",Te,[e("button",{onClick:t[4]||(t[4]=a=>v.value=!1),class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300"}," Cancelar "),e("button",{onClick:z,disabled:s(n)==="rejeitar"&&!s(x).texto,class:A([s(n)==="aprovar"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700","px-4 py-2 text-white font-medium rounded-lg disabled:opacity-50"])},d(s(n)==="aprovar"?"Confirmar Aprovação":"Confirmar Rejeição"),11,Fe)])]),default:h(()=>[e("div",Pe,[s(g)?(i(),l("div",ze,[e("p",De,[t[12]||(t[12]=w(" Solicitação de ",-1)),e("strong",null,d(s(g).colaborador_nome),1),t[13]||(t[13]=w(": ",-1)),t[14]||(t[14]=e("br",null,null,-1)),w(d(s(g).titulo),1)])])):b("",!0),e("div",null,[e("label",Ie,d(s(n)==="aprovar"?"Observações (opcional)":"Motivo da Rejeição *"),1),Z(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=a=>s(x).texto=a),rows:"4",required:s(n)==="rejeitar",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none",placeholder:s(n)==="aprovar"?"Adicione observações se necessário...":"Informe o motivo da rejeição..."},null,8,Le),[[ee,s(x).texto]])])])]),_:1},8,["modelValue","title"])])}}});export{Qe as default};
