import{d as q,r as b,x as M,f as y,b as t,t as d,e as u,y as E,h as c,z as m,g as e,v as w,I as $,A as U,l as g,o as v,_ as L,B as O,s as F,w as H,k as C,c as J,F as h,j as R,i as z,n as I}from"./DNqCZqpD.js";const K={class:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col"},Q={class:"flex items-center justify-between p-6 border-b border-gray-200"},W={class:"text-2xl font-bold text-gray-900"},X={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Y={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},tt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ot={class:"flex items-center gap-6"},et={class:"flex items-center"},at={class:"flex items-center"},st={class:"flex items-center"},it={class:"flex items-center justify-between gap-4 p-6 border-t border-gray-200 bg-gray-50"},lt={class:"flex gap-3"},nt=["disabled"],rt=q({__name:"ModalPolitica",props:{politica:{}},emits:["close","saved"],setup(T,{emit:V}){const x=T,k=V,_=b(!1),a=b({codigo:"",titulo:"",descricao:"",tipo:"",categoria:"",conteudo_html:"",conteudo_texto:"",resumo:"",versao:"1.0",data_vigencia:new Date().toISOString().split("T")[0],data_expiracao:null,status:"rascunho",publicado:!1,obrigatorio_aceite:!1,aplica_todos_colaboradores:!0,prazo_aceite_dias:30,empresa_id:"00000000-0000-0000-0000-000000000000"});M(()=>{x.politica&&(a.value={...a.value,...x.politica})});async function f(){_.value=!0;try{x.politica?(await $fetch(`/api/politicas/${x.politica.id}`,{method:"PUT",body:a.value}),alert("Política atualizada com sucesso!")):(await $fetch("/api/politicas",{method:"POST",body:a.value}),alert("Política criada com sucesso!")),k("saved"),k("close")}catch(r){console.error("Erro ao salvar política:",r);const o=r?.data?.message||r?.message||"Erro ao salvar política";alert(`Erro: ${o}`)}finally{_.value=!1}}return(r,o)=>{const P=L;return v(),y("div",{class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:o[18]||(o[18]=E(i=>r.$emit("close"),["self"]))},[t("div",K,[t("div",Q,[t("h2",W,d(T.politica?"Editar Política":"Nova Política"),1),t("button",{onClick:o[0]||(o[0]=i=>r.$emit("close")),class:"text-gray-400 hover:text-gray-600 transition-colors",type:"button"},[u(P,{name:"mdi:close",size:"28"})])]),t("form",{onSubmit:E(f,["prevent"]),class:"flex-1 overflow-y-auto p-6 space-y-4"},[t("div",X,[t("div",null,[o[19]||(o[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Código * ",-1)),c(t("input",{"onUpdate:modelValue":o[1]||(o[1]=i=>e(a).codigo=i),type:"text",required:"",placeholder:"LGPD_001",class:"input"},null,512),[[m,e(a).codigo]])]),t("div",null,[o[21]||(o[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Tipo * ",-1)),c(t("select",{"onUpdate:modelValue":o[2]||(o[2]=i=>e(a).tipo=i),required:"",class:"input"},[...o[20]||(o[20]=[$('<option value="">Selecione...</option><option value="lgpd">LGPD</option><option value="termo_uso">Termo de Uso</option><option value="politica_interna">Política Interna</option><option value="codigo_conduta">Código de Conduta</option><option value="regulamento">Regulamento</option><option value="outro">Outro</option>',7)])],512),[[w,e(a).tipo]])])]),t("div",null,[o[22]||(o[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Título * ",-1)),c(t("input",{"onUpdate:modelValue":o[3]||(o[3]=i=>e(a).titulo=i),type:"text",required:"",placeholder:"Política de Privacidade e Proteção de Dados",class:"input"},null,512),[[m,e(a).titulo]])]),t("div",null,[o[23]||(o[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Descrição ",-1)),c(t("textarea",{"onUpdate:modelValue":o[4]||(o[4]=i=>e(a).descricao=i),rows:"2",placeholder:"Breve descrição da política",class:"input"},null,512),[[m,e(a).descricao]])]),t("div",Y,[t("div",null,[o[25]||(o[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Categoria ",-1)),c(t("select",{"onUpdate:modelValue":o[5]||(o[5]=i=>e(a).categoria=i),class:"input"},[...o[24]||(o[24]=[$('<option value="">Selecione...</option><option value="privacidade">Privacidade</option><option value="seguranca">Segurança</option><option value="rh">RH</option><option value="ti">TI</option><option value="financeiro">Financeiro</option><option value="operacional">Operacional</option>',7)])],512),[[w,e(a).categoria]])]),t("div",null,[o[26]||(o[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Versão * ",-1)),c(t("input",{"onUpdate:modelValue":o[6]||(o[6]=i=>e(a).versao=i),type:"text",required:"",placeholder:"1.0",class:"input"},null,512),[[m,e(a).versao]])])]),t("div",Z,[t("div",null,[o[27]||(o[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Data de Vigência * ",-1)),c(t("input",{"onUpdate:modelValue":o[7]||(o[7]=i=>e(a).data_vigencia=i),type:"date",required:"",class:"input"},null,512),[[m,e(a).data_vigencia]])]),t("div",null,[o[28]||(o[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Data de Expiração ",-1)),c(t("input",{"onUpdate:modelValue":o[8]||(o[8]=i=>e(a).data_expiracao=i),type:"date",class:"input"},null,512),[[m,e(a).data_expiracao]])])]),t("div",null,[o[29]||(o[29]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Conteúdo HTML * ",-1)),c(t("textarea",{"onUpdate:modelValue":o[9]||(o[9]=i=>e(a).conteudo_html=i),rows:"10",required:"",placeholder:"<h2>Título</h2><p>Conteúdo da política...</p>",class:"input font-mono text-sm"},null,512),[[m,e(a).conteudo_html]])]),t("div",null,[o[30]||(o[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Resumo ",-1)),c(t("textarea",{"onUpdate:modelValue":o[10]||(o[10]=i=>e(a).resumo=i),rows:"3",placeholder:"Resumo executivo da política",class:"input"},null,512),[[m,e(a).resumo]])]),t("div",tt,[t("div",null,[o[32]||(o[32]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Status ",-1)),c(t("select",{"onUpdate:modelValue":o[11]||(o[11]=i=>e(a).status=i),class:"input"},[...o[31]||(o[31]=[$('<option value="rascunho">Rascunho</option><option value="em_revisao">Em Revisão</option><option value="aprovado">Aprovado</option><option value="publicado">Publicado</option><option value="arquivado">Arquivado</option>',5)])],512),[[w,e(a).status]])]),t("div",null,[o[33]||(o[33]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Prazo para Aceite (dias) ",-1)),c(t("input",{"onUpdate:modelValue":o[12]||(o[12]=i=>e(a).prazo_aceite_dias=i),type:"number",min:"1",placeholder:"30",class:"input"},null,512),[[m,e(a).prazo_aceite_dias,void 0,{number:!0}]])])]),t("div",ot,[t("div",et,[c(t("input",{"onUpdate:modelValue":o[13]||(o[13]=i=>e(a).publicado=i),type:"checkbox",id:"publicado",class:"checkbox"},null,512),[[U,e(a).publicado]]),o[34]||(o[34]=t("label",{for:"publicado",class:"ml-2 text-sm text-gray-700"}," Publicado ",-1))]),t("div",at,[c(t("input",{"onUpdate:modelValue":o[14]||(o[14]=i=>e(a).obrigatorio_aceite=i),type:"checkbox",id:"obrigatorio",class:"checkbox"},null,512),[[U,e(a).obrigatorio_aceite]]),o[35]||(o[35]=t("label",{for:"obrigatorio",class:"ml-2 text-sm text-gray-700"}," Obrigatório Aceite ",-1))]),t("div",st,[c(t("input",{"onUpdate:modelValue":o[15]||(o[15]=i=>e(a).aplica_todos_colaboradores=i),type:"checkbox",id:"todos",class:"checkbox"},null,512),[[U,e(a).aplica_todos_colaboradores]]),o[36]||(o[36]=t("label",{for:"todos",class:"ml-2 text-sm text-gray-700"}," Aplica a Todos ",-1))])]),t("div",it,[t("button",{type:"button",onClick:o[16]||(o[16]=i=>("navigateTo"in r?r.navigateTo:e(O))("/configuracoes")),class:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"},[u(P,{name:"mdi:arrow-left",size:"20"}),o[37]||(o[37]=g(" Voltar para Configurações ",-1))]),t("div",lt,[t("button",{type:"button",onClick:o[17]||(o[17]=i=>r.$emit("close")),class:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"}," Cancelar "),t("button",{type:"submit",class:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:e(_)},[u(P,{name:"mdi:content-save",size:"20"}),g(" "+d(e(_)?"Salvando...":"Salvar"),1)],8,nt)])])],32)])])}}}),dt=Object.assign(rt,{__name:"ModalPolitica"}),ct={class:"container mx-auto px-4 py-8"},ut={class:"mb-6"},pt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8"},mt={class:"card"},vt={class:"text-2xl font-bold text-gray-800"},bt={class:"text-xs text-gray-500 mt-1"},gt={class:"card"},xt={class:"text-2xl font-bold text-green-600"},ft={class:"text-xs text-gray-500 mt-1"},yt={class:"card"},_t={class:"text-2xl font-bold text-amber-600"},kt={class:"text-xs text-red-500 mt-1"},Pt={class:"card"},wt={class:"text-2xl font-bold text-red-600"},$t={class:"text-xs text-gray-500 mt-1"},Ct={class:"mb-6"},Tt={class:"border-b border-gray-200"},Vt={class:"-mb-px flex space-x-8"},At=["onClick"],Ut={key:0,class:"space-y-6"},Dt={class:"flex justify-between items-center mb-4"},St={class:"flex gap-3 mb-4"},Et={class:"grid grid-cols-1 gap-4"},ht={class:"flex justify-between items-start"},Rt={class:"flex-1"},zt={class:"flex items-center gap-2 mb-2"},It={class:"text-lg font-semibold"},qt={key:0,class:"px-2 py-1 text-xs bg-red-100 text-red-700 rounded"},Mt={class:"text-sm text-gray-600 mb-2"},Lt={class:"flex items-center gap-4 text-xs text-gray-500"},Ot={key:0},jt={class:"flex gap-2"},Bt=["onClick"],Nt=["onClick"],Ft=q({__name:"politicas",setup(T){const V=[{id:"politicas",label:"Políticas",icon:"mdi:file-document-multiple"},{id:"aceites",label:"Aceites",icon:"mdi:check-circle"},{id:"incidentes",label:"Incidentes",icon:"mdi:alert"},{id:"auditorias",label:"Auditorias",icon:"mdi:clipboard-check"}],x=b("politicas"),k=b(!1),_=b(null),a=b(""),f=b(""),r=b({totalPoliticas:0,politicasPublicadas:0,politicasRascunho:0,politicasObrigatorias:0,totalAceites:0,aceitesCompletos:0,aceitesPendentes:0,aceitesAtrasados:0,taxaAceite:"0.0",totalIncidentes:0,incidentesAbertos:0,incidentesCriticos:0,totalTreinamentos:0,treinamentosAtivos:0}),o=b([]),P=F(()=>{let n=o.value;return a.value&&(n=n.filter(s=>s.tipo===a.value)),f.value&&(n=n.filter(s=>s.status===f.value)),n});M(async()=>{await Promise.all([i(),A()])}),H([a,f],()=>{});async function i(){try{const n=await $fetch("/api/politicas/stats");r.value=n}catch(n){console.error("Erro ao carregar estatísticas:",n)}}async function A(){try{o.value=await $fetch("/api/politicas")}catch(n){console.error("Erro ao carregar políticas:",n)}}function D(n=null){_.value=n,k.value=!0}async function j(n){if(confirm("Deseja realmente excluir esta política?"))try{await $fetch(`/api/politicas/${n}`,{method:"DELETE"}),await A(),await i(),alert("Política excluída com sucesso!")}catch(s){console.error("Erro ao excluir política:",s),alert("Erro ao excluir política")}}function B(n){return{lgpd:"LGPD",termo_uso:"Termo de Uso",politica_interna:"Política Interna",codigo_conduta:"Código de Conduta",regulamento:"Regulamento",outro:"Outro"}[n]||n}function N(n){return new Date(n).toLocaleDateString("pt-BR")}return(n,s)=>{const p=L,G=dt;return v(),y("div",ct,[t("div",ut,[t("button",{onClick:s[0]||(s[0]=l=>("navigateTo"in n?n.navigateTo:e(O))("/configuracoes")),class:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors shadow-sm"},[u(p,{name:"mdi:arrow-left",size:"20"}),s[5]||(s[5]=g(" Voltar para Configurações ",-1))])]),s[14]||(s[14]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-gray-800 mb-2"},"Políticas e Compliance"),t("p",{class:"text-gray-600"},"LGPD, termos de uso, políticas internas e gestão de compliance")],-1)),t("div",pt,[t("div",mt,[s[6]||(s[6]=t("div",{class:"text-sm text-gray-600 mb-1"},"Total de Políticas",-1)),t("div",vt,d(e(r).totalPoliticas),1),t("div",bt,d(e(r).politicasPublicadas)+" publicadas",1)]),t("div",gt,[s[7]||(s[7]=t("div",{class:"text-sm text-gray-600 mb-1"},"Taxa de Aceite",-1)),t("div",xt,d(e(r).taxaAceite)+"%",1),t("div",ft,d(e(r).aceitesCompletos)+"/"+d(e(r).totalAceites),1)]),t("div",yt,[s[8]||(s[8]=t("div",{class:"text-sm text-gray-600 mb-1"},"Aceites Pendentes",-1)),t("div",_t,d(e(r).aceitesPendentes),1),t("div",kt,d(e(r).aceitesAtrasados)+" atrasados",1)]),t("div",Pt,[s[9]||(s[9]=t("div",{class:"text-sm text-gray-600 mb-1"},"Incidentes",-1)),t("div",wt,d(e(r).totalIncidentes),1),t("div",$t,d(e(r).incidentesAbertos)+" abertos",1)])]),t("div",Ct,[t("div",Tt,[t("nav",Vt,[(v(),y(h,null,R(V,l=>t("button",{key:l.id,onClick:S=>x.value=l.id,class:I(["py-4 px-1 border-b-2 font-medium text-sm transition-colors",e(x)===l.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[u(p,{name:l.icon,class:"inline mr-2"},null,8,["name"]),g(" "+d(l.label),1)],10,At)),64))])])]),e(x)==="politicas"?(v(),y("div",Ut,[t("div",Dt,[s[11]||(s[11]=t("div",null,[t("h2",{class:"text-xl font-semibold"},"Políticas e Documentos"),t("p",{class:"text-sm text-gray-600"},"Gerencie políticas internas e documentos de compliance")],-1)),t("button",{onClick:s[1]||(s[1]=l=>D()),class:"btn-primary"},[u(p,{name:"mdi:plus",class:"mr-2"}),s[10]||(s[10]=g(" Nova Política ",-1))])]),t("div",St,[c(t("select",{"onUpdate:modelValue":s[2]||(s[2]=l=>z(a)?a.value=l:null),class:"input w-48"},[...s[12]||(s[12]=[$('<option value="">Todos os tipos</option><option value="lgpd">LGPD</option><option value="termo_uso">Termo de Uso</option><option value="politica_interna">Política Interna</option><option value="codigo_conduta">Código de Conduta</option><option value="regulamento">Regulamento</option>',6)])],512),[[w,e(a)]]),c(t("select",{"onUpdate:modelValue":s[3]||(s[3]=l=>z(f)?f.value=l:null),class:"input w-48"},[...s[13]||(s[13]=[$('<option value="">Todos os status</option><option value="rascunho">Rascunho</option><option value="em_revisao">Em Revisão</option><option value="aprovado">Aprovado</option><option value="publicado">Publicado</option><option value="arquivado">Arquivado</option>',6)])],512),[[w,e(f)]])]),t("div",Et,[(v(!0),y(h,null,R(e(P),l=>(v(),y("div",{key:l.id,class:"card hover:shadow-lg transition-shadow"},[t("div",ht,[t("div",Rt,[t("div",zt,[t("h3",It,d(l.titulo),1),t("span",{class:I(["px-2 py-1 text-xs rounded",l.publicado?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"])},d(l.publicado?"Publicado":l.status),3),l.obrigatorio_aceite?(v(),y("span",qt," Obrigatório ")):C("",!0)]),t("p",Mt,d(l.descricao),1),t("div",Lt,[t("span",null,[u(p,{name:"mdi:tag",class:"inline"}),g(" "+d(B(l.tipo)),1)]),l.categoria?(v(),y("span",Ot,[u(p,{name:"mdi:folder",class:"inline"}),g(" "+d(l.categoria),1)])):C("",!0),t("span",null,[u(p,{name:"mdi:calendar",class:"inline"}),g(" Vigência: "+d(N(l.data_vigencia)),1)]),t("span",null,[u(p,{name:"mdi:file-document",class:"inline"}),g(" v"+d(l.versao),1)])])]),t("div",jt,[t("button",{onClick:S=>D(l),class:"btn-icon",title:"Editar"},[u(p,{name:"mdi:pencil"})],8,Bt),t("button",{onClick:S=>j(l.id),class:"btn-icon text-red-600 hover:bg-red-50",title:"Excluir"},[u(p,{name:"mdi:delete"})],8,Nt)])])]))),128))])])):C("",!0),e(k)?(v(),J(G,{key:1,politica:e(_),onClose:s[4]||(s[4]=l=>k.value=!1),onSaved:A},null,8,["politica"])):C("",!0)])}}});export{Ft as default};
