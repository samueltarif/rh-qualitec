import{d as M,r as b,x as P,a as L,g as p,o as m,y as j,e,t as f,f as n,l as z,b as g,h as a,i as C,z as D,j as N,A as h,p as k,s as H,c as K,_ as Q,F as O,k as T}from"./BSA_tgdP.js";import{_ as W}from"./yUH5lwCE.js";import{_ as A}from"./DUWoehAD.js";import{_ as B}from"./yogEyCnZ.js";import{_ as q}from"./BBzIiODl.js";const X={class:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto"},Y={class:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"},Z={class:"text-xl font-bold text-gray-800"},ee={class:"grid md:grid-cols-2 gap-4"},oe={class:"grid md:grid-cols-2 gap-4"},te={key:0},se={class:"grid md:grid-cols-2 gap-4"},ae={class:"grid md:grid-cols-2 gap-4"},le={class:"space-y-2"},ne={class:"flex items-center gap-2"},re={class:"flex items-center gap-2"},ie={class:"flex items-center gap-2"},de={class:"flex items-center gap-2"},me={class:"flex gap-4 pt-4"},ue=M({__name:"ModalCampoCustomizado",props:{campo:{}},emits:["close","saved"],setup(V,{emit:w}){const c=V,_=w,y=b(!1),u=b(""),s=b({id:"",nome:"",label:"",descricao:"",entidade:"colaborador",tipo_campo:"texto",opcoes:null,obrigatorio:!1,valor_padrao:"",mascara:"",ordem:0,grupo:"",visivel:!0,editavel:!0,ativo:!0});P(()=>{c.campo&&(s.value={...s.value,...c.campo},c.campo.opcoes&&Array.isArray(c.campo.opcoes)&&(u.value=c.campo.opcoes.join(`
`)))});const $=async()=>{if(!/^[a-z0-9_]+$/.test(s.value.nome)){alert("Nome do campo inválido. Use apenas letras minúsculas, números e underscore (_)");return}if(s.value.tipo_campo==="select"&&u.value&&(s.value.opcoes=u.value.split(`
`).map(i=>i.trim()).filter(i=>i.length>0),s.value.opcoes.length===0)){alert("Adicione pelo menos uma opção para campos de seleção");return}y.value=!0;try{c.campo?await $fetch(`/api/campos-customizados/${c.campo.id}`,{method:"PUT",body:s.value}):await $fetch("/api/campos-customizados",{method:"POST",body:s.value}),alert("✅ Campo salvo com sucesso!"),_("saved"),_("close")}catch(i){console.error("Erro ao salvar:",i),alert(`Erro ao salvar: ${i.data?.message||i.message||"Erro desconhecido"}`)}finally{y.value=!1}};return(i,o)=>{const E=L("Icon"),U=A,r=B,l=q;return m(),p("div",{class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:o[16]||(o[16]=j(t=>i.$emit("close"),["self"]))},[e("div",X,[e("div",Y,[e("h2",Z,f(V.campo?"Editar Campo":"Novo Campo Customizado"),1),e("button",{onClick:o[0]||(o[0]=t=>i.$emit("close")),class:"text-gray-400 hover:text-gray-600"},[n(E,{name:"heroicons:x-mark",size:"24"})])]),e("form",{onSubmit:j($,["prevent"]),class:"p-6 space-y-4"},[e("div",ee,[e("div",null,[o[18]||(o[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Entidade *",-1)),n(U,{modelValue:a(s).entidade,"onUpdate:modelValue":o[1]||(o[1]=t=>a(s).entidade=t),required:"",disabled:!!V.campo},{default:g(()=>[...o[17]||(o[17]=[e("option",{value:""},"Selecione",-1),e("option",{value:"colaborador"},"Colaborador",-1),e("option",{value:"empresa"},"Empresa",-1),e("option",{value:"documento"},"Documento",-1)])]),_:1},8,["modelValue","disabled"]),o[19]||(o[19]=e("p",{class:"text-xs text-gray-500 mt-1"},"Onde o campo será usado",-1))]),e("div",null,[o[20]||(o[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nome do Campo *",-1)),n(r,{modelValue:a(s).nome,"onUpdate:modelValue":o[2]||(o[2]=t=>a(s).nome=t),required:"",disabled:!!V.campo,placeholder:"ex: nome_social"},null,8,["modelValue","disabled"]),o[21]||(o[21]=e("p",{class:"text-xs text-gray-500 mt-1"},"Identificador único (sem espaços)",-1))])]),e("div",null,[o[22]||(o[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Rótulo *",-1)),n(r,{modelValue:a(s).label,"onUpdate:modelValue":o[3]||(o[3]=t=>a(s).label=t),required:"",placeholder:"ex: Nome Social"},null,8,["modelValue"])]),e("div",null,[o[23]||(o[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Descrição",-1)),C(e("textarea",{"onUpdate:modelValue":o[4]||(o[4]=t=>a(s).descricao=t),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Descrição do campo..."},null,512),[[D,a(s).descricao]])]),e("div",oe,[e("div",null,[o[25]||(o[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tipo de Campo *",-1)),n(U,{modelValue:a(s).tipo_campo,"onUpdate:modelValue":o[5]||(o[5]=t=>a(s).tipo_campo=t),required:""},{default:g(()=>[...o[24]||(o[24]=[e("option",{value:""},"Selecione",-1),e("option",{value:"texto"},"Texto",-1),e("option",{value:"textarea"},"Texto Longo",-1),e("option",{value:"numero"},"Número",-1),e("option",{value:"data"},"Data",-1),e("option",{value:"email"},"E-mail",-1),e("option",{value:"telefone"},"Telefone",-1),e("option",{value:"cpf"},"CPF",-1),e("option",{value:"cnpj"},"CNPJ",-1),e("option",{value:"select"},"Seleção (Dropdown)",-1),e("option",{value:"checkbox"},"Checkbox",-1)])]),_:1},8,["modelValue"])]),e("div",null,[o[26]||(o[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Grupo",-1)),n(r,{modelValue:a(s).grupo,"onUpdate:modelValue":o[6]||(o[6]=t=>a(s).grupo=t),placeholder:"ex: Dados Pessoais"},null,8,["modelValue"]),o[27]||(o[27]=e("p",{class:"text-xs text-gray-500 mt-1"},"Para organizar campos",-1))])]),a(s).tipo_campo==="select"?(m(),p("div",te,[o[28]||(o[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Opções *",-1)),C(e("textarea",{"onUpdate:modelValue":o[7]||(o[7]=t=>N(u)?u.value=t:null),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:`Uma opção por linha
Opção 1
Opção 2
Opção 3`},null,512),[[D,a(u)]]),o[29]||(o[29]=e("p",{class:"text-xs text-gray-500 mt-1"},"Digite uma opção por linha",-1))])):z("",!0),e("div",se,[e("div",null,[o[30]||(o[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Valor Padrão",-1)),n(r,{modelValue:a(s).valor_padrao,"onUpdate:modelValue":o[8]||(o[8]=t=>a(s).valor_padrao=t),placeholder:"Valor inicial"},null,8,["modelValue"])]),e("div",null,[o[31]||(o[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Máscara",-1)),n(r,{modelValue:a(s).mascara,"onUpdate:modelValue":o[9]||(o[9]=t=>a(s).mascara=t),placeholder:"ex: 000.000.000-00"},null,8,["modelValue"])])]),e("div",ae,[e("div",null,[o[32]||(o[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Ordem de Exibição",-1)),n(r,{modelValue:a(s).ordem,"onUpdate:modelValue":o[10]||(o[10]=t=>a(s).ordem=t),modelModifiers:{number:!0},type:"number",min:"0"},null,8,["modelValue"])])]),e("div",le,[e("label",ne,[C(e("input",{type:"checkbox","onUpdate:modelValue":o[11]||(o[11]=t=>a(s).obrigatorio=t),class:"rounded text-red-600 focus:ring-red-500"},null,512),[[h,a(s).obrigatorio]]),o[33]||(o[33]=e("span",{class:"text-sm text-gray-700"},"Campo obrigatório",-1))]),e("label",re,[C(e("input",{type:"checkbox","onUpdate:modelValue":o[12]||(o[12]=t=>a(s).visivel=t),class:"rounded text-red-600 focus:ring-red-500"},null,512),[[h,a(s).visivel]]),o[34]||(o[34]=e("span",{class:"text-sm text-gray-700"},"Visível",-1))]),e("label",ie,[C(e("input",{type:"checkbox","onUpdate:modelValue":o[13]||(o[13]=t=>a(s).editavel=t),class:"rounded text-red-600 focus:ring-red-500"},null,512),[[h,a(s).editavel]]),o[35]||(o[35]=e("span",{class:"text-sm text-gray-700"},"Editável",-1))]),e("label",de,[C(e("input",{type:"checkbox","onUpdate:modelValue":o[14]||(o[14]=t=>a(s).ativo=t),class:"rounded text-red-600 focus:ring-red-500"},null,512),[[h,a(s).ativo]]),o[36]||(o[36]=e("span",{class:"text-sm text-gray-700"},"Ativo",-1))])]),e("div",me,[n(l,{type:"button",onClick:o[15]||(o[15]=t=>i.$emit("close")),theme:"admin",variant:"secondary","full-width":""},{default:g(()=>[...o[37]||(o[37]=[k(" Cancelar ",-1)])]),_:1}),n(l,{type:"submit",theme:"admin",variant:"primary","full-width":"",disabled:a(y)},{default:g(()=>[k(f(a(y)?"Salvando...":"Salvar"),1)]),_:1},8,["disabled"])])],32)])])}}}),pe=Object.assign(ue,{__name:"ModalCampoCustomizado"}),ce={class:"min-h-screen bg-gray-50"},xe={class:"bg-white border-b border-gray-200 sticky top-0 z-40"},ve={class:"max-w-7xl mx-auto px-8 py-4"},be={class:"flex items-center justify-between"},ge={class:"flex items-center gap-4"},fe={class:"max-w-7xl mx-auto p-8"},ye={class:"card mb-6"},_e={class:"flex flex-wrap gap-4 items-center justify-between"},Ce={class:"flex gap-4 items-center flex-1"},ke={key:0,class:"card text-center py-12"},Ve={key:1,class:"space-y-4"},we={class:"flex items-center justify-between mb-4"},$e={class:"text-lg font-semibold text-gray-800"},ze={class:"text-sm text-gray-500 font-normal ml-2"},Ue={class:"space-y-2"},he={class:"flex-1"},Ee={class:"flex items-center gap-2 mb-1"},Ie={class:"font-medium text-gray-800"},Ne={class:"text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-700"},Se={key:0,class:"text-xs px-2 py-0.5 rounded-full bg-red-100 text-red-700"},je={key:1,class:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-700"},De={class:"text-sm text-gray-600"},Oe={class:"text-xs text-gray-500 mt-1"},Te={class:"bg-gray-200 px-1 rounded"},Me={class:"flex gap-2"},Pe=["onClick"],Le=["onClick"],Ae={key:0,class:"card text-center py-12"},Je=M({__name:"campos-customizados",setup(V){const w=b(!0),c=b(!1),_=b(null),y=b([]),u=b(""),s=b(""),$=async()=>{w.value=!0;try{const r=await $fetch("/api/campos-customizados");y.value=r.data||[]}catch(r){console.error("Erro ao carregar campos:",r),alert("Erro ao carregar campos customizados")}finally{w.value=!1}},i=H(()=>{let r=y.value;if(u.value&&(r=r.filter(t=>t.entidade===u.value)),s.value){const t=s.value.toLowerCase();r=r.filter(d=>d.label.toLowerCase().includes(t)||d.nome.toLowerCase().includes(t)||d.descricao&&d.descricao.toLowerCase().includes(t))}const l={};return r.forEach(t=>{const d=`${t.entidade} - ${t.grupo||"Outros"}`;l[d]||(l[d]={nome:d,campos:[]}),l[d].campos.push(t)}),Object.values(l).forEach(t=>{t.campos.sort((d,I)=>d.ordem-I.ordem)}),Object.values(l)}),o=(r=null)=>{_.value=r,c.value=!0},E=()=>{c.value=!1,_.value=null},U=async r=>{if(confirm(`Tem certeza que deseja excluir o campo "${r.label}"?

Isso também excluirá todos os valores associados.`))try{await $fetch(`/api/campos-customizados/${r.id}`,{method:"DELETE"}),alert("✅ Campo excluído com sucesso!"),$()}catch(l){console.error("Erro ao excluir:",l),alert("Erro ao excluir campo")}};return P(()=>{$()}),(r,l)=>{const t=L("Icon"),d=Q,I=W,F=A,R=B,S=q,G=pe;return m(),p("div",ce,[e("header",xe,[e("div",ve,[e("div",be,[e("div",ge,[n(d,{to:"/configuracoes",class:"w-10 h-10 bg-red-700 rounded-lg flex items-center justify-center hover:bg-red-800 transition-colors"},{default:g(()=>[n(t,{name:"heroicons:arrow-left",class:"text-white",size:"20"})]),_:1}),l[4]||(l[4]=e("div",null,[e("h1",{class:"text-xl font-bold text-gray-800"},"Campos Customizados"),e("p",{class:"text-sm text-gray-500"},"Crie campos adicionais para colaboradores e outras entidades")],-1))]),n(I,{theme:"admin"})])])]),e("div",fe,[e("div",ye,[e("div",_e,[e("div",Ce,[n(F,{modelValue:a(u),"onUpdate:modelValue":l[0]||(l[0]=x=>N(u)?u.value=x:null),class:"w-48"},{default:g(()=>[...l[5]||(l[5]=[e("option",{value:""},"Todas as Entidades",-1),e("option",{value:"colaborador"},"Colaborador",-1),e("option",{value:"empresa"},"Empresa",-1),e("option",{value:"documento"},"Documento",-1)])]),_:1},8,["modelValue"]),n(R,{modelValue:a(s),"onUpdate:modelValue":l[1]||(l[1]=x=>N(s)?s.value=x:null),placeholder:"Buscar campos...",class:"flex-1 max-w-md"},{prefix:g(()=>[n(t,{name:"heroicons:magnifying-glass",class:"text-gray-400",size:"20"})]),_:1},8,["modelValue"])]),n(S,{onClick:l[2]||(l[2]=x=>o()),theme:"admin"},{default:g(()=>[n(t,{name:"heroicons:plus",size:"20"}),l[6]||(l[6]=k(" Novo Campo ",-1))]),_:1})])]),a(w)?(m(),p("div",ke,[n(t,{name:"heroicons:arrow-path",class:"animate-spin text-gray-400 mx-auto mb-4",size:"48"}),l[7]||(l[7]=e("p",{class:"text-gray-600"},"Carregando campos...",-1))])):(m(),p("div",Ve,[(m(!0),p(O,null,T(a(i),x=>(m(),p("div",{key:x.nome,class:"card"},[e("div",we,[e("h3",$e,[k(f(x.nome)+" ",1),e("span",ze,"("+f(x.campos.length)+")",1)])]),e("div",Ue,[(m(!0),p(O,null,T(x.campos,v=>(m(),p("div",{key:v.id,class:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},[e("div",he,[e("div",Ee,[e("h4",Ie,f(v.label),1),e("span",Ne,f(v.tipo_campo),1),v.obrigatorio?(m(),p("span",Se," Obrigatório ")):z("",!0),v.ativo?z("",!0):(m(),p("span",je," Inativo "))]),e("p",De,f(v.descricao||"Sem descrição"),1),e("p",Oe,[l[8]||(l[8]=k(" Nome do campo: ",-1)),e("code",Te,f(v.nome),1)])]),e("div",Me,[e("button",{onClick:J=>o(v),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Editar"},[n(t,{name:"heroicons:pencil",size:"20"})],8,Pe),e("button",{onClick:J=>U(v),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Excluir"},[n(t,{name:"heroicons:trash",size:"20"})],8,Le)])]))),128))])]))),128)),a(i).length===0?(m(),p("div",Ae,[n(t,{name:"heroicons:inbox",class:"text-gray-300 mx-auto mb-4",size:"64"}),l[10]||(l[10]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"Nenhum campo encontrado",-1)),l[11]||(l[11]=e("p",{class:"text-gray-600 mb-4"},"Crie campos customizados para adicionar informações extras",-1)),n(S,{onClick:l[3]||(l[3]=x=>o()),theme:"admin"},{default:g(()=>[n(t,{name:"heroicons:plus",size:"20"}),l[9]||(l[9]=k(" Criar Primeiro Campo ",-1))]),_:1})])):z("",!0)]))]),a(c)?(m(),K(G,{key:0,campo:a(_),onClose:E,onSaved:$},null,8,["campo"])):z("",!0)])}}});export{Je as default};
