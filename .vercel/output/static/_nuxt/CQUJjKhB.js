import{d as N,r as v,x as M,f as p,b as e,t as b,e as n,y as I,g as a,h as $,z as j,a as x,i as S,A as T,o as c,_ as B,l as C,s as X,c as A,k as _,F as D,j as F,p as Y,n as Z}from"./DNqCZqpD.js";import{_ as ee}from"./BDJByVvn.js";import{_ as L}from"./DuTwkaXX.js";import{_ as q}from"./CG8w0uCL.js";import{_ as O}from"./DdnJSzYT.js";const oe={class:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto"},te={class:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"},ae={class:"text-xl font-bold text-gray-800"},se={class:"grid md:grid-cols-2 gap-4"},re={class:"grid md:grid-cols-2 gap-4"},le={class:"space-y-2"},ne={class:"flex items-center gap-2"},ie={class:"flex items-center gap-2"},de={class:"flex items-center gap-2"},ce={class:"flex items-center gap-2"},ue={class:"flex gap-4 pt-4"},me=N({__name:"ModalRelatorioTemplate",props:{template:{}},emits:["close","saved"],setup(R,{emit:h}){const u=R,k=h,f=v(!1),g=v(""),s=v({id:"",nome:"",descricao:"",categoria:"colaboradores",entidade_principal:"colaboradores",campos_selecionados:[],formato_padrao:"pdf",orientacao:"portrait",incluir_logo:!0,incluir_cabecalho:!0,incluir_rodape:!0,ativo:!0});M(()=>{u.template&&(s.value={...s.value,...u.template},u.template.campos_selecionados&&Array.isArray(u.template.campos_selecionados)&&(g.value=u.template.campos_selecionados.join(", ")))});const y=async()=>{if(s.value.campos_selecionados=g.value.split(",").map(m=>m.trim()).filter(m=>m.length>0),s.value.campos_selecionados.length===0){alert("Adicione pelo menos um campo ao relatÃ³rio");return}f.value=!0;try{u.template?await $fetch(`/api/relatorios/templates/${u.template.id}`,{method:"PUT",body:s.value}):await $fetch("/api/relatorios/templates",{method:"POST",body:s.value}),alert("âœ… RelatÃ³rio salvo com sucesso!"),k("saved"),k("close")}catch(m){console.error("Erro ao salvar:",m),alert(`Erro ao salvar: ${m.data?.message||m.message||"Erro desconhecido"}`)}finally{f.value=!1}};return(m,o)=>{const z=B,V=q,w=L,U=O;return c(),p("div",{class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:o[13]||(o[13]=I(r=>m.$emit("close"),["self"]))},[e("div",oe,[e("div",te,[e("h2",ae,b(R.template?"Editar RelatÃ³rio":"Novo RelatÃ³rio"),1),e("button",{onClick:o[0]||(o[0]=r=>m.$emit("close")),class:"text-gray-400 hover:text-gray-600"},[n(z,{name:"heroicons:x-mark",size:"24"})])]),e("form",{onSubmit:I(y,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[o[14]||(o[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nome do RelatÃ³rio *",-1)),n(V,{modelValue:a(s).nome,"onUpdate:modelValue":o[1]||(o[1]=r=>a(s).nome=r),required:"",placeholder:"Ex: Lista de Colaboradores Ativos"},null,8,["modelValue"])]),e("div",null,[o[15]||(o[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"DescriÃ§Ã£o",-1)),$(e("textarea",{"onUpdate:modelValue":o[2]||(o[2]=r=>a(s).descricao=r),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"DescriÃ§Ã£o do relatÃ³rio..."},null,512),[[j,a(s).descricao]])]),e("div",se,[e("div",null,[o[17]||(o[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Categoria *",-1)),n(w,{modelValue:a(s).categoria,"onUpdate:modelValue":o[3]||(o[3]=r=>a(s).categoria=r),required:""},{default:x(()=>[...o[16]||(o[16]=[e("option",{value:""},"Selecione",-1),e("option",{value:"colaboradores"},"Colaboradores",-1),e("option",{value:"folha"},"Folha de Pagamento",-1),e("option",{value:"ponto"},"Ponto",-1),e("option",{value:"ferias"},"FÃ©rias",-1),e("option",{value:"documentos"},"Documentos",-1),e("option",{value:"geral"},"Geral",-1)])]),_:1},8,["modelValue"])]),e("div",null,[o[19]||(o[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Entidade Principal *",-1)),n(w,{modelValue:a(s).entidade_principal,"onUpdate:modelValue":o[4]||(o[4]=r=>a(s).entidade_principal=r),required:""},{default:x(()=>[...o[18]||(o[18]=[e("option",{value:""},"Selecione",-1),e("option",{value:"colaboradores"},"colaboradores",-1),e("option",{value:"folha_pagamento"},"folha_pagamento",-1),e("option",{value:"registros_ponto"},"registros_ponto",-1),e("option",{value:"ferias"},"ferias",-1),e("option",{value:"documentos_colaboradores"},"documentos_colaboradores",-1)])]),_:1},8,["modelValue"])])]),e("div",null,[o[20]||(o[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Campos a Incluir *",-1)),$(e("textarea",{"onUpdate:modelValue":o[5]||(o[5]=r=>S(g)?g.value=r:null),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent font-mono text-sm",placeholder:`Digite os campos separados por vÃ­rgula
Ex: nome, cpf, cargo, departamento, salario`,required:""},null,512),[[j,a(g)]]),o[21]||(o[21]=e("p",{class:"text-xs text-gray-500 mt-1"},"Separe os campos por vÃ­rgula",-1))]),e("div",re,[e("div",null,[o[23]||(o[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Formato PadrÃ£o",-1)),n(w,{modelValue:a(s).formato_padrao,"onUpdate:modelValue":o[6]||(o[6]=r=>a(s).formato_padrao=r)},{default:x(()=>[...o[22]||(o[22]=[e("option",{value:"pdf"},"PDF",-1),e("option",{value:"excel"},"Excel",-1),e("option",{value:"csv"},"CSV",-1),e("option",{value:"json"},"JSON",-1)])]),_:1},8,["modelValue"])]),e("div",null,[o[25]||(o[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"OrientaÃ§Ã£o",-1)),n(w,{modelValue:a(s).orientacao,"onUpdate:modelValue":o[7]||(o[7]=r=>a(s).orientacao=r)},{default:x(()=>[...o[24]||(o[24]=[e("option",{value:"portrait"},"Retrato",-1),e("option",{value:"landscape"},"Paisagem",-1)])]),_:1},8,["modelValue"])])]),e("div",le,[e("label",ne,[$(e("input",{type:"checkbox","onUpdate:modelValue":o[8]||(o[8]=r=>a(s).incluir_logo=r),class:"rounded text-red-600 focus:ring-red-500"},null,512),[[T,a(s).incluir_logo]]),o[26]||(o[26]=e("span",{class:"text-sm text-gray-700"},"Incluir logo da empresa",-1))]),e("label",ie,[$(e("input",{type:"checkbox","onUpdate:modelValue":o[9]||(o[9]=r=>a(s).incluir_cabecalho=r),class:"rounded text-red-600 focus:ring-red-500"},null,512),[[T,a(s).incluir_cabecalho]]),o[27]||(o[27]=e("span",{class:"text-sm text-gray-700"},"Incluir cabeÃ§alho",-1))]),e("label",de,[$(e("input",{type:"checkbox","onUpdate:modelValue":o[10]||(o[10]=r=>a(s).incluir_rodape=r),class:"rounded text-red-600 focus:ring-red-500"},null,512),[[T,a(s).incluir_rodape]]),o[28]||(o[28]=e("span",{class:"text-sm text-gray-700"},"Incluir rodapÃ©",-1))]),e("label",ce,[$(e("input",{type:"checkbox","onUpdate:modelValue":o[11]||(o[11]=r=>a(s).ativo=r),class:"rounded text-red-600 focus:ring-red-500"},null,512),[[T,a(s).ativo]]),o[29]||(o[29]=e("span",{class:"text-sm text-gray-700"},"Ativo",-1))])]),e("div",ue,[n(U,{type:"button",onClick:o[12]||(o[12]=r=>m.$emit("close")),theme:"admin",variant:"secondary","full-width":""},{default:x(()=>[...o[30]||(o[30]=[C(" Cancelar ",-1)])]),_:1}),n(U,{type:"submit",theme:"admin",variant:"primary","full-width":"",disabled:a(f)},{default:x(()=>[C(b(a(f)?"Salvando...":"Salvar"),1)]),_:1},8,["disabled"])])],32)])])}}}),pe=Object.assign(me,{__name:"ModalRelatorioTemplate"}),xe={class:"min-h-screen bg-gray-50"},ve={class:"bg-white border-b border-gray-200 sticky top-0 z-40"},fe={class:"max-w-7xl mx-auto px-8 py-4"},ge={class:"flex items-center justify-between"},be={class:"flex items-center gap-4"},ye={class:"bg-white border-b border-gray-200"},_e={class:"max-w-7xl mx-auto px-8"},he={class:"flex gap-6"},ke=["onClick"],we={class:"max-w-7xl mx-auto p-8"},$e={key:0},Ce={class:"card mb-6"},Ve={class:"flex flex-wrap gap-4 items-center justify-between"},ze={class:"flex gap-4 items-center flex-1"},Ue={key:0,class:"card text-center py-12"},Ee={key:1,class:"grid md:grid-cols-2 gap-4"},Te={class:"flex items-start justify-between mb-3"},Re={class:"flex-1"},Pe={class:"flex items-center gap-2 mb-1"},Se={class:"font-semibold text-gray-800"},Ie={class:"text-sm text-gray-600 mb-2"},je={class:"flex gap-2 flex-wrap"},Ae={class:"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-700"},De={class:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-700"},Fe={key:0,class:"text-xs px-2 py-1 rounded-full bg-green-100 text-green-700"},Ne={class:"flex gap-2"},Me=["onClick","title"],Be=["onClick"],Le=["onClick"],qe={key:2,class:"card text-center py-12"},Oe={key:1},Ge={key:2},Xe=N({__name:"relatorios",setup(R){const h=v(!0),u=v("templates"),k=v(!1),f=v(null),g=v([]),s=v(""),y=v(""),m=[{id:"templates",label:"Templates",icon:"heroicons:document-text"},{id:"agendamentos",label:"Agendamentos",icon:"heroicons:clock"},{id:"historico",label:"HistÃ³rico",icon:"heroicons:archive-box"}],o=async()=>{h.value=!0;try{const i=await $fetch("/api/relatorios/templates");g.value=i.data||[]}catch(i){console.error("Erro ao carregar templates:",i),alert("Erro ao carregar relatÃ³rios")}finally{h.value=!1}},z=X(()=>{let i=g.value;if(s.value&&(i=i.filter(t=>t.categoria===s.value)),y.value){const t=y.value.toLowerCase();i=i.filter(d=>d.nome.toLowerCase().includes(t)||d.descricao&&d.descricao.toLowerCase().includes(t))}return i.sort((t,d)=>t.favorito&&!d.favorito?-1:!t.favorito&&d.favorito?1:t.nome.localeCompare(d.nome))}),V=(i=null)=>{f.value=i,k.value=!0},w=()=>{k.value=!1,f.value=null},U=async i=>{if(confirm(`Gerar relatÃ³rio "${i.nome}"?`))try{(await $fetch("/api/relatorios/gerar",{method:"POST",body:{template_id:i.id}})).success&&alert(`âœ… RelatÃ³rio gerado com sucesso!

O arquivo serÃ¡ baixado em instantes.`)}catch(t){console.error("Erro ao gerar relatÃ³rio:",t),alert("Erro ao gerar relatÃ³rio")}},r=async i=>{try{await $fetch(`/api/relatorios/templates/${i.id}`,{method:"PUT",body:{favorito:!i.favorito}}),i.favorito=!i.favorito}catch(t){console.error("Erro ao atualizar favorito:",t)}},G=async i=>{if(confirm(`Tem certeza que deseja excluir o relatÃ³rio "${i.nome}"?`))try{await $fetch(`/api/relatorios/templates/${i.id}`,{method:"DELETE"}),alert("âœ… RelatÃ³rio excluÃ­do com sucesso!"),o()}catch(t){console.error("Erro ao excluir:",t),alert("Erro ao excluir relatÃ³rio")}};return M(()=>{o()}),(i,t)=>{const d=B,H=Y,J=ee,K=L,Q=q,P=O,W=pe;return c(),p("div",xe,[e("header",ve,[e("div",fe,[e("div",ge,[e("div",be,[n(H,{to:"/configuracoes",class:"w-10 h-10 bg-red-700 rounded-lg flex items-center justify-center hover:bg-red-800 transition-colors"},{default:x(()=>[n(d,{name:"heroicons:arrow-left",class:"text-white",size:"20"})]),_:1}),t[4]||(t[4]=e("div",null,[e("h1",{class:"text-xl font-bold text-gray-800"},"RelatÃ³rios Personalizados"),e("p",{class:"text-sm text-gray-500"},"Crie, agende e gere relatÃ³rios customizados")],-1))]),n(J,{theme:"admin"})])])]),e("div",ye,[e("div",_e,[e("div",he,[(c(),p(D,null,F(m,l=>e("button",{key:l.id,onClick:E=>u.value=l.id,class:Z(["px-4 py-3 font-medium text-sm border-b-2 transition-colors",a(u)===l.id?"border-red-600 text-red-600":"border-transparent text-gray-600 hover:text-gray-800"])},[n(d,{name:l.icon,size:"18",class:"inline mr-2"},null,8,["name"]),C(" "+b(l.label),1)],10,ke)),64))])])]),e("div",we,[a(u)==="templates"?(c(),p("div",$e,[e("div",Ce,[e("div",Ve,[e("div",ze,[n(K,{modelValue:a(s),"onUpdate:modelValue":t[0]||(t[0]=l=>S(s)?s.value=l:null),class:"w-48"},{default:x(()=>[...t[5]||(t[5]=[e("option",{value:""},"Todas as Categorias",-1),e("option",{value:"colaboradores"},"Colaboradores",-1),e("option",{value:"folha"},"Folha de Pagamento",-1),e("option",{value:"ponto"},"Ponto",-1),e("option",{value:"ferias"},"FÃ©rias",-1),e("option",{value:"documentos"},"Documentos",-1),e("option",{value:"geral"},"Geral",-1)])]),_:1},8,["modelValue"]),n(Q,{modelValue:a(y),"onUpdate:modelValue":t[1]||(t[1]=l=>S(y)?y.value=l:null),placeholder:"Buscar relatÃ³rios...",class:"flex-1 max-w-md"},{prefix:x(()=>[n(d,{name:"heroicons:magnifying-glass",class:"text-gray-400",size:"20"})]),_:1},8,["modelValue"])]),n(P,{onClick:t[2]||(t[2]=l=>V()),theme:"admin"},{default:x(()=>[n(d,{name:"heroicons:plus",size:"20"}),t[6]||(t[6]=C(" Novo RelatÃ³rio ",-1))]),_:1})])]),a(h)?(c(),p("div",Ue,[n(d,{name:"heroicons:arrow-path",class:"animate-spin text-gray-400 mx-auto mb-4",size:"48"}),t[7]||(t[7]=e("p",{class:"text-gray-600"},"Carregando relatÃ³rios...",-1))])):(c(),p("div",Ee,[(c(!0),p(D,null,F(a(z),l=>(c(),p("div",{key:l.id,class:"card hover:shadow-lg transition-shadow"},[e("div",Te,[e("div",Re,[e("div",Pe,[e("h3",Se,b(l.nome),1),l.favorito?(c(),A(d,{key:0,name:"heroicons:star-solid",class:"text-yellow-500",size:"16"})):_("",!0)]),e("p",Ie,b(l.descricao),1),e("div",je,[e("span",Ae,b(l.categoria),1),e("span",De,b(l.formato_padrao?.toUpperCase()),1),l.total_execucoes>0?(c(),p("span",Fe,b(l.total_execucoes)+" execuÃ§Ãµes ",1)):_("",!0)])])]),e("div",Ne,[n(P,{onClick:E=>U(l),theme:"admin",variant:"primary",size:"sm",class:"flex-1"},{default:x(()=>[n(d,{name:"heroicons:play",size:"16"}),t[8]||(t[8]=C(" Gerar ",-1))]),_:1},8,["onClick"]),e("button",{onClick:E=>r(l),class:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:l.favorito?"Remover dos favoritos":"Adicionar aos favoritos"},[n(d,{name:l.favorito?"heroicons:star-solid":"heroicons:star",size:"18"},null,8,["name"])],8,Me),e("button",{onClick:E=>V(l),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Editar"},[n(d,{name:"heroicons:pencil",size:"18"})],8,Be),e("button",{onClick:E=>G(l),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Excluir"},[n(d,{name:"heroicons:trash",size:"18"})],8,Le)])]))),128))])),!a(h)&&a(z).length===0?(c(),p("div",qe,[n(d,{name:"heroicons:document-chart-bar",class:"text-gray-300 mx-auto mb-4",size:"64"}),t[10]||(t[10]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"Nenhum relatÃ³rio encontrado",-1)),t[11]||(t[11]=e("p",{class:"text-gray-600 mb-4"},"Crie relatÃ³rios personalizados para suas necessidades",-1)),n(P,{onClick:t[3]||(t[3]=l=>V()),theme:"admin"},{default:x(()=>[n(d,{name:"heroicons:plus",size:"20"}),t[9]||(t[9]=C(" Criar Primeiro RelatÃ³rio ",-1))]),_:1})])):_("",!0)])):_("",!0),a(u)==="agendamentos"?(c(),p("div",Oe,[...t[12]||(t[12]=[e("div",{class:"card"},[e("p",{class:"text-gray-600 text-center py-8"}," ðŸš§ Agendamentos de relatÃ³rios em desenvolvimento ")],-1)])])):_("",!0),a(u)==="historico"?(c(),p("div",Ge,[...t[13]||(t[13]=[e("div",{class:"card"},[e("p",{class:"text-gray-600 text-center py-8"}," ðŸš§ HistÃ³rico de execuÃ§Ãµes em desenvolvimento ")],-1)])])):_("",!0)]),a(k)?(c(),A(W,{key:0,template:a(f),onClose:w,onSaved:o},null,8,["template"])):_("",!0)])}}});export{Xe as default};
